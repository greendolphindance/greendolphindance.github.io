<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
<meta name="google-site-verification" content="zn35ZLEP0On5fOgBn4JhRUUvkwCf7aHCy5sF7KY_ztQ" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta name="baidu-site-verification" content="codeva-zj1hmU1TBt" />
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="greendolphindance">
    
        
                
                    <meta name="description" content="Back to the rough ground!">
                    
                        
                                
                                    <title>
                                        
                                                    博客搭建小记 | 
                                                            Green Dolphin Dance
                                    </title>

                                    
                                        
                                            <link rel="icon" href="https://github.com/greendolphindance/greendolphindance.github.io/assets/87912044/c65c5411-e5b5-4b25-b756-1a3121e22467">
                                            

                                                
                                                    
                                                        <!-- stylesheets list from _config.yml -->
                                                        
                                                            <link rel="stylesheet" href="/css/style.css">
                                                            
                                                                
                                                                    
                                                                        
                                                                            <!-- scripts list from _config.yml -->
                                                                            
                                                                                <script
                                                                                    src="/js/echarts.js"></script>
                                                                                
                                                                                <script
                                                                                    src="/js/script.js"></script>
                                                                                
                                                                                <script
                                                                                    src="/js/tocbot.min.js"></script>
                                                                                
                                                                                <script
                                                                                    src="/js/jquery.js"></script>
                                                                                
                                                                                <script
                                                                                    src="/js/clipboard.min.js"></script>
                                                                                
                                                                                    
                                                                                        
                                                                                            
                                                                                                
                                                                                                    
                                                                                                                
                                                                                                                            
                                                                                                                                



                                                                                                                                    <script>
                                                                                                                                        document.addEventListener('DOMContentLoaded', function () {
                                                                                                                                            function changeGiscusTheme() {
                                                                                                                                                const theme = document.body.classList.contains('dark-theme') ? 'dark' : 'light';

                                                                                                                                                function sendMessage(message) {
                                                                                                                                                    const iframe = document.querySelector('iframe.giscus-frame');
                                                                                                                                                    if (!iframe) return;
                                                                                                                                                    iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
                                                                                                                                                }

                                                                                                                                                sendMessage({
                                                                                                                                                    setConfig: {
                                                                                                                                                        theme: theme === 'dark' ? 'noborder_dark' : 'noborder_light'
                                                                                                                                                    }
                                                                                                                                                });
                                                                                                                                            }

                                                                                                                                            // 等待Giscus加载，然后尝试更改主题
                                                                                                                                            setTimeout(changeGiscusTheme, 1200); // 等待1200毫秒

                                                                                                                                            // 如果你有一个主题切换按钮或链接，你可以在这里添加事件监听器
                                                                                                                                            // 例如：
                                                                                                                                            // document.getElementById('your-theme-switch-button-id').addEventListener('click', changeGiscusTheme);
                                                                                                                                        });
                                                                                                                                    </script>

                                                                                                                                    <!-- 搜索的部分 -->
                                                                                                                                    

                                                                                                                                        
                                                                                                                                            <script>
    // function searchToggle() {
    //     const width = $(document.body).width()
    //     if(width > 479) {
    //         return;
    //     }
    //     const search = $('.search');
    //     const searchForm = $('.form-search')

    //     if(!search.hasClass("mobile-search")) {
    //         search.addClass("mobile-search");
    //     } else {
    //         search.removeClass("mobile-search");
    //     }
    // }

    function searchToggle() {
        const width = $(document.body).width()
        if (width > 900) {
            return;
        }
        const search = $('.search');
        const searchForm = $('.form-search');
        const menuToggle = $('.menu-toggle');
        const title = $('.navbar-header-title ');

        if (!search.hasClass("mobile-search")) {
            search.addClass("mobile-search");
            menuToggle.addClass("open-search")
            title.addClass("mobile-title-hidden")
        } else {
            search.removeClass("mobile-search");
            menuToggle.removeClass("open-search")
            // title.css({visibility: 'visible'})
            title.removeClass("mobile-title-hidden")
        }
    }



    function search(searchInputEl, formEl, flag) {
        const path = "/" + "search.json"; // 可以在public 下查看这个search.json
        $(formEl).submit(function (e) {
            e.preventDefault();
            let target = null
            if (searchInputEl == null) {
                const screenWidth = $(document.body).width();
                target = screenWidth > 479 ? $('#pc-search-input') : $('#mobile-search-input');
                console.log(target);
            } else {
                target = $(searchInputEl)
            }

            if (!flag && target.val() === '') {
                return;
            }

            $("#u-search").fadeIn(500, function () {
                $("body > .wrapper").addClass("modal-active");

                $.ajax({
                    url: path,
                    dataType: "json",
                    beforeSend: function (xhr) {
                        $input = target.val();
                        $(".form-input").val($input);
                        const loadingBar = $('.search-loading-bar')
                        loadingBar.css({
                            width: '100%',
                            display: 'block'
                        });
                    },
                    success: function (datas) {
                        console.log(datas);
                        const $resultPanel = $(".modal-body")[0];
                        let str = `<ul class="modal-results">`;
                        var keywords = $(".form-input").val().trim().toLowerCase().split(/[\s\-]+/);
                        $resultPanel.innerHTML = "";
                        let hasResult = false
                        let text = `<div class="no-result">找不到与关键词相关的内容....</div>`;

                        if ($(".form-input").val().trim().length <= 0) {
                            // 没有结果
                            $resultPanel.innerHTML = text;
                            return;
                        }
                        datas.forEach(function (data, index) {
                            var isMatch = true;
                            if (!data.title || data.title.trim() === '') {
                                data.title = "Untitled";
                            }
                            var data_title = data.title.trim().toLowerCase();
                            var data_content = data.content && data.content.trim().replace(/<[^>]+>/g, "").toLowerCase() || '';
                            var data_url = data.url;
                            var index_title = -1;
                            var index_content = -1;
                            var first_occur = -1;
                            // only match artiles with not empty contents
                            if (data_content !== '') {
                                keywords.forEach(function (keyword, i) {
                                    index_title = data_title.indexOf(keyword);
                                    index_content = data_content.indexOf(keyword);

                                    if (index_title < 0 && index_content < 0) {
                                        isMatch = false;
                                    } else {
                                        hasResult = true
                                        if (index_content < 0) {
                                            index_content = 0;
                                        }
                                        if (i == 0) {
                                            first_occur = index_content;
                                        }
                                    }
                                });
                            } else {
                                isMatch = false;
                            }
                            // show search results
                            if (isMatch) {
                                str += `<li class='result-item'><a href='${data_url}' class='result-item-detail'> <span class="title">${data_title}</span>`;
                                var content = data.content.trim().replace(/<[^>]+>/g, "");
                                if (first_occur >= 0) {
                                    // cut out 200 characters
                                    var start = first_occur - 40;
                                    var end = first_occur + 160;

                                    if (start < 0) {
                                        start = 0;
                                    }

                                    if (start == 0) {
                                        end = 200;
                                    }

                                    if (end > content.length) {
                                        end = content.length;
                                    }

                                    var match_content = content.substring(start, end);

                                    // highlight all keywords
                                    keywords.forEach(function (keyword) {
                                        var regS = new RegExp(keyword, "gi");
                                        match_content = match_content.replace(regS, `<em class="search-keyword">${keyword}</em>`);
                                    });

                                    str += `<span class="content"> ${match_content} ...</span></a>`;
                                }
                                str += "</li>";
                            }
                        });
                        str += "</ul>";
                        if (hasResult) {
                            $resultPanel.innerHTML = str;
                        } else {
                            $resultPanel.innerHTML = text;
                        }

                    },
                    complete: function () {
                        setTimeout(() => {
                            const loadingBar = $('.search-loading-bar')
                            loadingBar.css({
                                width: '0%',
                                display: 'none'
                            });
                        }, 300)
                    }
                });
            })

        });
    }

    $(document).ready(function () {
        $('.modal-close').click(function () {
            $("#u-search").fadeOut();
            $("body > .wrapper").removeClass("modal-active")
        })

        $('.modal-overlay').click(function () {
            $("#u-search").fadeOut();
            $("body > .wrapper").removeClass("modal-active")
        })
        search(null, ".form-search", false)
        search("#u-search-modal-form .form-input", ".u-search-modal-form", true)
    })
</script>
                                                                                                                                                

                                                                                                                                                    <script
                                                                                                                                                        async
                                                                                                                                                        src="https://us.umami.is/script.js"
                                                                                                                                                        data-website-id="38f19c51-0534-4438-abae-315f586a457d"></script>

                                                                                                                                                    <script
                                                                                                                                                        type="text/javascript"
        <style>
            body.hide-content * {
                visibility: hidden;
            }
        </style>
        <script>
            (function () {
                document.body.classList.add('hide-content');

                const savedTheme = localStorage.getItem('theme');
                const userPrefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
                let useDarkMode;
                if (savedTheme === 'dark' || savedTheme === 'light') {
                    useDarkMode = savedTheme === 'dark';
                } else {
                    useDarkMode = userPrefersDark;
                }
                document.body.classList.toggle('dark-theme', useDarkMode);
                document.body.classList.remove('hide-content');
            })();
        </script>
        <style>
            #tocButton svg {
                position: fixed;
                bottom: 20px;
                /* 调整到你想要的位置 */
                right: 5vw;
            }

            #totop {
                position: fixed;
                bottom: 20px+2rem;
                /* 调整到你想要的位置 */
                right: 5vw;
            }
        </style>

<meta name="generator" content="Hexo 7.3.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="Green Dolphin Dance" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism-solarized-dark-atom.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>

<body>
    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">
                    Green Dolphin Dance
                </a></div>
            <div class="menu navbar-right">
                <!-- 这里表示的是pc端搜索框 -->
                
                    
    <div class="search ">
        <div class="search-btn" onClick="searchToggle()">
            <svg t="1703126001771" class="search-btn-img" viewBox="0 0 1024 1024" version="1.1"
                xmlns="http://www.w3.org/2000/svg" p-id="4319" width="200" height="200">
                <path
                    d="M1004.8 915.2l-243.2-243.2c0 0-6.4-6.4-6.4-6.4C800 595.2 832 505.6 832 416 832 185.6 646.4 0 416 0S0 185.6 0 416 185.6 832 416 832c89.6 0 179.2-32 243.2-83.2 0 6.4 6.4 6.4 6.4 6.4l243.2 243.2c25.6 25.6 70.4 25.6 96 6.4C1030.4 979.2 1030.4 940.8 1004.8 915.2zM64 416C64 224 224 64 416 64S768 224 768 416 608 768 416 768 64 608 64 416z"
                    fill="#161209" p-id="4320"></path>
            </svg>
        </div>
        <form class="form-search">
            <input class="input" placeholder="点此搜索" autocomplete="off" id="pc-search-input" />
        </form>
    </div>
    

        <style>
            body.dark-theme .search-btn-img path {
                fill: #a9a9b3;
                /* 淡灰色 */
            }
        </style>
                        
                            <a class="menu-item" href="/timeline">
                                动态
                            </a>
                            
                            <a class="menu-item" href="/archives">
                                归档
                            </a>
                            
                            <a class="menu-item" href="/categories">
                                分类
                            </a>
                            
                            <a class="menu-item" href="/tags">
                                标签
                            </a>
                            
                            <a class="menu-item" href="/songs">
                                音乐
                            </a>
                            
                            <a class="menu-item" href="/guestbook">
                                留言板
                            </a>
                            
                            <a class="menu-item" href="/about">
                                关于
                            </a>
                            
                            <a class="menu-item" href="/links">
                                友链
                            </a>
                            
                                <input id="switch_default" type="checkbox" class="switch_default">
                                <label for="switch_default" class="toggleBtn"></label>
            </div>
        </div>
    </nav>

    
        <nav class="navbar-mobile" id="nav-mobile">
            <div class="container">
                <div class="navbar-header">
                    <div>
                        <a href="/">
                            Green Dolphin Dance
                        </a><a id="mobile-toggle-theme">·&nbsp;Light</a>
                    </div>
                    <div class="navbar-mobile-right">
                        
                            
    <div class="search ">
        <div class="search-btn" onClick="searchToggle()">
            <svg t="1703126001771" class="search-btn-img" viewBox="0 0 1024 1024" version="1.1"
                xmlns="http://www.w3.org/2000/svg" p-id="4319" width="200" height="200">
                <path
                    d="M1004.8 915.2l-243.2-243.2c0 0-6.4-6.4-6.4-6.4C800 595.2 832 505.6 832 416 832 185.6 646.4 0 416 0S0 185.6 0 416 185.6 832 416 832c89.6 0 179.2-32 243.2-83.2 0 6.4 6.4 6.4 6.4 6.4l243.2 243.2c25.6 25.6 70.4 25.6 96 6.4C1030.4 979.2 1030.4 940.8 1004.8 915.2zM64 416C64 224 224 64 416 64S768 224 768 416 608 768 416 768 64 608 64 416z"
                    fill="#161209" p-id="4320"></path>
            </svg>
        </div>
        <form class="form-search">
            <input class="input" placeholder="点此搜索" autocomplete="off" id="mobile-search-input" />
        </form>
    </div>
    

        <style>
            body.dark-theme .search-btn-img path {
                fill: #a9a9b3;
                /* 淡灰色 */
            }
        </style>
                                <div class="menu-toggle" onclick="mobileBtn()">&#9776; 目录</div>
                    </div>

                    <div class="menu" id="mobile-menu">
                        
                            <a class="menu-item" href="/timeline">
                                动态
                            </a>
                            
                            <a class="menu-item" href="/archives">
                                归档
                            </a>
                            
                            <a class="menu-item" href="/categories">
                                分类
                            </a>
                            
                            <a class="menu-item" href="/tags">
                                标签
                            </a>
                            
                            <a class="menu-item" href="/songs">
                                音乐
                            </a>
                            
                            <a class="menu-item" href="/guestbook">
                                留言板
                            </a>
                            
                            <a class="menu-item" href="/about">
                                关于
                            </a>
                            
                            <a class="menu-item" href="/links">
                                友链
                            </a>
                            
                    </div>
                </div>
        </nav>




</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if (toggleMenu.classList.contains("active")) {
            toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        } else {
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
            <div class="main">
                <div class="container">
    
        

                    
                        <article class="post-wrap">
                            <header class="post-header">
                                <h1 class="post-title">
                                    博客搭建小记
                                </h1>
                                
                                    <div class="post-meta">

                                        

                                                
                                                    <span class="post-time">

                                                        发表时间: <a href="#">2023-10-07&nbsp;&nbsp;17:44:31</a>
                                                    </span>
                                                    

                                                        
                                                            <span class="updated-time">
                                                                最后更新: <a href="#">2024-05-03&nbsp;&nbsp;0:18:46</a>
                                                            </span>
                                                            



                                                                

                                                                    <span class="post-category">

                                                                        分类:

                                                                        

                                                                            <a href="/categories/%E6%8A%98%E8%85%BE/">折腾</a>

                                                                            

                                                                    </span>

                                                                    



                                                                        

                                                                            <span class="post-count">

                                                                                字数:

                                                                                <a href="">
                                                                                    23.8k
                                                                                </a>

                                                                            </span>

                                                                            



                                                                                

                                                                                    <span class="post-count">

                                                                                        阅读时长:

                                                                                        <a href="">
                                                                                            107min
                                                                                        </a>

                                                                                    </span>

                                                                                    

                                    </div>
                                    
                            </header>

                            <div class="post-content">
                                <h1 id="为什么要搭建博客"><a href="#为什么要搭建博客" class="headerlink" title="为什么要搭建博客"></a>为什么要搭建博客</h1><p>以前用Wordpress弄了一个<a target="_blank" rel="noopener" href="http://chumiaochen.com/">学术主页</a>，还比较满意。但是最近又在琢磨着弄一个博客，分开弄主要是想着把学术和生活分开。</p>
<p>但我其实并没有很强的表达欲，所以还没想好博客里主要放一些什么内容。第一篇文章是关于塔罗牌的，是我最近感兴趣的东西。所以这个博客应该主打一个“一时兴起”，最近在做什么就写什么。</p>
<h1 id="做法"><a href="#做法" class="headerlink" title="做法"></a>做法</h1><p>首先声明：我本人没有任何的写码能力，所有的代码都是网上查阅得来或是由ChatGPT生成。所以我不知道这些代码是否是可复现的。请谨慎参考。</p>
<p>我首先搜索的关键词是“GitHub 搭建博客”，参考的教程是<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/28321740">这个</a>（搜出来的第一个）。因为我npy的个人主页（不是Links里的那个博客）是用GitHub弄的，所以我只知道GitHub似乎可以搭博客的样子。用这个教程我弄出了一个简陋的页面，上书一行小字：“Hello World”。</p>
<p>然后我发现了Hexo这个东西。不记得是怎么知道的了，可能是出现在刚才的搜索结果里。点进去看好像不是很难的样子。然而真正动起手来bug还是层出不穷……</p>
<p>不过现在我相信使用它们是正确的做法。一个优点在于它使得我的文件都保存在本地，让人很有安全感。（我本人对非本地的存储等等都不是很放心，因此购买了一个512G、一个2T的移动硬盘用来备份我手机、iPad和电脑里的破烂。但是我设备里也没啥很珍贵的东西，其实没了就没了。某种敝帚自珍！）</p>
<p>我参考的教程主要有<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/60578464">这个</a>和<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_62928039/article/details/130248518">这个</a>。其实都大同小异，因为步骤实在也不多。但我在建站的过程中居然屡屡受挫。我用Hexo创建并部署了站点之后，等了很久，页面还是一开始的Hello World（而不是Hexo的那个默认界面）。经过一番猜测和思考，我折腾了一通又将配置文件恢复成原来模样，结果——好了。完全不知道怎么回事。也许是我其实做了一些正确的修改，也许就是玄学。</p>
<p>接下来开始选主题。我希望整个网站的风格比较极简，留白比较大，以及最好有夜间模式（不强求）。我最开始选择的主题叫“paper”，长下面这样：</p>
<p><img src="https://d33wubrfki0l68.cloudfront.net/728712a1f41e64de505ff5828ac3e4fe1c7a6b83/7bac2/themes/screenshots/paper.jpg" alt="Paper"></p>
<p>结果，完全不能用……生成的页面都是无格式的样子，而且我最后也没有找到问题出在哪里。所以下一个，leedom：</p>
<p><img src="https://d33wubrfki0l68.cloudfront.net/a24b24a00ebb6960b6697e1f24a04b1589bedac9/43e59/themes/screenshots/leedom.jpg" alt="leedom"></p>
<p>这个倒是可以用，不过它的字体对我来说有些花哨了。所以我继续寻找下一个。这次找到的是名为“july”的主题：</p>
<p><img src="https://d33wubrfki0l68.cloudfront.net/3e136050f67788d5a51592abc70d6241b64987b7/b1257/themes/screenshots/july.jpg" alt="July"></p>
<p>多么简洁！完全！戳中了我的审美点！我立刻将其配置好，并添加了Categories和Tags页面。然后两个页面分别出现了不同的问题！</p>
<p>先说Tags：页面上没有内容。因为我的index文档里写了“title: Tags”，所以页面上有标题格式的“Tags”字样，但除此之外就没有别的了。按道理，只要index文档里写了“type: tags”，它就会自动生成一个列举了所有标签的页面。但是并没有。我查了半天，试了无数方法，都无法解决。</p>
<p>最后我发现：这个主题好像不包含Tags和Categories的页面……只好又换一个主题。这最后一个主题名叫“Chic”：</p>
<p><img src="https://d33wubrfki0l68.cloudfront.net/e3707c8ed851e560211b81491b5cef21da46b3f9/a8675/themes/screenshots/chic.jpg" alt="Chic"></p>
<p>我把主页的那些图标删掉了，就显得简洁了一些。虽然我比较喜欢在主页显示Recent Post的那种主题，但是这个已经是我能找到的最好的了。而且它还有夜间模式诶！只是要手动开启就是了。</p>
<p>说回Categories的问题。我点开Categories，页面404。然后我把问题发在闭社，社友nullptr（感谢！！）指出是大小写的问题，把链接“greendolphindance.github.io/categories”中的“categories”改成大写就好了。所以我把配置文件中的“categories”改成了大写，暂时解决了这个问题。</p>
<p>但是！只有“Categories”是大写，而“archive”、“tags”等都是小写，这让我很不爽！我就想从根本上解决这个问题。nullptr说是文件夹名称的问题，这让我想起我一开始建立Categories文件夹的时候不小心打成了大写。但问题是！我明明早就改成小写了！于是我删掉了整个categories文件夹，重新在大小写正确的情况下建立了一遍。但问题仍然存在。所以这件事情可能就这样了……</p>
<p>在使用“July”主题时，还出现了一个问题，就是我点击主页的文章标题没反应。社友Origakid（感谢！！）指出是URL配置得不对。我于是右键标题并复制链接，结果发现链接是<a class="break-link no-style"> “https://<span></span>greendolphindance.github.io/greendolphindance.github.io/2023/10/06/塔罗牌为什么不会出错/”</a>，“greendolphindance.github.io”神秘地出现了两次！我再试着输入<a class="break-link no-style">“greendolphindance.github.io/2023/10/06/塔罗牌为什么不会出错”</a>，发现可以正常打开。那么问题就很明显了。</p>
<p>但是为什么会出现这样的问题呢？经过一番艰难思索，我突然悟了，是我很早之前跟着某个教程在URL下面添加了一行：“root: greendolphindance.github.io”，为了解决前面出现的某个问题。然后可能问题用其他的方法解决了，但是这一行就忘记删掉了。所以通过某种机制，它让我的URL出现了问题。然后这个问题也解决了。</p>
<p>总而言之最后还是有惊无险地成功了！我之所以喜欢折腾就是因为喜欢寻找解决方案的过程以及找到解决方案带来的成就感，所以对这一过程我表示十分满意。一些小缺憾就是上述某些问题没有找到根本性的解决方法，或是解决了却不知其原理。但是我居然做出了一个可以运转的博客呢！想想就很激动。</p>
<p>其实还想试试添加评论和浏览量功能，但经过一番考察，我发现这些功能好像是挂靠（？）在主题下的，也就是说有的主题的文件包含和评论功能相关的代码，因此可以添加评论功能，但有的主题不行（也许可能可以自己写吧但是这对我来说太超过了……）。我这个主题大概不行，所以就干脆地放弃了。</p>
<h1 id="Markdown"><a href="#Markdown" class="headerlink" title="Markdown"></a>Markdown</h1><p>本站的所有文章都在本地以.md格式储存。所以要写文章，需要一个Markdown编辑器。</p>
<p>我一开始使用的是Xcode，因为双击文件就自动用它打开了……它很明显完全不适合，没有高亮也不能预览，不过也不能怪它，毕竟它被发明出来并不是用来写Markdown的。</p>
<p>然后我想着能不能利用电脑上现成的工具，于是把目光转向了Sublime Text。我平常用它写LaTeX，然后它好像插件很丰富的样子，就想会不会有插件支持Markdown高亮（我对预览的需求不是很高）。结果确实有，但我试了好几个都不太行，不知道是我的问题还是它们的问题。所以放弃了。</p>
<p>结果最后还是下载了Typora！我对它有好感的一点是它是买断制（点名批评某U姓APP），而且14.99刀也不算太离谱。其他的功能等等都蛮好的，不过我要求不高，只要高亮就可以（当然也可以Typora这种边写边预览的模式），也许一些免费的APP也可以满足，感觉还是有折腾的空间。但是再说吧！</p>
<h1 id="访问数和评论系统"><a href="#访问数和评论系统" class="headerlink" title="访问数和评论系统"></a>访问数和评论系统</h1><p>在Origakid的帮助下添加了访问数和评论系统！原来跟主题无关，只要找到合适的服务，然后在相应的文档里添加代码就可以。好玩！原话如下：</p>
<blockquote>
<p>@Revolver Congratulations! 另外想添加评论功能的话可以参见<a target="_blank" rel="noopener" href="https://giscus.app/zh-CN">giscus</a> ，浏览量可以使用<a target="_blank" rel="noopener" href="http://busuanzi.ibruce.info/">不蒜子</a> （记得对博客关闭AdBlock等屏蔽插件），这两个都是很简洁方便的实现方式，……</p>
</blockquote>
<p>我于是在giscus的网站上生成了代码块，然后粘贴到<a class="break-link no-style">/greendolphindance/themes/Chic/layout/_page/post.ejs</a>里。为什么是这个post.ejs而不是别的post.ejs呢？因为我本来想每个都试一遍，结果第一个试的就是这个。然后网上有些教程说复制到article.ejs，但我压根没找到这个文档，我觉得post和article应该是一个意思吧？</p>
<p>需要注意的是Origakid在评论区指出的那一点，即要把代码块复制到文档末尾“&lt;/article&gt;”之前。否则评论区和文章会不等宽。</p>
<p>不蒜子的话，因为官网只写了两行代码，没写咋用，所以我还参考了<a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1669144">这个</a>教程。配置并不难。同样地，最好把标签代码放在版权信息之后、“&lt;/div&gt;”之前，否则访问数会在版权信息的基础上另起一行，不够美观。</p>
<p>我本来写的是“感谢xx位访客”，然后发现太长了手机端显示成了两行。所以干脆删掉文字直接显示了“xx”。</p>
<h1 id="回到顶部"><a href="#回到顶部" class="headerlink" title="回到顶部"></a>回到顶部</h1><p>试着添加了“回到顶部”按钮！参考的教程是<a target="_blank" rel="noopener" href="http://wuchong.me/blog/2014/01/08/hexo-scrollup/">这个</a>。</p>
<p>首先跟着教程添加了相应的文件和代码，然后hexo s，果然不行（。我已经逐渐习惯我的这种折腾难以成功的体质了……</p>
<p>然后求助了我亲爱的男朋友，他说可能是因为这个用了jQuery，然后需要把jQuery的js文件也添加进去。</p>
<p>我：什么事jQuery？什么文件？添加到哪里？</p>
<p>（省略一些解释环节……）</p>
<p>最后终于弄懂了，要去网上下载一个叫jQuery.js的文件，添加到博客目录下放js文件的地方（我的是/greendolphindance/themes/Chic/source/js）。放进去之后，还要进行一些配置，也就是在某个文件添加某一行代码。</p>
<p>那么是哪个文件呢？我亲爱的男朋友推测是_config.yml。我机智地理解成主题文件夹内的_config.yml，而不是根目录下的那一个，事实证明是正确的。在该文档内搜索“js”，发现这么一段代码：</p>
<figure class="highlight text"><table><tbody><tr><td class="code"><pre><span class="line"># scripts loaded in the end of the body</span><br><span class="line">scripts:</span><br><span class="line">	- /js/script.js</span><br><span class="line">	- /js/tocbot.min.js</span><br></pre></td></tr></tbody></table></figure>

<p>我努力理解了一下，这是在body的end加载这两个js文件的意思！然后一个天才的想法就出现在我的脑海里：我把jQuery.js加进去不就得了吗！</p>
<p>但我又经过了一番缜密的思考：这个教程又叫我创建了一个名叫totop.js的文件，难道只加载jQuery.js，不加载这个吗？最后的结论是：两个都加上！</p>
<p>然后就好了！！（其实最后分别把两个文件名注释掉进行试验，发现起作用的只有jQuery.js。）</p>
<p>就这样，这个问题也被我在不明所以的情况下解决了！特别鸣谢我亲爱的男朋友！</p>
<h2 id="进阶"><a href="#进阶" class="headerlink" title="进阶"></a>进阶</h2><p>突然（2023-10-18）觉得手机上的“回到顶部”图标太大了，于是想到修改代码。我分别下载了长宽为48px和32px的图标，分别命名为back-top-48.png和back-top-32.png，保存到/themes/light/source/imgs目录下。</p>
<p>将totop.ejs的代码修改如下：</p>
<figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line">&lt;div id=<span class="string">"totop"</span> style=<span class="string">"position:fixed;bottom:20px;right:30px;cursor: pointer;"</span>&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">title</span>=<span class="string">"返回顶部"</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"/imgs/back-top-32.png"</span> <span class="attr">class</span>=<span class="string">"back-top-small"</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"/imgs/back-top-48.png"</span> <span class="attr">class</span>=<span class="string">"back-top-large"</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></tbody></table></figure>

<p>在任意CSS文档里添加如下代码：</p>
<figure class="highlight css"><table><tbody><tr><td class="code"><pre><span class="line"><span class="selector-class">.back-top-large</span> {</span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">@media</span> (<span class="attribute">min-width</span>: <span class="number">1281px</span>) {</span><br><span class="line">    <span class="selector-class">.back-top-small</span> {</span><br><span class="line">        <span class="attribute">display</span>: none;</span><br><span class="line">    }</span><br><span class="line">    <span class="selector-class">.back-top-large</span> {</span><br><span class="line">        <span class="attribute">display</span>: block;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>JS代码无需修改。</p>
<p>部署后发现，手机端出现了一大一小两个图标！电脑端正常。</p>
<p><img src="https://github.com/greendolphindance/greendolphindance.github.io/assets/87912044/6686b688-6978-4c33-a5f1-0dac5056f8f1" alt="IMG_4970"></p>
<p>排查发现，手机开启无痕浏览模式时显示正常。大概是缓存问题。于是清理缓存，问题解决。</p>
<h2 id="再进阶"><a href="#再进阶" class="headerlink" title="再进阶"></a>再进阶</h2><p>这个“回到顶部”的设置是，在页面没有滚动到指定高度时，按钮不显示；只有在页面滚动了一阵之后，按钮才出现。这本身没问题。问题在于在页面没有滚动到指定高度时，按钮并不是隐藏了，而只是变得透明了，仍然可以点击。有时候会误触，很难受，遂修改totop.js的代码：</p>
<figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line">(<span class="keyword">function</span>(<span class="params">$</span>) { </span><br><span class="line">    <span class="comment">// When to show the scroll link</span></span><br><span class="line">    <span class="comment">// higher number = scroll link appears further down the page </span></span><br><span class="line">    <span class="keyword">var</span> upperLimit = <span class="number">1000</span>; <span class="comment">// 您可以根据需要调整此值</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Our scroll link element</span></span><br><span class="line">    <span class="keyword">var</span> scrollElem = $(<span class="string">'#totop'</span>); </span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Scroll to top speed</span></span><br><span class="line">    <span class="keyword">var</span> scrollSpeed = <span class="number">500</span>; </span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Hide the scroll to top link initially</span></span><br><span class="line">    scrollElem.<span class="title function_">hide</span>();</span><br><span class="line">    </span><br><span class="line">    $(<span class="variable language_">window</span>).<span class="title function_">scroll</span>(<span class="keyword">function</span> (<span class="params"></span>) { </span><br><span class="line">        <span class="keyword">var</span> scrollTop = $(<span class="variable language_">document</span>).<span class="title function_">scrollTop</span>(); </span><br><span class="line">        <span class="keyword">if</span> (scrollTop &gt; upperLimit) {</span><br><span class="line">            $(scrollElem).<span class="title function_">stop</span>().<span class="title function_">fadeIn</span>(<span class="number">300</span>); <span class="comment">// fade in</span></span><br><span class="line">        } <span class="keyword">else</span> { </span><br><span class="line">            $(scrollElem).<span class="title function_">stop</span>().<span class="title function_">fadeOut</span>(<span class="number">300</span>); <span class="comment">// fade out and hide</span></span><br><span class="line">        }</span><br><span class="line">    });</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Scroll to top animation on click</span></span><br><span class="line">    $(scrollElem).<span class="title function_">click</span>(<span class="keyword">function</span>(<span class="params"></span>){</span><br><span class="line">        $(<span class="string">'html, body'</span>).<span class="title function_">animate</span>({<span class="attr">scrollTop</span>:<span class="number">0</span>}, scrollSpeed); <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    });</span><br><span class="line">})(jQuery);</span><br></pre></td></tr></tbody></table></figure>
<p>问题解决。</p>
<h2 id="再再进阶"><a href="#再再进阶" class="headerlink" title="再再进阶"></a>再再进阶</h2><p>由于PNG格式的图片显示起来不太清楚，社友茨月建议我使用svg格式。于是修改totop.ejs代码如下：</p>
<figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line">&lt;div id=<span class="string">"totop"</span> style=<span class="string">"position:fixed;bottom:20px;right:30px;cursor: pointer;"</span>&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">a</span> <span class="attr">title</span>=<span class="string">"返回顶部"</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">svg</span> <span class="attr">t</span>=<span class="string">"1697771647324"</span> <span class="attr">class</span>=<span class="string">"icon back-top-svg"</span> <span class="attr">viewBox</span>=<span class="string">"0 0 1024 1024"</span> <span class="attr">version</span>=<span class="string">"1.1"</span> <span class="attr">xmlns</span>=<span class="string">"http://www.w3.org/2000/svg"</span> <span class="attr">p-id</span>=<span class="string">"2324"</span> <span class="attr">width</span>=<span class="string">"32px"</span> <span class="attr">height</span>=<span class="string">"32px"</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">path</span> <span class="attr">d</span>=<span class="string">"M946.494 754.216c19.445-19.445 19.445-51.265 0-70.711L547.355 284.368c-19.445-19.445-51.265-19.445-70.711 0L77.506 683.506c-19.445 19.445-19.445 51.265 0 70.711"</span> <span class="attr">p-id</span>=<span class="string">"2325"</span> <span class="attr">fill</span>=<span class="string">"#8a8a8a"</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="selector-class">.back-top-svg</span> {</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">        <span class="attribute">width</span>: <span class="number">32px</span>; <span class="comment">/* or any size you want */</span></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">        <span class="attribute">height</span>: <span class="number">32px</span>; <span class="comment">/* or any size you want */</span></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    }</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="comment">/* You can also use media queries to change the size based on screen width */</span></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="keyword">@media</span> (<span class="attribute">min-width</span>: <span class="number">768px</span>) {</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">        <span class="selector-class">.back-top-svg</span> {</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">            <span class="attribute">width</span>: <span class="number">48px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">            <span class="attribute">height</span>: <span class="number">48px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">        }</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    }</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br></pre></td></tr></tbody></table></figure>
<p>并删除CSS文档里的代码。</p>
<h1 id="订阅"><a href="#订阅" class="headerlink" title="订阅"></a>订阅</h1><p>添加了订阅功能。主要参考的教程是<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/392900543">这个</a>（生成RSS订阅文件）和<a target="_blank" rel="noopener" href="https://backendology.com/2018/08/31/hugo-newsletter/">这个</a>（自动发送邮件），实现后者使用的是<a target="_blank" rel="noopener" href="https://app.tinyletter.com/">TinyLetter</a>和<a target="_blank" rel="noopener" href="https://zapier.com/">Zapier</a>。过程中居然没出什么岔子，唯一的问题是我在测试订阅链接的时候，输入了清华邮箱想要订阅，结果一直收不到确认邮件。过了半个小时之后终于收到了，不过这时候我已经全部弄好了。</p>
<p><del>那么，欢迎<a target="_blank" rel="noopener" href="https://tinyletter.com/greendolphindance">订阅</a>！</del></p>
<p>2023-10-10更新：靠，订阅挂掉了，TinyLetter不知道为什么把我的账号ban掉了。我又从社友处了解到RSS订阅也可以采取邮件推送的形式，比如使用<a target="_blank" rel="noopener" href="https://app.briefcake.com/">Briefcake</a>。所以就这样吧，请使用RSS订阅。</p>
<h1 id="留言板"><a href="#留言板" class="headerlink" title="留言板"></a>留言板</h1><p>添加了留言板功能。起初搜了一些教程，但都是教你怎么建立Guestbook页面的，没有说怎么把留言板放到新页面里面去。所以自己动手吧！</p>
<p>首先建立新页面，在博客根目录下执行：</p>
<p><code>hexo new page guestbook</code></p>
<p>然后进去把layout改成guestbook。所以我们现在需要一个叫guestbook的layout。在/greendolphindance/themes/Chic/layout里建一个叫guestbook.ejs的文档，然后把giscus上生成的代码块粘贴进去。完成了！</p>
<p>不过怎么有点丑？这个评论框和网页是等宽的。所以接下来要调整它的宽度并且把它居中。html语法我是一点不会，于是求助了我亲爱的男朋友，他告诉了我宽度怎么调，但让我自己查居中怎么调（让我考考你.jpg）。然后我就查到了，其实很简单，用</p>
<p><code>&lt;div style="width:80%; margin:auto;"&gt;</code></p>
<p>和</p>
<p><code>&lt;/div&gt;</code></p>
<p>把代码包起来就行了。</p>
<h2 id="进阶-1"><a href="#进阶-1" class="headerlink" title="进阶"></a>进阶</h2><p>之前留言板的宽度设置为80%，电脑和手机端一样。这样的话，手机端似乎就有些太窄了。我想实现“电脑端宽度为80%，手机端宽度为100%”，怎么办呢？</p>
<p>突然想起之前开了GPT-4。问问ChatGPT吧！</p>
<img width="845" alt="image" src="https://github.com/greendolphindance/greendolphindance.github.io/assets/87912044/d81bf1e9-ded7-4abd-9be5-40399cc69d2c">

<p>用GPT给的代码替换掉layout文件夹里原来文档中的代码，立刻解决了（后来觉得不好看，又把手机端的宽度改成了95%）。难道我真的是天才？</p>
<p>然后发现给的代码是错的……它直接把整个网页的宽度变成了80%和95%，导致菜单之类的东西都挤到一起了。所以又追问了一下：</p>
<img width="813" alt="image" src="https://github.com/greendolphindance/greendolphindance.github.io/assets/87912044/53638a87-5764-4a14-86e0-480918d24946">

<p>这样就好了。学到了！</p>
<h2 id="再进阶-1"><a href="#再进阶-1" class="headerlink" title="再进阶"></a>再进阶</h2><p>今天（2023-10-17）想到留言板应该和文章等宽。用网页检查器查到电脑端和iPad端宽度都是780px，手机端是370.67px，于是修改部分的代码如下：</p>
<figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Your Webpage<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.comment-box</span> {</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">max-width</span>: <span class="number">780px</span>; <span class="comment">/* 适用于桌面和横屏 iPad */</span></span></span><br><span class="line"><span class="language-css">            <span class="attribute">margin</span>: auto; <span class="comment">/* 居中显示 */</span></span></span><br><span class="line"><span class="language-css">        }</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="comment">/* 适用于竖屏 iPad 和手机 */</span></span></span><br><span class="line"><span class="language-css">        <span class="keyword">@media</span> (<span class="attribute">max-width</span>: <span class="number">1024px</span>), (<span class="attribute">orientation</span>: portrait) {</span></span><br><span class="line"><span class="language-css">            <span class="selector-class">.comment-box</span> {</span></span><br><span class="line"><span class="language-css">                <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">max-width</span>: <span class="number">780px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">margin</span>: auto;</span></span><br><span class="line"><span class="language-css">            }</span></span><br><span class="line"><span class="language-css">        }</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="comment">/* 适用于手机（横屏和竖屏） */</span></span></span><br><span class="line"><span class="language-css">        <span class="keyword">@media</span> (<span class="attribute">max-width</span>: <span class="number">767px</span>) {</span></span><br><span class="line"><span class="language-css">            <span class="selector-class">.comment-box</span> {</span></span><br><span class="line"><span class="language-css">                <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">max-width</span>: <span class="number">370.67px</span>;</span></span><br><span class="line"><span class="language-css">                <span class="attribute">margin</span>:auto;</span></span><br><span class="line"><span class="language-css">            }</span></span><br><span class="line"><span class="language-css">        }</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">body</span> {</span></span><br><span class="line"><span class="language-css">            <span class="attribute">background-color</span>: white;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">color</span>: black;</span></span><br><span class="line"><span class="language-css">        }</span></span><br><span class="line"><span class="language-css">        </span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>然后还是不对，因为手机竖屏时文章的宽度会根据手机型号的不同而不同。所以似乎需要找到一个相对宽度。我查找了iPhone SE、iPhone XR和iPhone 12 Pro上的文章宽度，并让ChatGPT根据手机尺寸进行计算：</p>
<blockquote>
<ul>
<li>iPhone SE: 345.67 / 375 ≈ 0.922</li>
<li>iPhone XR: 384.67 / 414 ≈ 0.929</li>
<li>iPhone 12 Pro: 360.67 / 390 ≈ 0.925</li>
</ul>
</blockquote>
<p>于是取了大致的中间值0.925。然后代码有点乱，又整理了一下，最后的成品是：</p>
<figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Green Doplhin Dance<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.comment-box</span> {</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">max-width</span>: <span class="number">780px</span>; <span class="comment">/* 适用于桌面和横屏 iPad */</span></span></span><br><span class="line"><span class="language-css">        <span class="attribute">margin</span>: auto; <span class="comment">/* 居中显示 */</span></span></span><br><span class="line"><span class="language-css">    }</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="comment">/* 适用于屏幕宽度小于 767px 的所有设备，无论横屏还是竖屏 */</span></span></span><br><span class="line"><span class="language-css">    <span class="keyword">@media</span> (<span class="attribute">max-width</span>: <span class="number">767px</span>) {</span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.comment-box</span> {</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>: <span class="number">92.5%</span>; <span class="comment">/* 相对于设备宽度的 92.5% */</span></span></span><br><span class="line"><span class="language-css">            <span class="attribute">margin</span>: auto; <span class="comment">/* 居中显示 */</span></span></span><br><span class="line"><span class="language-css">        }</span></span><br><span class="line"><span class="language-css">    }</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>其实最好还是找到不同手机型号文章宽度的规律，但是我不知道怎么找。只好用一个近似值了。但我这个代码也挺简洁的，而且显示效果八九不离十。</p>
<h1 id="域名"><a href="#域名" class="headerlink" title="域名"></a>域名</h1><p>一开始决定建博客的时候，没想到付出了如此巨大的努力。为了让自己的努力得到回报，奖励自己一个域名吧！</p>
<p>在<a target="_blank" rel="noopener" href="https://www.godaddy.com/en-sg">Godaddy</a>上买了一个域名，用找券插件找了一个优惠券，竟然只花了$1.17（一年）。开始配置吧——</p>
<p>果不其然，配置失败！页面404。</p>
<p>首先参考的是<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/da20ddc03cdf">这个教程</a>。配置好后，GitHub上的Pages页显示DNS check successful，但是网站打不开。然后我查到了<a target="_blank" rel="noopener" href="https://blog.csdn.net/i_do_not_know_you/article/details/105594269">这个</a>，上面说要添加的IP地址不是一个，而是四个。IP地址可以在GitHub的<a target="_blank" rel="noopener" href="https://docs.github.com/en/pages/configuring-a-custom-domain-for-your-github-pages-site/managing-a-custom-domain-for-your-github-pages-site">这个</a>官方页面找到。那就加吧！加了四个name为“@”的，还是404。</p>
<p>这个时候Godaddy的DNS页面上有四个name为@的项目和一个name为www的项目。此时我已经精神错乱，想着这个www好难受啊，删了算了，于是把它删掉了。</p>
<p>然后GitHub的Pages页面上的DNS check突然就不行了！</p>
<p>这让我灵机一动，会不会应该添加的name不是@，而是www呢？于是一鼓作气用www作为name添加了四个IP地址。</p>
<p>还是不行。我垂头丧气，决定先放它一放。</p>
<p>过了大概十五分钟，我随便刷新了一下，突然就好了！</p>
<p>然后我在GitHub的那个官方页面上看到这么一句话：</p>
<blockquote>
<p><strong>Note:</strong> DNS changes can take up to 24 hours to propagate.</p>
</blockquote>
<p>所以其实只是等一下就好了吗！我折腾了这么久，结果不知道起作用的究竟是我的折腾还是我的等待。因为太麻烦了，我也不想去测试，所以就这样吧。暂时没有很强的求知精神。</p>
<p>刚发现换了新域名之后评论全都消失了！冷静下来瞬间发现了问题出在哪里。把GitHub的Discussion相应标题里的“greendolphindance.github.io“改成”greendolphindance.com“就好了。</p>
<p>（2024-11-11更新）今天写了一篇博文，结果发现直接Page not Found.</p>
<h1 id="博文整理"><a href="#博文整理" class="headerlink" title="博文整理"></a>博文整理</h1><p>今天（2023-10-10）一早起来，突发奇想想把本地的所有博文放在一个以年份命名的文件夹里。但是这好像会改变文章的URL，再次导致评论消失，怎么办呢？</p>
<p>答案在<a target="_blank" rel="noopener" href="https://prinsss.github.io/hexo-posts-in-subfolder/">这里</a>。只需要看文章的开头就可以了，开头是此文评论区提到的简便方法，其余的都是作者在瞎折腾。方法很简单，只需要在根目录下的_config.yml中搜索“new_post_name“，在相应位置改成<code>new_post_name: :year/:title.md</code>就可以了，其他地方不用改，也就是保持permalink那一行为<code>permalink: :name/ </code>。</p>
<p>这样，就可以在不改变文章URL的前提下，把本地的博文按年份分类啦。</p>
<h1 id="音乐"><a href="#音乐" class="headerlink" title="音乐"></a>音乐</h1><p>在About页面添加了一个<a target="_blank" rel="noopener" href="https://music.163.com/#/playlist?id=8793002560">歌单</a>。参考了<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_58068682/article/details/116612364">这个</a>教程，尤其是“为博客添加音乐页面”小标题下的内容。方法很简单，安装<a target="_blank" rel="noopener" href="https://github.com/MoePlayer/hexo-tag-aplayer">hexo-tag-aplayer</a>插件并根据教程配置好，然后把以下这段代码</p>
<figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.css"</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.jsdelivr.net/npm/meting@1.2/dist/Meting.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">{% meting "7868005687" "tencent" "playlist" "theme:#555" "mutex:true" "listmaxheight:1000px" "preload:auto" %}</span><br></pre></td></tr></tbody></table></figure>

<p>中的“7868005687”和“tencent”分别改成我自己歌单的ID和“netease”，然后放入/greendolphindance/source/about/index.md内即可。</p>
<h1 id="夜间模式"><a href="#夜间模式" class="headerlink" title="夜间模式"></a>夜间模式</h1><h2 id="评论框的夜间模式"><a href="#评论框的夜间模式" class="headerlink" title="评论框的夜间模式"></a>评论框的夜间模式</h2><p>本来一切都好好的，直到我在guestbook页面点开了夜间模式。漆黑的背景和惨白的评论框形成的鲜明对比，让我再也坐不住了。</p>
<p>我的需求：我想使用giscus的noborder主题，同时又想让它跟随网页的色彩模式。没有现成的东西可抄，我得自己写。谁要自己写！问问ChatGPT吧！</p>
<p>反复询问ChatGPT，失败无数次，终于被我问出了正确的代码：</p>
<figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.css"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.jsdelivr.net/npm/meting@1.2/dist/Meting.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">{% meting "7868005687" "tencent" "playlist" "theme:#555" "mutex:true" "listmaxheight:1000px" "preload:auto" %}</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">	<span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">'DOMContentLoaded'</span>, <span class="keyword">function</span>(<span class="params"></span>) {</span></span><br><span class="line"><span class="language-javascript">	<span class="keyword">function</span> <span class="title function_">changeGiscusTheme</span>(<span class="params"></span>) {</span></span><br><span class="line"><span class="language-javascript">	<span class="keyword">const</span> theme = <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">classlist</span>.<span class="title function_">contains</span>(<span class="string">'dark-theme'</span>) ? <span class="string">'dark'</span> : <span class="string">'light'</span>;</span></span><br><span class="line"><span class="language-javascript">	<span class="keyword">function</span> <span class="title function_">sendMessage</span> (message) {</span></span><br><span class="line"><span class="language-javascript">	<span class="keyword">const</span> iframe = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">'iframe.giscus-frame'</span>);</span></span><br><span class="line"><span class="language-javascript">	<span class="keyword">if</span> (liframe) <span class="keyword">return</span>;</span></span><br><span class="line"><span class="language-javascript">	iframe.<span class="property">contentWindow</span> <span class="title function_">postMessage</span>(f <span class="attr">giscus</span>: message }, <span class="string">'https://giscus.app'</span>);</span></span><br><span class="line"><span class="language-javascript">	}</span></span><br><span class="line"><span class="language-javascript">	sendMessage ( {</span></span><br><span class="line"><span class="language-javascript">	<span class="attr">setConfig</span>: {</span></span><br><span class="line"><span class="language-javascript">	｝</span></span><br><span class="line"><span class="language-javascript">	<span class="attr">theme</span>: theme === <span class="string">'dark'</span> ? <span class="string">'noborder_dark'</span> : <span class="string">'noborder_light'</span></span></span><br><span class="line"><span class="language-javascript">	｝）：</span></span><br><span class="line"><span class="language-javascript">	｝</span></span><br><span class="line"><span class="language-javascript">	<span class="comment">// Initialize the theme when the page loads</span></span></span><br><span class="line"><span class="language-javascript">	changeGiscusTheme ();</span></span><br><span class="line"><span class="language-javascript">	<span class="comment">// Create a mutation observer to watch for changes to the body's class list</span></span></span><br><span class="line"><span class="language-javascript">	<span class="keyword">const</span> observer = <span class="keyword">new</span> <span class="title class_">MutationObserver</span>(<span class="keyword">function</span>(<span class="params">mutations</span>) {</span></span><br><span class="line"><span class="language-javascript">	mutations. <span class="title function_">forEach</span>(<span class="keyword">function</span>(<span class="params">mutation</span>) {</span></span><br><span class="line"><span class="language-javascript">	<span class="keyword">if</span> (mutation.<span class="property">attributeName</span> === <span class="string">'class'</span>) {</span></span><br><span class="line"><span class="language-javascript">	changeGiscusTheme () ;</span></span><br><span class="line"><span class="language-javascript">	｝</span></span><br><span class="line"><span class="language-javascript">	});</span></span><br><span class="line"><span class="language-javascript">	<span class="number">3</span>);</span></span><br><span class="line"><span class="language-javascript">	<span class="comment">// Start observing the body for changes to the class attribute</span></span></span><br><span class="line"><span class="language-javascript">	observer observe (<span class="variable language_">document</span>. body, { <span class="attr">attributes</span>: <span class="literal">true</span> });</span></span><br><span class="line"><span class="language-javascript">	｝）；</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<p>将这段代码插入post.ejs和guestbook.ejs中的<code>&lt;/body&gt;</code>前面即可。</p>
<p>其中后半截代码是没有用的……是我在调试成功之后发现，如果本身打开了网页的夜间模式，再进入guestbook时，giscus是不会转换成夜间模式的。要关掉网页的夜间模式再打开，giscus才会是夜间模式。问了ChatGPT，给了我后半截代码，但是输进去还是这样。暂时放弃了，哪天闲的时候再调试吧。</p>
<p>2023-10-12更新：明明很忙，还是手痒来调试了。花了大量时间成功了。解决方法可以看<a target="_blank" rel="noopener" href="https://github.com/giscus/giscus/issues/1200">这个页面</a>。</p>
<p>啊啊啊还是没解决，电脑端好了，但是手机端还有相同的问题……我又把这个issue reopen了。</p>
<p>2023-10-13更新：勉强解决了。我已经无力复盘了，所以以下是ChatGPT的总结：</p>
<blockquote>
<h3 id="问题概述"><a href="#问题概述" class="headerlink" title="问题概述"></a>问题概述</h3><p>当使用夜间模式切换器在桌面端切换网站的颜色模式时，嵌入的 Giscus 评论区的颜色模式也会相应地切换。然而，在移动端，尽管网站的颜色模式已切换，评论区的颜色模式却保持不变。</p>
<h3 id="尝试（未成功）的解决方法"><a href="#尝试（未成功）的解决方法" class="headerlink" title="尝试（未成功）的解决方法"></a>尝试（未成功）的解决方法</h3><ol>
<li><p><strong>使用 JavaScript 监听颜色模式切换并刷新评论区</strong></p>
<p>尝试使用 JavaScript 代码来监听颜色模式的切换，并在切换发生时刷新 Giscus 评论区。这在桌面端有效，但在移动端无效。</p>
</li>
<li><p><strong>使用双 iframe 切换</strong></p>
<p>考虑了一种方法，即在页面上放置两个 Giscus 评论区的 iframe（一个用于夜间模式，一个用于日间模式），并在颜色模式切换时在它们之间切换。这个方法被认为过于复杂且可能影响页面性能，因此没有进一步尝试。</p>
</li>
<li><p><strong>尝试修改 Giscus 的源代码</strong></p>
<p>考虑直接修改 Giscus 的源代码来解决问题。然而，由于 Giscus 是一个第三方服务，我们无法直接修改其源代码。</p>
</li>
</ol>
<h3 id="成功的解决方法"><a href="#成功的解决方法" class="headerlink" title="成功的解决方法"></a>成功的解决方法</h3><ol>
<li><p><strong>确定正确的移动端切换按钮选择器</strong></p>
<p>通过检查 HTML 代码，我们发现移动端的颜色模式切换按钮使用了一个 <code>id</code>（<code>mobile-toggle-theme</code>）而非 <code>class</code>。因此，我们需要使用正确的选择器来选中这个元素。</p>
</li>
<li><p><strong>使用 JavaScript 刷新页面</strong></p>
<p>当颜色模式切换时，我们使用 JavaScript 来刷新整个页面，而不仅仅是评论区。这样，评论区会在新的颜色模式下重新加载。</p>
</li>
</ol>
<h3 id="最终的代码实现"><a href="#最终的代码实现" class="headerlink" title="最终的代码实现"></a>最终的代码实现</h3><p>在你的 HTML 或 JavaScript 文件中，添加以下代码：</p>
<figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">'DOMContentLoaded'</span>, <span class="keyword">function</span> (<span class="params"></span>) {</span><br><span class="line">    <span class="comment">// 找到桌面端切换颜色模式的按钮</span></span><br><span class="line">    <span class="keyword">const</span> toggleDesktop = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">'label[for="switch_default"]'</span>);</span><br><span class="line">    <span class="comment">// 找到移动端切换颜色模式的按钮</span></span><br><span class="line">    <span class="keyword">const</span> toggleMobile = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">'#mobile-toggle-theme'</span>); <span class="comment">// 使用了 ID 选择器</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 定义一个函数来处理颜色模式的切换和页面刷新</span></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">handleToggle</span>(<span class="params"></span>) {</span><br><span class="line">        location.<span class="title function_">reload</span>();</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 如果找到了桌面端的按钮，为其添加点击事件监听器</span></span><br><span class="line">    <span class="keyword">if</span> (toggleDesktop) {</span><br><span class="line">        toggleDesktop.<span class="title function_">addEventListener</span>(<span class="string">'click'</span>, handleToggle);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 如果找到了移动端的按钮，为其添加点击事件监听器</span></span><br><span class="line">    <span class="keyword">if</span> (toggleMobile) {</span><br><span class="line">        toggleMobile.<span class="title function_">addEventListener</span>(<span class="string">'click'</span>, handleToggle);</span><br><span class="line">    }</span><br><span class="line">});</span><br></pre></td></tr></tbody></table></figure>

<p>这段代码首先尝试选中桌面端和移动端的颜色模式切换按钮。一旦按钮被点击，<code>handleToggle</code> 函数会被调用，刷新整个页面。这样，无论在桌面端还是移动端，评论区都会在新的颜色模式下重新加载。</p>
<p>希望这个总结能够清晰地反映整个问题解决的过程！如果你有任何进一步的问题或疑虑，随时告诉我！</p>
</blockquote>
<p>这个方案是我想出来的，异常丑陋，因为它导致切换主题的时候整个页面都会被刷新……不过我也没有更好的办法。所以先这样吧。想把这个方案放到GitHub Issue上去，但不close，看看有没有人有更好的方式。</p>
<p>它给我的代码和它自己总结的有点不一样，是长下面这样：</p>
<figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">'DOMContentLoaded'</span>, <span class="keyword">function</span> (<span class="params"></span>) {</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">getGiscusTheme</span>(<span class="params"></span>) {</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> theme = <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">classList</span>.<span class="title function_">contains</span>(<span class="string">'dark-theme'</span>) ? <span class="string">'dark'</span> : <span class="string">'light'</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> theme === <span class="string">'dark'</span> ? <span class="string">'noborder_dark'</span> : <span class="string">'noborder_light'</span>;</span></span><br><span class="line"><span class="language-javascript">    }</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">setGiscusTheme</span>(<span class="params"></span>) {</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">function</span> <span class="title function_">sendMessage</span>(<span class="params">message</span>) {</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> iframe = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">'iframe.giscus-frame'</span>);</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span> (!iframe) <span class="keyword">return</span>;</span></span><br><span class="line"><span class="language-javascript">            iframe.<span class="property">contentWindow</span>.<span class="title function_">postMessage</span>({ <span class="attr">giscus</span>: message }, <span class="string">'https://giscus.app'</span>);</span></span><br><span class="line"><span class="language-javascript">        }</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">sendMessage</span>({</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">setConfig</span>: {</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">theme</span>: <span class="title function_">getGiscusTheme</span>(),</span></span><br><span class="line"><span class="language-javascript">            },</span></span><br><span class="line"><span class="language-javascript">        });</span></span><br><span class="line"><span class="language-javascript">    }</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">handleToggle</span>(<span class="params"></span>) {</span></span><br><span class="line"><span class="language-javascript">        location.<span class="title function_">reload</span>();</span></span><br><span class="line"><span class="language-javascript">    }</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// Update giscus theme when theme switcher is clicked</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> toggleDesktop = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">'label[for="switch_default"]'</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> toggleMobile = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">'#mobile-toggle-theme'</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (toggleDesktop) {</span></span><br><span class="line"><span class="language-javascript">        toggleDesktop.<span class="title function_">addEventListener</span>(<span class="string">'click'</span>, <span class="keyword">function</span>(<span class="params"></span>) {</span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">setGiscusTheme</span>();</span></span><br><span class="line"><span class="language-javascript">        });</span></span><br><span class="line"><span class="language-javascript">    }</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (toggleMobile) {</span></span><br><span class="line"><span class="language-javascript">        toggleMobile.<span class="title function_">addEventListener</span>(<span class="string">'click'</span>, <span class="keyword">function</span>(<span class="params"></span>) {</span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">handleToggle</span>();</span></span><br><span class="line"><span class="language-javascript">        });</span></span><br><span class="line"><span class="language-javascript">    }</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// Wait for 1000ms (1 second) before loading the Giscus comments to ensure theme is set</span></span></span><br><span class="line"><span class="language-javascript">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> {</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> giscusAttributes = {</span></span><br><span class="line"><span class="language-javascript">            <span class="string">"src"</span>: <span class="string">"https://giscus.app/client.js"</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="string">"data-repo"</span>: <span class="string">"greendolphindance/greendolphindance.github.io"</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="string">"data-repo-id"</span>: <span class="string">"R_kgDOKc-MwA"</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="string">"data-category"</span>: <span class="string">"General"</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="string">"data-category-id"</span>: <span class="string">"DIC_kwDOKc-MwM4CZ8oe"</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="string">"data-mapping"</span>: <span class="string">"url"</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="string">"data-strict"</span>: <span class="string">"0"</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="string">"data-reactions-enabled"</span>: <span class="string">"1"</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="string">"data-emit-metadata"</span>: <span class="string">"0"</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="string">"data-input-position"</span>: <span class="string">"top"</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="string">"data-theme"</span>: <span class="title function_">getGiscusTheme</span>(),</span></span><br><span class="line"><span class="language-javascript">            <span class="string">"data-lang"</span>: <span class="string">"zh-CN"</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="string">"crossorigin"</span>: <span class="string">"anonymous"</span>,</span></span><br><span class="line"><span class="language-javascript">        };</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// Dynamically create script tag</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> giscusScript = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">"script"</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">Object</span>.<span class="title function_">entries</span>(giscusAttributes).<span class="title function_">forEach</span>(<span class="function">(<span class="params">[key, value]</span>) =&gt;</span> giscusScript.<span class="title function_">setAttribute</span>(key, value));</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// Append the script tag to the &lt;article&gt; element</span></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">'article'</span>).<span class="title function_">appendChild</span>(giscusScript);</span></span><br><span class="line"><span class="language-javascript">    }, <span class="number">1000</span>);</span></span><br><span class="line"><span class="language-javascript">});</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<p>然后我突然灵光一现，试着把中间的两个“if”里面的内容改成：</p>
<figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line">if (toggleDesktop) {</span><br><span class="line">     toggleDesktop.addEventListener('click', function() {</span><br><span class="line">         setGiscusTheme();</span><br><span class="line">     });</span><br><span class="line"> }</span><br><span class="line"></span><br><span class="line"> if (toggleMobile) {</span><br><span class="line">     toggleMobile.addEventListener('click', function() {</span><br><span class="line">         setGiscusTheme();</span><br><span class="line">     });</span><br><span class="line"> }</span><br></pre></td></tr></tbody></table></figure>

<p>再deploy。然后就好了！不用刷新，评论框也会随着主题变化而改变颜色！可是我根本不知道为什么它就work了！</p>
<h2 id="歌单的夜间模式"><a href="#歌单的夜间模式" class="headerlink" title="歌单的夜间模式"></a>歌单的夜间模式</h2><p>（这部分内容向社友neruko请教了很多，特别感谢！）</p>
<p>APlayer这个插件本来是没有夜间模式的，所以要自己弄一个。播放器块状部分和线状部分（边框等）的颜色需要分别指定。在About页面的index.md将歌单的代码改为如下：</p>
<figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.css"</span>&gt;</span>   </span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-tag">body</span> {</span></span><br><span class="line"><span class="language-css">    <span class="attribute">transition</span>: background-color <span class="number">0.3s</span>, color <span class="number">0.3s</span>; <span class="comment">/* Smooth transition */</span></span></span><br><span class="line"><span class="language-css">}</span></span><br><span class="line"><span class="language-css"><span class="comment">/* Light mode styles (default) */</span></span></span><br><span class="line"><span class="language-css"><span class="selector-tag">body</span> {</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background-color</span>: <span class="number">#ffffff</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: <span class="number">#000000</span>;</span></span><br><span class="line"><span class="language-css">}</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="comment">/* Dark mode styles */</span></span></span><br><span class="line"><span class="language-css"><span class="selector-tag">body</span><span class="selector-class">.dark-theme</span> {</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background-color</span>: <span class="number">#292a2d</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: <span class="number">#ffffff</span>;</span></span><br><span class="line"><span class="language-css">}</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="comment">/* APlayer styles for light mode */</span></span></span><br><span class="line"><span class="language-css"><span class="selector-tag">body</span> <span class="selector-class">.aplayer-body</span>,</span></span><br><span class="line"><span class="language-css"><span class="selector-tag">body</span> <span class="selector-class">.aplayer-info</span>,</span></span><br><span class="line"><span class="language-css"><span class="selector-tag">body</span> <span class="selector-class">.aplayer-notice</span>,</span></span><br><span class="line"><span class="language-css"><span class="selector-tag">body</span> <span class="selector-class">.aplayer-list</span> {</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background-color</span>: <span class="number">#ffffff</span>;</span></span><br><span class="line"><span class="language-css">}</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="comment">/* APlayer styles for dark mode */</span></span></span><br><span class="line"><span class="language-css"><span class="selector-tag">body</span><span class="selector-class">.dark-theme</span> <span class="selector-class">.aplayer-body</span>,</span></span><br><span class="line"><span class="language-css"><span class="selector-tag">body</span><span class="selector-class">.dark-theme</span> <span class="selector-class">.aplayer-info</span>,</span></span><br><span class="line"><span class="language-css"><span class="selector-tag">body</span><span class="selector-class">.dark-theme</span> <span class="selector-class">.aplayer-notice</span>,</span></span><br><span class="line"><span class="language-css"><span class="selector-tag">body</span><span class="selector-class">.dark-theme</span> <span class="selector-class">.aplayer-list</span> {</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background-color</span>: <span class="number">#292a2d</span>;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">}</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-tag">body</span><span class="selector-class">.dark-theme</span> <span class="selector-class">.aplayer</span> <span class="selector-class">.aplayer-list</span> <span class="selector-class">.aplayer-list-light</span> {</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background-color</span>: <span class="number">#505254</span> <span class="meta">!important</span>; </span></span><br><span class="line"><span class="language-css">}</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-tag">body</span><span class="selector-class">.dark-theme</span> <span class="selector-class">.aplayer</span> <span class="selector-class">.aplayer-list</span> <span class="selector-tag">ol</span> <span class="selector-tag">li</span><span class="selector-pseudo">:hover</span> {</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="number">#414345</span>; <span class="comment">/* 或者你想要的其他颜色 */</span></span></span><br><span class="line"><span class="language-css">}</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-tag">body</span><span class="selector-class">.dark-theme</span> <span class="selector-class">.aplayer</span> <span class="selector-class">.aplayer-list</span> <span class="selector-tag">ol</span> <span class="selector-tag">li</span> {</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-top</span>: <span class="number">1px</span> solid <span class="number">#414345</span>; <span class="comment">/* 或者你想要的其他颜色 */</span></span></span><br><span class="line"><span class="language-css">}</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-tag">body</span><span class="selector-class">.dark-theme</span> <span class="selector-class">.aplayer-lrc</span><span class="selector-pseudo">::before</span>,</span></span><br><span class="line"><span class="language-css"><span class="selector-tag">body</span><span class="selector-class">.dark-theme</span> <span class="selector-class">.aplayer-lrc</span><span class="selector-pseudo">::after</span> {</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(to bottom, <span class="number">#292a2d</span>, <span class="number">#292a2d</span>); <span class="comment">/* 使用和背景相同的颜色 */</span></span></span><br><span class="line"><span class="language-css">}</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-tag">body</span><span class="selector-class">.dark-theme</span> <span class="selector-class">.aplayer-list-cur</span> {</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background-color</span>: <span class="number">#aaaaaa</span> <span class="meta">!important</span>;</span></span><br><span class="line"><span class="language-css">}</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-tag">body</span><span class="selector-class">.dark-theme</span> <span class="selector-class">.aplayer</span> <span class="selector-class">.aplayer-icon-volume-down</span><span class="selector-pseudo">:hover</span> path,</span></span><br><span class="line"><span class="language-css"><span class="selector-tag">body</span><span class="selector-class">.dark-theme</span> <span class="selector-class">.aplayer</span> <span class="selector-class">.aplayer-icon-order</span><span class="selector-pseudo">:hover</span> path,</span></span><br><span class="line"><span class="language-css"><span class="selector-tag">body</span><span class="selector-class">.dark-theme</span> <span class="selector-class">.aplayer</span> <span class="selector-class">.aplayer-icon-loop</span><span class="selector-pseudo">:hover</span> path,</span></span><br><span class="line"><span class="language-css"><span class="selector-tag">body</span><span class="selector-class">.dark-theme</span> <span class="selector-class">.aplayer</span> <span class="selector-class">.aplayer-icon-menu</span><span class="selector-pseudo">:hover</span> path {</span></span><br><span class="line"><span class="language-css">    fill: <span class="number">#eeeeee</span> <span class="meta">!important</span>;</span></span><br><span class="line"><span class="language-css">}</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-tag">body</span><span class="selector-class">.dark-theme</span>  <span class="selector-class">.aplayer-info</span> {</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-bottom</span>: none <span class="meta">!important</span>;</span></span><br><span class="line"><span class="language-css">}</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-tag">body</span><span class="selector-class">.dark-theme</span> <span class="selector-class">.aplayer</span> {</span></span><br><span class="line"><span class="language-css">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">2px</span> <span class="number">4px</span> <span class="number">0</span> <span class="built_in">rgba</span>(<span class="number">170</span>, <span class="number">170</span>, <span class="number">170</span>, <span class="number">0.2</span>), <span class="number">0</span> <span class="number">3px</span> <span class="number">10px</span> <span class="number">0</span> <span class="built_in">rgba</span>(<span class="number">170</span>, <span class="number">170</span>, <span class="number">170</span>, <span class="number">0.19</span>) <span class="meta">!important</span>;</span></span><br><span class="line"><span class="language-css">}</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.jsdelivr.net/npm/aplayer@1.10/dist/APlayer.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span>   </span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.jsdelivr.net/npm/meting@1.2/dist/Meting.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span>   </span><br><span class="line"></span><br><span class="line">{% meting "8793002560" "netease" "playlist" "theme:#555" "mutex:true" "listmaxheight:2000px" "preload:auto" %}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<p>有很多乱七八糟的代码……都是我发现样式不对然后临时加上一些。然后似乎是在script.js的最后插入如下代码，但是由于我看不太懂，我也不清楚是不是确实是如下代码：</p>
<figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">ready</span>(</span><br><span class="line">    <span class="comment">// toggleTheme function.</span></span><br><span class="line">    <span class="comment">// this script shouldn't be changed.</span></span><br><span class="line">    <span class="function">() =&gt;</span> {</span><br><span class="line">        <span class="keyword">var</span> _Blog = <span class="variable language_">window</span>.<span class="property">_Blog</span> || {};</span><br><span class="line">        <span class="keyword">const</span> currentTheme = <span class="variable language_">window</span>.<span class="property">localStorage</span> &amp;&amp; <span class="variable language_">window</span>.<span class="property">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">'theme'</span>);</span><br><span class="line">        <span class="keyword">const</span> isDark = currentTheme === <span class="string">'dark'</span>;</span><br><span class="line">        <span class="keyword">const</span> pagebody = <span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(<span class="string">'body'</span>)[<span class="number">0</span>]</span><br><span class="line">        <span class="keyword">if</span> (isDark) {</span><br><span class="line">            <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">"switch_default"</span>).<span class="property">checked</span> = <span class="literal">true</span>;</span><br><span class="line">            <span class="comment">// mobile</span></span><br><span class="line">            <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">"mobile-toggle-theme"</span>).<span class="property">innerText</span> = <span class="string">"· Dark"</span></span><br><span class="line">        } <span class="keyword">else</span> {</span><br><span class="line">            <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">"switch_default"</span>).<span class="property">checked</span> = <span class="literal">false</span>;</span><br><span class="line">            <span class="comment">// mobile</span></span><br><span class="line">            <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">"mobile-toggle-theme"</span>).<span class="property">innerText</span> = <span class="string">"· Light"</span></span><br><span class="line">        }</span><br><span class="line">        _Blog.<span class="property">toggleTheme</span> = <span class="keyword">function</span> (<span class="params"></span>) {</span><br><span class="line">            <span class="keyword">if</span> (isDark) {</span><br><span class="line">                pagebody.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">'dark-theme'</span>);</span><br><span class="line">                <span class="comment">// mobile</span></span><br><span class="line">                <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">"mobile-toggle-theme"</span>).<span class="property">innerText</span> = <span class="string">"· Dark"</span></span><br><span class="line">            } <span class="keyword">else</span> {</span><br><span class="line">                pagebody.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">'dark-theme'</span>);</span><br><span class="line">                <span class="comment">// mobile</span></span><br><span class="line">                <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">"mobile-toggle-theme"</span>).<span class="property">innerText</span> = <span class="string">"· Light"</span></span><br><span class="line">            }</span><br><span class="line">            <span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">'toggleBtn'</span>)[<span class="number">0</span>].<span class="title function_">addEventListener</span>(<span class="string">'click'</span>, <span class="function">() =&gt;</span> {</span><br><span class="line">                <span class="keyword">if</span> (pagebody.<span class="property">classList</span>.<span class="title function_">contains</span>(<span class="string">'dark-theme'</span>)) {</span><br><span class="line">                    pagebody.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">'dark-theme'</span>);</span><br><span class="line">                } <span class="keyword">else</span> {</span><br><span class="line">                    pagebody.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">'dark-theme'</span>);</span><br><span class="line">                }</span><br><span class="line">                <span class="variable language_">window</span>.<span class="property">localStorage</span> &amp;&amp;</span><br><span class="line">                <span class="variable language_">window</span>.<span class="property">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">'theme'</span>, <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">classList</span>.<span class="title function_">contains</span>(<span class="string">'dark-theme'</span>) ? <span class="string">'dark'</span> : <span class="string">'light'</span>,)</span><br><span class="line">            })</span><br><span class="line">            <span class="comment">// moblie</span></span><br><span class="line">            <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">'mobile-toggle-theme'</span>).<span class="title function_">addEventListener</span>(<span class="string">'click'</span>, <span class="function">() =&gt;</span> {</span><br><span class="line">                <span class="keyword">if</span> (pagebody.<span class="property">classList</span>.<span class="title function_">contains</span>(<span class="string">'dark-theme'</span>)) {</span><br><span class="line">                    pagebody.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">'dark-theme'</span>);</span><br><span class="line">                    <span class="comment">// mobile</span></span><br><span class="line">                    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">"mobile-toggle-theme"</span>).<span class="property">innerText</span> = <span class="string">"· Light"</span></span><br><span class="line"></span><br><span class="line">                } <span class="keyword">else</span> {</span><br><span class="line">                    pagebody.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">'dark-theme'</span>);</span><br><span class="line">                    <span class="comment">// mobile</span></span><br><span class="line">                    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">"mobile-toggle-theme"</span>).<span class="property">innerText</span> = <span class="string">"· Dark"</span></span><br><span class="line">                }</span><br><span class="line">                <span class="variable language_">window</span>.<span class="property">localStorage</span> &amp;&amp;</span><br><span class="line">                <span class="variable language_">window</span>.<span class="property">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">'theme'</span>, <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">classList</span>.<span class="title function_">contains</span>(<span class="string">'dark-theme'</span>) ? <span class="string">'dark'</span> : <span class="string">'light'</span>,)</span><br><span class="line">            })</span><br><span class="line">        };</span><br><span class="line">        _Blog.<span class="title function_">toggleTheme</span>();</span><br><span class="line">        <span class="comment">// ready function.</span></span><br><span class="line">    }</span><br><span class="line">);</span><br></pre></td></tr></tbody></table></figure>

<p>应该就可以了……吧。我也不是很确定。请原谅我这个简陋的总结……</p>
<h2 id="About页面夜间模式时的字体颜色"><a href="#About页面夜间模式时的字体颜色" class="headerlink" title="About页面夜间模式时的字体颜色"></a>About页面夜间模式时的字体颜色</h2><p>突然发现About页面在夜间模式的字体是惨白色，不仅不好看，而且和其中的链接的颜色相同，不像日间模式的时候是文字黑色、链接蓝色。参考Posts中的颜色，发现在夜间模式时，标题和正文的字体颜色是#a9a9b2，链接颜色是白色。于是想统一一下颜色。</p>
<p>根据ChatGPT的指导，在custom.styl中插入如下代码：</p>
<figure class="highlight css"><table><tbody><tr><td class="code"><pre><span class="line"><span class="selector-tag">body</span><span class="selector-class">.dark-theme</span> <span class="selector-class">.post-title</span> {</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#a9a9b2</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">body</span><span class="selector-class">.dark-theme</span> <span class="selector-class">.post-content</span> {</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#a9a9b2</span>;</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<p>即可。</p>
<h2 id="夜间模式随系统颜色模式开启"><a href="#夜间模式随系统颜色模式开启" class="headerlink" title="夜间模式随系统颜色模式开启"></a>夜间模式随系统颜色模式开启</h2><p>在/js/script.js中添加如下代码：</p>
<figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line"><span class="variable language_">window</span>.<span class="property">onload</span> = <span class="keyword">function</span>(<span class="params"></span>) {</span><br><span class="line">    <span class="keyword">const</span> themeToggleCheckbox = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">'switch_default'</span>);</span><br><span class="line">    <span class="keyword">const</span> themeToggleButton = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">'mobile-toggle-theme'</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 检测用户的系统主题偏好</span></span><br><span class="line">    <span class="keyword">const</span> userPrefersDark = <span class="variable language_">window</span>.<span class="property">matchMedia</span> &amp;&amp; <span class="variable language_">window</span>.<span class="title function_">matchMedia</span>(<span class="string">'(prefers-color-scheme: dark)'</span>).<span class="property">matches</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 根据用户的系统主题偏好设置 toggle 的状态和 body 的类</span></span><br><span class="line">    <span class="keyword">if</span> (userPrefersDark) {</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">'dark-theme'</span>);</span><br><span class="line">        themeToggleCheckbox.<span class="property">checked</span> = <span class="literal">true</span>; <span class="comment">// 设置 toggle 为打开状态</span></span><br><span class="line">        themeToggleButton.<span class="property">textContent</span> = <span class="string">'· Dark'</span>; <span class="comment">// 设置按钮文本</span></span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">'dark-theme'</span>);</span><br><span class="line">        themeToggleCheckbox.<span class="property">checked</span> = <span class="literal">false</span>; <span class="comment">// 设置 toggle 为关闭状态</span></span><br><span class="line">        themeToggleButton.<span class="property">textContent</span> = <span class="string">'· Light'</span>; <span class="comment">// 设置按钮文本</span></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 当用户手动切换 toggle 时，更新颜色模式</span></span><br><span class="line">    themeToggleCheckbox.<span class="title function_">addEventListener</span>(<span class="string">'change'</span>, <span class="keyword">function</span>(<span class="params"></span>) {</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">classList</span>.<span class="title function_">toggle</span>(<span class="string">'dark-theme'</span>, themeToggleCheckbox.<span class="property">checked</span>);</span><br><span class="line">    });</span><br><span class="line">};</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<p>其中包括电脑端和移动端。一开始踩了个坑是在同一个页面中用了两个“window.onload”函数，结果前一个被后一个覆盖了。然后把两个合并成一个，就修好了。注释很详细，其中一部分代码是用于在网页随系统自动切换成夜间模式的时候，让Toggle呈打开状态（或是在移动端时，显示“Dark”）。一点小小强迫症。</p>
<h3 id="夜间模式下切换页面时发生白色闪烁"><a href="#夜间模式下切换页面时发生白色闪烁" class="headerlink" title="夜间模式下切换页面时发生白色闪烁"></a>夜间模式下切换页面时发生白色闪烁</h3><p>这个问题虽然解决了，但是从日间自动切换到夜间模式的速度很慢，表现为屏幕会闪烁一下白色。问了ChatGPT，按道理来说这个不应该用JavaScript改，应该直接在CSS里面改，不过我懒得再重新研究了，于是问GPT能不能在我JavaScript代码的基础上进行优化。它给了这么一段代码：</p>
<figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">'DOMContentLoaded'</span>, <span class="keyword">function</span>(<span class="params"></span>) {</span><br><span class="line">    <span class="keyword">const</span> themeToggleCheckbox = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">'switch_default'</span>);</span><br><span class="line">    <span class="keyword">const</span> themeToggleButton = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">'mobile-toggle-theme'</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 检测用户的系统主题偏好</span></span><br><span class="line">    <span class="keyword">const</span> userPrefersDark = <span class="variable language_">window</span>.<span class="property">matchMedia</span> &amp;&amp; <span class="variable language_">window</span>.<span class="title function_">matchMedia</span>(<span class="string">'(prefers-color-scheme: dark)'</span>).<span class="property">matches</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 根据用户的系统主题偏好设置 toggle 的状态和 body 的类</span></span><br><span class="line">    <span class="keyword">if</span> (userPrefersDark) {</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">'dark-theme'</span>);</span><br><span class="line">        themeToggleCheckbox.<span class="property">checked</span> = <span class="literal">true</span>; <span class="comment">// 设置 toggle 为打开状态</span></span><br><span class="line">        themeToggleButton.<span class="property">textContent</span> = <span class="string">'· Dark'</span>; <span class="comment">// 设置按钮文本</span></span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">'dark-theme'</span>);</span><br><span class="line">        themeToggleCheckbox.<span class="property">checked</span> = <span class="literal">false</span>; <span class="comment">// 设置 toggle 为关闭状态</span></span><br><span class="line">        themeToggleButton.<span class="property">textContent</span> = <span class="string">'· Light'</span>; <span class="comment">// 设置按钮文本</span></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 当用户手动切换 toggle 时，更新颜色模式</span></span><br><span class="line">    themeToggleCheckbox.<span class="title function_">addEventListener</span>(<span class="string">'change'</span>, <span class="keyword">function</span>(<span class="params"></span>) {</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">classList</span>.<span class="title function_">toggle</span>(<span class="string">'dark-theme'</span>, themeToggleCheckbox.<span class="property">checked</span>);</span><br><span class="line">        themeToggleButton.<span class="property">textContent</span> = themeToggleCheckbox.<span class="property">checked</span> ? <span class="string">'· Dark'</span> : <span class="string">'· Light'</span>; <span class="comment">// 更新按钮文本</span></span><br><span class="line">    });</span><br><span class="line">});</span><br></pre></td></tr></tbody></table></figure>
<p>改过之后还是有白色闪烁，不过加载速度是快一点了。</p>
<h3 id="新的问题"><a href="#新的问题" class="headerlink" title="新的问题"></a>新的问题</h3><p>结果又有了别的问题……在系统为夜间模式的情况下，将按钮调到日间模式，页面变白。但是当点击链接跳转到其他页面时，页面又会转为黑色。所以又让GPT生成了新的代码：</p>
<figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">'DOMContentLoaded'</span>, <span class="keyword">function</span>(<span class="params"></span>) {</span><br><span class="line">    <span class="keyword">const</span> themeToggleCheckbox = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">'switch_default'</span>);</span><br><span class="line">    <span class="keyword">const</span> themeToggleButton = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">'mobile-toggle-theme'</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 检测用户的系统主题偏好</span></span><br><span class="line">    <span class="keyword">const</span> userPrefersDark = <span class="variable language_">window</span>.<span class="property">matchMedia</span> &amp;&amp; <span class="variable language_">window</span>.<span class="title function_">matchMedia</span>(<span class="string">'(prefers-color-scheme: dark)'</span>).<span class="property">matches</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 根据用户的系统主题偏好设置 toggle 的状态和 body 的类</span></span><br><span class="line">    <span class="keyword">if</span> (userPrefersDark) {</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">'dark-theme'</span>);</span><br><span class="line">        themeToggleCheckbox.<span class="property">checked</span> = <span class="literal">true</span>; <span class="comment">// 设置 toggle 为打开状态</span></span><br><span class="line">        themeToggleButton.<span class="property">textContent</span> = <span class="string">'· Dark'</span>; <span class="comment">// 设置按钮文本</span></span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">'dark-theme'</span>);</span><br><span class="line">        themeToggleCheckbox.<span class="property">checked</span> = <span class="literal">false</span>; <span class="comment">// 设置 toggle 为关闭状态</span></span><br><span class="line">        themeToggleButton.<span class="property">textContent</span> = <span class="string">'· Light'</span>; <span class="comment">// 设置按钮文本</span></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 当用户手动切换 toggle 时，更新颜色模式</span></span><br><span class="line">    themeToggleCheckbox.<span class="title function_">addEventListener</span>(<span class="string">'change'</span>, <span class="keyword">function</span>(<span class="params"></span>) {</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">classList</span>.<span class="title function_">toggle</span>(<span class="string">'dark-theme'</span>, themeToggleCheckbox.<span class="property">checked</span>);</span><br><span class="line">        themeToggleButton.<span class="property">textContent</span> = themeToggleCheckbox.<span class="property">checked</span> ? <span class="string">'· Dark'</span> : <span class="string">'· Light'</span>; <span class="comment">// 更新按钮文本</span></span><br><span class="line">    });</span><br><span class="line">});</span><br></pre></td></tr></tbody></table></figure>

<p>似乎暂时解决了问题。</p>
<h3 id="白色闪烁2"><a href="#白色闪烁2" class="headerlink" title="白色闪烁2"></a>白色闪烁2</h3><p>（2023-10-19）又折腾了，想让GPT把相同的逻辑在ejs文件里操作完成，而不是js文件里，从而看看能不能减少闪烁。GPT给出的建议是：</p>
<blockquote>
<p>将 JavaScript 逻辑放在 HTML 文档的 <code>&lt;head&gt;</code> 部分，并直接在其中执行（而不是等待 DOMContentLoaded 事件），可能会帮助减少页面加载时的闪烁。以下是如何在 HTML 文档的 <code>&lt;head&gt;</code> 部分内嵌此逻辑的示例：</p>
<figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"&lt;%= config.language %&gt;"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    &lt;%- partial('_partial/head',{cache: true}) %&gt;</span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        (<span class="keyword">function</span>(<span class="params"></span>) {</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> savedTheme = <span class="variable language_">sessionStorage</span>.<span class="title function_">getItem</span>(<span class="string">'theme'</span>);</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> userPrefersDark = <span class="variable language_">window</span>.<span class="property">matchMedia</span> &amp;&amp; <span class="variable language_">window</span>.<span class="title function_">matchMedia</span>(<span class="string">'(prefers-color-scheme: dark)'</span>).<span class="property">matches</span>;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> useDarkMode = savedTheme ? savedTheme === <span class="string">'dark'</span> : userPrefersDark;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span> (useDarkMode) {</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">style</span>.<span class="property">backgroundColor</span> = <span class="string">'#121212'</span>; <span class="comment">// 临时背景色，可以根据你的暗主题颜色进行更改</span></span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">'dark-theme'</span>);</span></span><br><span class="line"><span class="language-javascript">            }</span></span><br><span class="line"><span class="language-javascript">        })();</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 页面内容 --&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">'DOMContentLoaded'</span>, <span class="keyword">function</span>(<span class="params"></span>) {</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> themeToggleCheckbox = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">'switch_default'</span>);</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> themeToggleButton = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">'mobile-toggle-theme'</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            themeToggleCheckbox.<span class="title function_">addEventListener</span>(<span class="string">'change'</span>, <span class="keyword">function</span>(<span class="params"></span>) {</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">const</span> isDark = themeToggleCheckbox.<span class="property">checked</span>;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">classList</span>.<span class="title function_">toggle</span>(<span class="string">'dark-theme'</span>, isDark);</span></span><br><span class="line"><span class="language-javascript">                themeToggleButton.<span class="property">textContent</span> = isDark ? <span class="string">'· Dark'</span> : <span class="string">'· Light'</span>;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">sessionStorage</span>.<span class="title function_">setItem</span>(<span class="string">'theme'</span>, isDark ? <span class="string">'dark'</span> : <span class="string">'light'</span>);</span></span><br><span class="line"><span class="language-javascript">            });</span></span><br><span class="line"><span class="language-javascript">        });</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>在这里，我做了几个改动：</p>
<ol>
<li>我在 <code>&lt;head&gt;</code> 中直接执行了一个自执行的函数，该函数会尽快地（在 DOM 完全加载之前）设置页面的主题。</li>
<li>我还设置了 <a class="break-link no-style"> <code>document.documentElement.style.backgroundColor</code> </a>，这可以更快地显示正确的背景颜色，减少从默认背景色到暗主题背景色的转变所导致的闪烁。</li>
</ol>
<p>你可以根据自己网站的暗主题背景颜色修改临时背景色。希望这可以帮助减少闪烁问题！</p>
</blockquote>
<p>改完之后体感闪烁变成了有时候有，有时候没有。于是又采纳了社友nekobus的建议：</p>
<blockquote>
<p>把css里面的transition去掉</p>
</blockquote>
<p>于是把base.styl里有关transition的代码都删除了。删除之后，闪烁时屏幕为白色的时间缩短了，也就是闪得更快了。</p>
<p>虽然还是没有完全解决问题，但是折腾了这么久，有这个结果我也很是欣慰了……以后看看还有没有优化的空间吧。</p>
<h3 id="从头再来"><a href="#从头再来" class="headerlink" title="从头再来"></a>从头再来</h3><p>2023-10-20更新：草，昨天博客崩了……修好之后上面的代码出问题了，只好又弄了一个，暂时还算是正确的？</p>
<figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    (<span class="keyword">function</span>(<span class="params"></span>) {</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 在页面加载时根据存储的主题或用户的系统偏好设置主题</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> savedTheme = <span class="variable language_">sessionStorage</span>.<span class="title function_">getItem</span>(<span class="string">'theme'</span>) || <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">'theme'</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> userPrefersDark = <span class="variable language_">window</span>.<span class="property">matchMedia</span> &amp;&amp; <span class="variable language_">window</span>.<span class="title function_">matchMedia</span>(<span class="string">'(prefers-color-scheme: dark)'</span>).<span class="property">matches</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> useDarkMode = savedTheme ? savedTheme === <span class="string">'dark'</span> : userPrefersDark;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (useDarkMode) {</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">'dark-theme'</span>);</span></span><br><span class="line"><span class="language-javascript">        }</span></span><br><span class="line"><span class="language-javascript">    })();</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">'DOMContentLoaded'</span>, <span class="keyword">function</span>(<span class="params"></span>) {</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> themeToggleMobile = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">'mobile-toggle-theme'</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">function</span> <span class="title function_">updateButtonText</span>(<span class="params">isDark</span>) {</span></span><br><span class="line"><span class="language-javascript">            themeToggleMobile.<span class="property">textContent</span> = isDark ? <span class="string">'· Dark'</span> : <span class="string">'· Light'</span>;</span></span><br><span class="line"><span class="language-javascript">        }</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">function</span> <span class="title function_">toggleTheme</span>(<span class="params"></span>) {</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> isDark = <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">classList</span>.<span class="title function_">toggle</span>(<span class="string">'dark-theme'</span>);</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">classList</span>.<span class="title function_">toggle</span>(<span class="string">'dark-theme'</span>, isDark);</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">sessionStorage</span>.<span class="title function_">setItem</span>(<span class="string">'theme'</span>, isDark ? <span class="string">'dark'</span> : <span class="string">'light'</span>);</span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">updateButtonText</span>(isDark);</span></span><br><span class="line"><span class="language-javascript">        }</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 初始化按钮文本</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> initialIsDark = <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">classList</span>.<span class="title function_">contains</span>(<span class="string">'dark-theme'</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">updateButtonText</span>(initialIsDark);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 为移动端的切换按钮添加事件监听器</span></span></span><br><span class="line"><span class="language-javascript">        themeToggleMobile.<span class="title function_">addEventListener</span>(<span class="string">'click'</span>, toggleTheme);</span></span><br><span class="line"><span class="language-javascript">    });</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<h3 id="html元素始终是dark-theme类"><a href="#html元素始终是dark-theme类" class="headerlink" title="html元素始终是dark-theme类"></a>html元素始终是dark-theme类</h3><p>晚上更新：随着夜幕的降临，我的系统切换成了夜间模式，结果……又出现了问题……</p>
<p><img src="https://github.com/greendolphindance/greendolphindance.github.io/assets/87912044/58490fdd-cf76-4fe6-a917-f46236449e27" alt="18782d644e33b666eda1c4a6511c6a12"></p>
<p>啊啊啊啊啊啊啊！！崩溃！</p>
<p>冷静下来开始解决问题。通过网页检查器调试，发现问题可以被表述为：html元素的类属性始终是“dark-theme“。于是开始调教GPT。</p>
<p>现在写prompt愈发熟练，然后又能够看得懂一点代码了，也会了一点调试方法，所以过程虽然曲折（GPT太蠢），但稳步前进。以下是GPT的总结：</p>
<blockquote>
<h3 id="解决问题总结：HTML-仍是夜间模式"><a href="#解决问题总结：HTML-仍是夜间模式" class="headerlink" title="解决问题总结：HTML 仍是夜间模式"></a>解决问题总结：HTML 仍是夜间模式</h3><h4 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h4><p>在尝试根据用户的系统偏好和用户切换来动态更改页面主题时，我们遇到了一个问题：即使在用户切换主题后，<code>html</code> 元素的类属性仍然被设置为 <code>dark-theme</code>。</p>
<h4 id="尝试和失败的方法"><a href="#尝试和失败的方法" class="headerlink" title="尝试和失败的方法"></a>尝试和失败的方法</h4><ol>
<li><p><strong>尝试1：代码位置调整</strong></p>
<p>首先尝试将 JavaScript 代码从 <code>body</code> 标签移到 <code>head</code> 标签，期望在页面加载前更早地应用主题。</p>
<p><strong>结果：</strong> <code>html</code> 元素仍然保留了 <code>dark-theme</code> 类。</p>
</li>
<li><p><strong>尝试2：调整 JavaScript 逻辑</strong></p>
<p>尝试通过优化 JavaScript 逻辑来更精确地控制主题的应用，包括在页面加载时就根据存储的用户偏好设置主题。</p>
<p><strong>结果：</strong> 调整后，依然没能解决 <code>html</code> 元素始终保持 <code>dark-theme</code> 类的问题。</p>
</li>
<li><p><strong>尝试3：使用调试语句</strong></p>
<p>通过在代码中添加调试语句来尝试找到问题所在，了解代码的实际执行流程和 <code>html</code> 元素类属性被修改的时机。</p>
<p><strong>结果：</strong> 通过调试，我们了解到了代码的执行情况，但仍然没有解决问题。</p>
</li>
</ol>
<h4 id="成功的方法"><a href="#成功的方法" class="headerlink" title="成功的方法"></a>成功的方法</h4><p><strong>方法：专注于 <code>body</code> 标签并且改进 JavaScript 逻辑</strong></p>
<p>最终，我们决定集中注意力修改 <code>body</code> 元素的类属性，而不是 <code>html</code> 元素。同时，我们优化了 JavaScript 代码，使其在页面加载时更准确地根据用户的系统偏好和存储的主题偏好来设置主题。</p>
<p>在实际代码中，我们：</p>
<ul>
<li>在 DOM 加载完成后执行 JavaScript 代码。</li>
<li>首先根据存储的主题偏好设置主题，如果没有存储的偏好，则根据用户的系统偏好设置主题。</li>
<li>最终成功的代码可以实时响应用户的切换操作，并在用户重新访问页面时记住用户的主题偏好。</li>
</ul>
<p>这样，我们成功解决了 <code>html</code> 元素始终保持 <code>dark-theme</code> 类的问题，并确保了网站可以根据用户的偏好和操作实时地、准确地应用日间/夜间模式。</p>
</blockquote>
<p>最终写出来的代码是这样的：</p>
<figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">'DOMContentLoaded'</span>, <span class="keyword">function</span>(<span class="params"></span>) {</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> savedTheme = <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">'theme'</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">alert</span>(<span class="string">"Saved theme: "</span>, savedTheme); <span class="comment">// 输出保存的主题</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> userPrefersDark = <span class="variable language_">window</span>.<span class="property">matchMedia</span> &amp;&amp; <span class="variable language_">window</span>.<span class="title function_">matchMedia</span>(<span class="string">'(prefers-color-scheme: dark)'</span>).<span class="property">matches</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">alert</span>(<span class="string">"User prefers dark theme: "</span>, userPrefersDark); <span class="comment">// 输出用户的系统偏好</span></span></span><br><span class="line"><span class="language-javascript">        </span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> useDarkMode;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (savedTheme === <span class="string">'dark'</span> || savedTheme === <span class="string">'light'</span>) { <span class="comment">// 当有明确的保存主题时</span></span></span><br><span class="line"><span class="language-javascript">            useDarkMode = savedTheme === <span class="string">'dark'</span>;</span></span><br><span class="line"><span class="language-javascript">        } <span class="keyword">else</span> {</span></span><br><span class="line"><span class="language-javascript">            useDarkMode = userPrefersDark; <span class="comment">// 默认使用系统偏好</span></span></span><br><span class="line"><span class="language-javascript">        }</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">alert</span>(<span class="string">"Using dark theme: "</span>, useDarkMode); <span class="comment">// 输出是否使用暗主题</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">classList</span>.<span class="title function_">toggle</span>(<span class="string">'dark-theme'</span>, useDarkMode); <span class="comment">// 应用或移除 dark-theme 类</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> themeToggleCheckbox = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">'switch_default'</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (themeToggleCheckbox) {</span></span><br><span class="line"><span class="language-javascript">            themeToggleCheckbox.<span class="property">checked</span> = useDarkMode;</span></span><br><span class="line"><span class="language-javascript">        }</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        themeToggleCheckbox.<span class="title function_">addEventListener</span>(<span class="string">'change'</span>, <span class="keyword">function</span>(<span class="params"></span>) {</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> isChecked = themeToggleCheckbox.<span class="property">checked</span>;</span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">alert</span>(<span class="string">"Checkbox is checked: "</span>, isChecked); <span class="comment">// 输出复选框的状态</span></span></span><br><span class="line"><span class="language-javascript">            </span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">classList</span>.<span class="title function_">toggle</span>(<span class="string">'dark-theme'</span>, isChecked);</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">'theme'</span>, isChecked ? <span class="string">'dark'</span> : <span class="string">'light'</span>);</span></span><br><span class="line"><span class="language-javascript">        });</span></span><br><span class="line"><span class="language-javascript">    });</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<p>祈祷不要再出问题了……</p>
<h3 id="白色闪烁3"><a href="#白色闪烁3" class="headerlink" title="白色闪烁3"></a>白色闪烁3</h3><p>惊讶地发现移动端已经很少出现白色闪烁了（虽然有时候还是有），但是桌面端的闪烁则仍很频繁。GPT给出了两个方案，我同时采纳了，体感闪烁频率有所减少，而且闪烁速度加快，但还是时不时会有。GPT的总结如下：</p>
<blockquote>
<p><strong>1. 优先执行主题设置的 JavaScript</strong>:</p>
<p>   将处理主题的 JavaScript 代码放在页面 <code>&lt;head&gt;</code> 部分并优先执行。这是为了确保在加载和应用其他 CSS 或 JavaScript 之前，根据本地存储或用户的偏好来设置相应的主题。</p>
   <figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        (<span class="keyword">function</span>(<span class="params"></span>) {</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> savedTheme = <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">'theme'</span>);</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> userPrefersDark = <span class="variable language_">window</span>.<span class="property">matchMedia</span> &amp;&amp; <span class="variable language_">window</span>.<span class="title function_">matchMedia</span>(<span class="string">'(prefers-color-scheme: dark)'</span>).<span class="property">matches</span>;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">let</span> useDarkMode = savedTheme ? savedTheme === <span class="string">'dark'</span> : userPrefersDark;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">classList</span>.<span class="title function_">toggle</span>(<span class="string">'dark-theme'</span>, useDarkMode);</span></span><br><span class="line"><span class="language-javascript">        })();</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<p><strong>2. 使用 CSS 隐藏内容</strong>:</p>
<p>   如果即便优先执行了主题设置代码仍然出现闪烁，可以考虑暂时使用 CSS 来隐藏页面的内容，直至 JavaScript 代码运行并应用了正确的主题。</p>
   <figure class="highlight css"><table><tbody><tr><td class="code"><pre><span class="line"><span class="selector-tag">body</span> {</span><br><span class="line">    <span class="attribute">visibility</span>: hidden; <span class="comment">/* 初始隐藏内容 */</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">body</span><span class="selector-class">.theme-loaded</span> {</span><br><span class="line">    <span class="attribute">visibility</span>: visible; <span class="comment">/* JavaScript 设置完主题后显示内容 */</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>   在 JavaScript 中，当主题被正确设置后，您可以添加一个类（例如 <code>theme-loaded</code>）来显示页面内容。</p>
   <figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">'DOMContentLoaded'</span>, <span class="keyword">function</span>(<span class="params"></span>) {</span><br><span class="line">    <span class="keyword">const</span> themeToggleCheckbox = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">'switch_default'</span>);</span><br><span class="line"></span><br><span class="line">    themeToggleCheckbox.<span class="title function_">addEventListener</span>(<span class="string">'change'</span>, <span class="keyword">function</span>(<span class="params"></span>) {</span><br><span class="line">        <span class="keyword">const</span> isChecked = themeToggleCheckbox.<span class="property">checked</span>;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">classList</span>.<span class="title function_">toggle</span>(<span class="string">'dark-theme'</span>, isChecked);</span><br><span class="line">        <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">'theme'</span>, isChecked ? <span class="string">'dark'</span> : <span class="string">'light'</span>);</span><br><span class="line">    });</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">'theme-loaded'</span>); <span class="comment">// 页面加载完成后显示内容</span></span><br><span class="line">});</span><br></pre></td></tr></tbody></table></figure>

<p>这种方式尽可能减少了页面加载时的闪烁，通过在页面结构加载之前就确定并设置好用户的主题偏好。在全部内容加载完毕后再显示，从而避免了主题切换时的闪烁。</p>
</blockquote>
<p>好吧，看来这就是我的能力限度了。暂时先这样吧。</p>
<h1 id="版权声明"><a href="#版权声明" class="headerlink" title="版权声明"></a>版权声明</h1><p>我使用的是CC协议，在<a target="_blank" rel="noopener" href="https://chooser-beta.creativecommons.org/">这个</a>网站上生成html代码。生成代码后，我进行了各种调整，包括去掉文字只显示图标、调整footer内容顺序、图标缩小、图标居中等等，把GPT烦死了。弄好之后我的footer.ejs部分内容如下：</p>
<figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">footer</span> <span class="attr">id</span>=<span class="string">"footer"</span> <span class="attr">class</span>=<span class="string">"footer"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"copyright"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"http://creativecommons.org/licenses/by-nc/4.0/?ref=chooser-v1"</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">rel</span>=<span class="string">"license noopener noreferrer"</span> <span class="attr">style</span>=<span class="string">"display:inline-block;"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">img</span> <span class="attr">style</span>=<span class="string">"height:16px!important;margin-left:1px;vertical-align: middle; position: relative; top: -1px;"</span> <span class="attr">src</span>=<span class="string">"https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">img</span> <span class="attr">style</span>=<span class="string">"height:16px!important;margin-left:1px;vertical-align: middle; position: relative; top: -1px;"</span> <span class="attr">src</span>=<span class="string">"https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">img</span> <span class="attr">style</span>=<span class="string">"height:16px!important;margin-left:1px;vertical-align: middle; position: relative; top: -1px;"</span> <span class="attr">src</span>=<span class="string">"https://mirrors.creativecommons.org/presskit/icons/nc.svg?ref=chooser-v1"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            | Powered by <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"https://hexo.io"</span> <span class="attr">target</span>=<span class="string">"_blank"</span>&gt;</span>Hexo<span class="tag">&lt;/<span class="name">a</span>&gt;</span> &amp; <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"https://github.com/Siricee/hexo-theme-Chic"</span> <span class="attr">target</span>=<span class="string">"_blank"</span>&gt;</span>Chic<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            | <span class="tag">&lt;<span class="name">script</span> <span class="attr">async</span> <span class="attr">src</span>=<span class="string">"//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"busuanzi_value_site_uv"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<p>其中图标的垂直位置是手动调的相对位置，因为直接居中的话，图标……居得不是很中。这部分是我的折腾中相对容易的部分了。比较遗憾的是CC协议的图标在夜间模式下比较丑，而且这没法改。</p>
<h2 id="颜色修改"><a href="#颜色修改" class="headerlink" title="颜色修改"></a>颜色修改</h2><p>（2023-12-7更新）之前说到CC协议的图标在夜间模式下比较丑，没法改，今天鼓起勇气着手修改，最终成功。思路是先编辑SVG文档，把协议的几个图标中间改为透明色，然后再修改CSS样式，使得在夜间模式下边框颜色为#a9a9b2（夜间模式下文字的颜色）。</p>
<p>其中，修改SVG文档用到的是<a target="_blank" rel="noopener" href="https://www.svgviewer.dev/">这个网站</a>。具体的修改是将&lt;circle…/&gt;中的fill从原来的”#FFFFFF”改成”none”。</p>
<p>修改后完整的footer.ejs内容如下：</p>
<figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">footer</span> <span class="attr">id</span>=<span class="string">"footer"</span> <span class="attr">class</span>=<span class="string">"footer"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"copyright"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- Existing Creative Commons images and links --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"http://creativecommons.org/licenses/by-nc/4.0/?ref=chooser-v1"</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">rel</span>=<span class="string">"license noopener noreferrer"</span> <span class="attr">style</span>=<span class="string">"display:inline-block;"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">"http://www.w3.org/2000/svg"</span> <span class="attr">style</span>=<span class="string">"height:16px; width:16px; margin-left:1px;vertical-align: middle; position: relative; top: -1px;"</span> <span class="attr">class</span>=<span class="string">"cc-logo"</span> <span class="attr">xmlns:xlink</span>=<span class="string">"http://www.w3.org/1999/xlink"</span> <span class="attr">version</span>=<span class="string">"1.0"</span> <span class="attr">id</span>=<span class="string">"Layer_1"</span> <span class="attr">x</span>=<span class="string">"0px"</span> <span class="attr">y</span>=<span class="string">"0px"</span> <span class="attr">width</span>=<span class="string">"64px"</span> <span class="attr">height</span>=<span class="string">"64px"</span> <span class="attr">viewBox</span>=<span class="string">"5.5 -3.5 64 64"</span> <span class="attr">enable-background</span>=<span class="string">"new 5.5 -3.5 64 64"</span> <span class="attr">xml:space</span>=<span class="string">"preserve"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">g</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">circle</span> <span class="attr">fill</span>=<span class="string">"none"</span> <span class="attr">cx</span>=<span class="string">"37.785"</span> <span class="attr">cy</span>=<span class="string">"28.501"</span> <span class="attr">r</span>=<span class="string">"28.836"</span>/&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">path</span> <span class="attr">d</span>=<span class="string">"M37.441-3.5c8.951,0,16.572,3.125,22.857,9.372c3.008,3.009,5.295,6.448,6.857,10.314   c1.561,3.867,2.344,7.971,2.344,12.314c0,4.381-0.773,8.486-2.314,12.313c-1.543,3.828-3.82,7.21-6.828,10.143   c-3.123,3.085-6.666,5.448-10.629,7.086c-3.961,1.638-8.057,2.457-12.285,2.457s-8.276-0.808-12.143-2.429   c-3.866-1.618-7.333-3.961-10.4-7.027c-3.067-3.066-5.4-6.524-7-10.372S5.5,32.767,5.5,28.5c0-4.229,0.809-8.295,2.428-12.2   c1.619-3.905,3.972-7.4,7.057-10.486C21.08-0.394,28.565-3.5,37.441-3.5z M37.557,2.272c-7.314,0-13.467,2.553-18.458,7.657   c-2.515,2.553-4.448,5.419-5.8,8.6c-1.354,3.181-2.029,6.505-2.029,9.972c0,3.429,0.675,6.734,2.029,9.913   c1.353,3.183,3.285,6.021,5.8,8.516c2.514,2.496,5.351,4.399,8.515,5.715c3.161,1.314,6.476,1.971,9.943,1.971   c3.428,0,6.75-0.665,9.973-1.999c3.219-1.335,6.121-3.257,8.713-5.771c4.99-4.876,7.484-10.99,7.484-18.344   c0-3.543-0.648-6.895-1.943-10.057c-1.293-3.162-3.18-5.98-5.654-8.458C50.984,4.844,44.795,2.272,37.557,2.272z M37.156,23.187   l-4.287,2.229c-0.458-0.951-1.019-1.619-1.685-2c-0.667-0.38-1.286-0.571-1.858-0.571c-2.856,0-4.286,1.885-4.286,5.657   c0,1.714,0.362,3.084,1.085,4.113c0.724,1.029,1.791,1.544,3.201,1.544c1.867,0,3.181-0.915,3.944-2.743l3.942,2   c-0.838,1.563-2,2.791-3.486,3.686c-1.484,0.896-3.123,1.343-4.914,1.343c-2.857,0-5.163-0.875-6.915-2.629   c-1.752-1.752-2.628-4.19-2.628-7.313c0-3.048,0.886-5.466,2.657-7.257c1.771-1.79,4.009-2.686,6.715-2.686   C32.604,18.558,35.441,20.101,37.156,23.187z M55.613,23.187l-4.229,2.229c-0.457-0.951-1.02-1.619-1.686-2   c-0.668-0.38-1.307-0.571-1.914-0.571c-2.857,0-4.287,1.885-4.287,5.657c0,1.714,0.363,3.084,1.086,4.113   c0.723,1.029,1.789,1.544,3.201,1.544c1.865,0,3.18-0.915,3.941-2.743l4,2c-0.875,1.563-2.057,2.791-3.541,3.686   c-1.486,0.896-3.105,1.343-4.857,1.343c-2.896,0-5.209-0.875-6.941-2.629c-1.736-1.752-2.602-4.19-2.602-7.313   c0-3.048,0.885-5.466,2.658-7.257c1.77-1.79,4.008-2.686,6.713-2.686C51.117,18.558,53.938,20.101,55.613,23.187z"</span>/&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">g</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">"http://www.w3.org/2000/svg"</span> <span class="attr">style</span>=<span class="string">"height:16px; width:16px; margin-left:1px;vertical-align: middle; position: relative; top: -1px;"</span> <span class="attr">class</span>=<span class="string">"att-logo"</span> <span class="attr">xmlns:xlink</span>=<span class="string">"http://www.w3.org/1999/xlink"</span> <span class="attr">version</span>=<span class="string">"1.0"</span> <span class="attr">id</span>=<span class="string">"Layer_1"</span> <span class="attr">x</span>=<span class="string">"0px"</span> <span class="attr">y</span>=<span class="string">"0px"</span> <span class="attr">width</span>=<span class="string">"64px"</span> <span class="attr">height</span>=<span class="string">"64px"</span> <span class="attr">viewBox</span>=<span class="string">"5.5 -3.5 64 64"</span> <span class="attr">enable-background</span>=<span class="string">"new 5.5 -3.5 64 64"</span> <span class="attr">xml:space</span>=<span class="string">"preserve"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">g</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">circle</span> <span class="attr">fill</span>=<span class="string">"none"</span> <span class="attr">cx</span>=<span class="string">"37.637"</span> <span class="attr">cy</span>=<span class="string">"28.806"</span> <span class="attr">r</span>=<span class="string">"28.276"</span>/&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">g</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">path</span> <span class="attr">d</span>=<span class="string">"M37.443-3.5c8.988,0,16.57,3.085,22.742,9.257C66.393,11.967,69.5,19.548,69.5,28.5c0,8.991-3.049,16.476-9.145,22.456    C53.879,57.319,46.242,60.5,37.443,60.5c-8.649,0-16.153-3.144-22.514-9.43C8.644,44.784,5.5,37.262,5.5,28.5    c0-8.761,3.144-16.342,9.429-22.742C21.101-0.415,28.604-3.5,37.443-3.5z M37.557,2.272c-7.276,0-13.428,2.553-18.457,7.657    c-5.22,5.334-7.829,11.525-7.829,18.572c0,7.086,2.59,13.22,7.77,18.398c5.181,5.182,11.352,7.771,18.514,7.771    c7.123,0,13.334-2.607,18.629-7.828c5.029-4.838,7.543-10.952,7.543-18.343c0-7.276-2.553-13.465-7.656-18.571    C50.967,4.824,44.795,2.272,37.557,2.272z M46.129,20.557v13.085h-3.656v15.542h-9.944V33.643h-3.656V20.557    c0-0.572,0.2-1.057,0.599-1.457c0.401-0.399,0.887-0.6,1.457-0.6h13.144c0.533,0,1.01,0.2,1.428,0.6    C45.918,19.5,46.129,19.986,46.129,20.557z M33.042,12.329c0-3.008,1.485-4.514,4.458-4.514s4.457,1.504,4.457,4.514    c0,2.971-1.486,4.457-4.457,4.457S33.042,15.3,33.042,12.329z"</span>/&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">g</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">g</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">"http://www.w3.org/2000/svg"</span> <span class="attr">style</span>=<span class="string">"height:16px; width:16px; margin-left:1px;vertical-align: middle; position: relative; top: -1px;"</span> <span class="attr">class</span>=<span class="string">"non-logo"</span> <span class="attr">xmlns:xlink</span>=<span class="string">"http://www.w3.org/1999/xlink"</span> <span class="attr">version</span>=<span class="string">"1.0"</span> <span class="attr">id</span>=<span class="string">"Layer_1"</span> <span class="attr">x</span>=<span class="string">"0px"</span> <span class="attr">y</span>=<span class="string">"0px"</span> <span class="attr">width</span>=<span class="string">"64px"</span> <span class="attr">height</span>=<span class="string">"64px"</span> <span class="attr">viewBox</span>=<span class="string">"5.5 -3.5 64 64"</span> <span class="attr">enable-background</span>=<span class="string">"new 5.5 -3.5 64 64"</span> <span class="attr">xml:space</span>=<span class="string">"preserve"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">g</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">circle</span> <span class="attr">fill</span>=<span class="string">"none"</span> <span class="attr">cx</span>=<span class="string">"37.47"</span> <span class="attr">cy</span>=<span class="string">"28.736"</span> <span class="attr">r</span>=<span class="string">"29.471"</span>/&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">g</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">path</span> <span class="attr">d</span>=<span class="string">"M37.442-3.5c8.99,0,16.571,3.085,22.743,9.256C66.393,11.928,69.5,19.509,69.5,28.5c0,8.992-3.048,16.476-9.145,22.458    C53.88,57.32,46.241,60.5,37.442,60.5c-8.686,0-16.19-3.162-22.513-9.485C8.644,44.728,5.5,37.225,5.5,28.5    c0-8.762,3.144-16.343,9.429-22.743C21.1-0.414,28.604-3.5,37.442-3.5z M12.7,19.872c-0.952,2.628-1.429,5.505-1.429,8.629    c0,7.086,2.59,13.22,7.77,18.4c5.219,5.144,11.391,7.715,18.514,7.715c7.201,0,13.409-2.608,18.63-7.829    c1.867-1.79,3.332-3.657,4.398-5.602l-12.056-5.371c-0.421,2.02-1.439,3.667-3.057,4.942c-1.622,1.276-3.535,2.011-5.744,2.2    v4.915h-3.714v-4.915c-3.543-0.036-6.782-1.312-9.714-3.827l4.4-4.457c2.094,1.942,4.476,2.913,7.143,2.913    c1.104,0,2.048-0.246,2.83-0.743c0.78-0.494,1.172-1.312,1.172-2.457c0-0.801-0.287-1.448-0.858-1.943l-3.085-1.315l-3.771-1.715    l-5.086-2.229L12.7,19.872z M37.557,2.214c-7.276,0-13.428,2.571-18.457,7.714c-1.258,1.258-2.439,2.686-3.543,4.287L27.786,19.7    c0.533-1.676,1.542-3.019,3.029-4.028c1.484-1.009,3.218-1.571,5.2-1.686V9.071h3.715v4.915c2.934,0.153,5.6,1.143,8,2.971    l-4.172,4.286c-1.793-1.257-3.619-1.885-5.486-1.885c-0.991,0-1.876,0.191-2.656,0.571c-0.781,0.381-1.172,1.029-1.172,1.943    c0,0.267,0.095,0.533,0.285,0.8l4.057,1.83l2.8,1.257l5.144,2.285l16.397,7.314c0.535-2.248,0.801-4.533,0.801-6.857    c0-7.353-2.552-13.543-7.656-18.573C51.005,4.785,44.831,2.214,37.557,2.214z"</span>/&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">g</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">g</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">svg</span>&gt;</span> </span><br><span class="line">            <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            | 由 <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"https://hexo.io"</span> <span class="attr">target</span>=<span class="string">"_blank"</span>&gt;</span>Hexo<span class="tag">&lt;/<span class="name">a</span>&gt;</span> &amp; <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"https://github.com/Siricee/hexo-theme-Chic"</span> <span class="attr">target</span>=<span class="string">"_blank"</span>&gt;</span>Chic<span class="tag">&lt;/<span class="name">a</span>&gt;</span> 驱动</span><br><span class="line">            | <span class="tag">&lt;<span class="name">script</span> <span class="attr">async</span> <span class="attr">src</span>=<span class="string">"//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">"busuanzi_value_site_uv"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            | <span class="comment">&lt;!-- Add the SVG logo wrapped in a link --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"https://www.travellings.cn/go.html"</span> <span class="attr">target</span>=<span class="string">"_blank"</span> <span class="attr">style</span>=<span class="string">"display:inline-block;"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">"http://www.w3.org/2000/svg"</span> <span class="attr">class</span>=<span class="string">"kaiwang"</span> <span class="attr">height</span>=<span class="string">"16"</span> <span class="attr">width</span>=<span class="string">"14"</span> <span class="attr">viewBox</span>=<span class="string">"0 0 448 512"</span> <span class="attr">style</span>=<span class="string">"height:16px!important; margin-left:1px; vertical-align: middle; position: relative; top: -1px;"</span>&gt;</span></span><br><span class="line">                    <span class="comment">&lt;!-- SVG Path --&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">path</span> <span class="attr">d</span>=<span class="string">"M96 0C43 0 0 43 0 96V352c0 48 35.2 87.7 81.1 94.9l-46 46C28.1 499.9 33.1 512 43 512H82.7c8.5 0 16.6-3.4 22.6-9.4L160 448H288l54.6 54.6c6 6 14.1 9.4 22.6 9.4H405c10 0 15-12.1 7.9-19.1l-46-46c46-7.1 81.1-46.9 81.1-94.9V96c0-53-43-96-96-96H96zM64 128c0-17.7 14.3-32 32-32h80c17.7 0 32 14.3 32 32v96c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V128zM272 96h80c17.7 0 32 14.3 32 32v96c0 17.7-14.3 32-32 32H272c-17.7 0-32-14.3-32-32V128c0-17.7 14.3-32 32-32zM64 352a32 32 0 1 1 64 0 32 32 0 1 1 -64 0zm288-32a32 32 0 1 1 0 64 32 32 0 1 1 0-64z"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">        <span class="selector-class">.dark-theme</span> <span class="selector-class">.kaiwang</span> {</span></span><br><span class="line"><span class="language-css">            fill: <span class="number">#a9a9b2</span>;</span></span><br><span class="line"><span class="language-css">        }</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="comment">/* Apply fill color based on currentColor for all logos */</span></span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.cc-logo</span> path, <span class="selector-class">.att-logo</span> path, <span class="selector-class">.non-logo</span> path {</span></span><br><span class="line"><span class="language-css">        fill: currentColor;</span></span><br><span class="line"><span class="language-css">    }</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="comment">/* Default color (black) for day mode for all logos */</span></span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.cc-logo</span> path, <span class="selector-class">.att-logo</span> path, <span class="selector-class">.non-logo</span> path {</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>: black;</span></span><br><span class="line"><span class="language-css">    }</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="comment">/* Color (#A9A9B2) for dark theme for all logos */</span></span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.dark-theme</span> <span class="selector-class">.cc-logo</span> path,</span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.dark-theme</span> <span class="selector-class">.att-logo</span> path,</span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.dark-theme</span> <span class="selector-class">.non-logo</span> path {</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>: <span class="number">#A9A9B2</span>;</span></span><br><span class="line"><span class="language-css">    }</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &lt;%- partial('totop') %&gt;</span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"&lt;%- config.root %&gt;js/totop.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- require APlayer --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- require MetingJS --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<h1 id="搜索"><a href="#搜索" class="headerlink" title="搜索"></a>搜索</h1><p>今天（2023-10-16）凌晨翻Chic主题的issues，发现一个<a target="_blank" rel="noopener" href="https://myoontyee.github.io/article/551b025b.html">教程汇总</a>。里面有<a target="_blank" rel="noopener" href="https://myoontyee.github.io/article/1650c0d7.html#header%E5%86%85%E6%B7%BB%E5%8A%A0%E6%90%9C%E7%B4%A2%E6%A1%86">添加搜索功能的教程</a>。此前我也尝试过添加，参考的教程不是针对这个模板的，导致UI太丑，于是作罢。既然有特定的教程，那我来试一下吧！</p>
<p>第一遍失败了，UI和之前添加过的一样，而且不能搜索。大概是之前添加的代码没删干净。于是把_partial文件夹的内容回滚到三天前，再重新操作一次，于是成功。</p>
<p>然后觉得移动端搜索栏展开时有点丑，想要在搜索栏展开时把页面左上角的文字隐藏掉（否则就会和搜索图标重叠），但是没成功，而且还把菜单栏的样式整个弄坏了。于是准备放弃，又回滚重来，但是不知为何还原不了一开始成功时的样式。所以一气之下把移动端的搜索功能整个删除了！最终的搜索栏：电脑端有、手机端横屏竖屏都没有，平板端横屏有、竖屏没有（好麻烦）。 实现很简单，在styl文件中添加：</p>
<figure class="highlight css"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">@media</span> (<span class="attribute">max-width</span>: <span class="number">1024px</span>)</span><br><span class="line">    .search</span><br><span class="line">        display none !important</span><br></pre></td></tr></tbody></table></figure>
<p>即可。</p>
<p>后来（2023-10-20）又改成了“max-width: 800px”。实际上平板设备只有iPad Mini竖屏时不会显示搜索框了（因为实在是很丑）。</p>
<h2 id="微调（2024-1-28）"><a href="#微调（2024-1-28）" class="headerlink" title="微调（2024-1-28）"></a>微调（2024-1-28）</h2><p>进行了一些微调。具体来说，是（1）把移动端搜索框的背景色改为与整体背景色一致，以避免展开搜索框时搜索框和背后的文字打架的现象；（2）设定移动端时，展开的搜索框大小为屏幕的60%，而非原来设置的100%；（3）规定移动端为宽度小于等于900px。</p>
<p>我把search.ejs里涉及移动端宽度的代码的宽度数值改为了900，并修改search.css代码如下：</p>
<figure class="highlight css"><table><tbody><tr><td class="code"><pre><span class="line"><span class="selector-id">#u-search</span> {</span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">    <span class="attribute">position</span>: fixed;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">60px</span> <span class="number">20px</span>;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">1001</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="selector-id">#u-search</span> <span class="selector-class">.modal</span> {</span><br><span class="line">    <span class="attribute">position</span>: fixed;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">80%</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">max-width</span>: <span class="number">640px</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">64px</span> <span class="number">0px</span> <span class="number">0px</span> -<span class="number">320px</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#fff</span>;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">3</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">4px</span>;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#u-search</span> <span class="selector-class">.modal-header</span> {</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">64px</span>;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">3</span>;</span><br><span class="line">    <span class="attribute">border-top-left-radius</span>: <span class="number">4px</span>;</span><br><span class="line">    <span class="attribute">border-top-right-radius</span>: <span class="number">4px</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">16px</span>;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">1px</span> <span class="number">2px</span> <span class="number">0px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.1</span>);</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#fff</span>;</span><br><span class="line">    <span class="attribute">transition</span>: all <span class="number">0.28s</span> ease;</span><br><span class="line">    -moz-<span class="attribute">transition</span>: all <span class="number">0.28s</span> ease;</span><br><span class="line">    -webkit-<span class="attribute">transition</span>: all <span class="number">0.28s</span> ease;</span><br><span class="line">    -o-<span class="attribute">transition</span>: all <span class="number">0.28s</span> ease;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#u-search</span> <span class="selector-class">.modal-header</span> <span class="selector-class">.container</span> {</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">flex-direction</span>: row;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0px</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#u-search</span> <span class="selector-class">.modal-header</span> <span class="selector-class">.container</span> <span class="selector-class">.u-search-modal-form</span> {</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">flex-direction</span>: row;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#u-search</span> <span class="selector-class">.u-search-modal-form</span> <span class="selector-class">.form-submit-btn</span> {</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">50px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">64px</span>;</span><br><span class="line">    <span class="attribute">background</span>: none;</span><br><span class="line">    <span class="attribute">border</span>: none;</span><br><span class="line">    <span class="attribute">outline</span>: none;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">5px</span> <span class="number">0</span> <span class="number">5px</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#u-search</span> <span class="selector-class">.u-search-modal-form</span> <span class="selector-class">.form-submit-btn</span> <span class="selector-tag">img</span> {</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">33px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">33px</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#u-search</span> <span class="selector-class">.modal-header</span> <span class="selector-class">.container</span> <span class="selector-class">.u-search-modal-form</span> <span class="selector-class">.form-input</span> {</span><br><span class="line">    <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line">    <span class="attribute">margin-right</span>: <span class="number">15px</span>;</span><br><span class="line">    <span class="attribute">border</span>: none;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">10px</span> <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">outline</span>: none;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="selector-id">#u-search</span> <span class="selector-class">.modal-header</span> <span class="selector-class">.modal-close</span> {</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">55px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">64px</span>;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#2196f3</span>;</span><br><span class="line">    <span class="attribute">cursor</span>: pointer;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">64px</span>;</span><br><span class="line">    <span class="attribute">vertical-align</span>: middle;</span><br><span class="line">    <span class="attribute">transition</span>: all <span class="number">0.28s</span> ease;</span><br><span class="line">    -moz-<span class="attribute">transition</span>: all <span class="number">0.28s</span> ease;</span><br><span class="line">    -webkit-<span class="attribute">transition</span>: all <span class="number">0.28s</span> ease;</span><br><span class="line">    -o-<span class="attribute">transition</span>: all <span class="number">0.28s</span> ease;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">2</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">22px</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#u-search</span> <span class="selector-class">.modal-header</span> <span class="selector-class">.search-loading</span> {</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">2px</span>;</span><br><span class="line">    <span class="attribute">background</span>: transparent;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#u-search</span> <span class="selector-class">.modal-header</span> <span class="selector-class">.search-loading</span> <span class="selector-class">.search-loading-bar</span> {</span><br><span class="line">    <span class="attribute">transition</span>: all <span class="number">0.28s</span> ease;</span><br><span class="line">    -moz-<span class="attribute">transition</span>: all <span class="number">0.28s</span> ease;</span><br><span class="line">    -webkit-<span class="attribute">transition</span>: all <span class="number">0.28s</span> ease;</span><br><span class="line">    -o-<span class="attribute">transition</span>: all <span class="number">0.28s</span> ease;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">0%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#2196f3</span>;</span><br><span class="line"></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#u-search</span> <span class="selector-class">.modal</span> <span class="selector-class">.modal-body</span> {</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">15px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="built_in">calc</span>(<span class="number">100%</span> - <span class="number">85px</span>);</span><br><span class="line">    <span class="attribute">overflow</span>: auto;</span><br><span class="line"></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#u-search</span> <span class="selector-class">.modal</span> <span class="selector-class">.modal-body</span>::-webkit-scrollbar {</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">5px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">5px</span>;</span><br><span class="line">    <span class="comment">/**/</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#u-search</span> <span class="selector-class">.modal</span> <span class="selector-class">.modal-body</span>::-webkit-scrollbar-track {</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">rgb</span>(<span class="number">239</span>, <span class="number">239</span>, <span class="number">239</span>);</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">2px</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#u-search</span> <span class="selector-class">.modal</span> <span class="selector-class">.modal-body</span>::-webkit-scrollbar-thumb {</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#bfbfbf</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">10px</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#u-search</span> <span class="selector-class">.modal</span> <span class="selector-class">.modal-body</span>::-webkit-scrollbar-thumb:hover {</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#333</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#u-search</span> <span class="selector-class">.modal</span> <span class="selector-class">.modal-body</span>::-webkit-scrollbar-corner {</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#179a16</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#u-search</span> <span class="selector-class">.modal</span> <span class="selector-class">.modal-body</span> <span class="selector-class">.modal-results</span> {</span><br><span class="line">    <span class="attribute">list-style</span>: none;</span><br><span class="line">    <span class="attribute">padding-left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0px</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#u-search</span> <span class="selector-class">.modal</span> <span class="selector-class">.modal-body</span> <span class="selector-class">.modal-results</span> <span class="selector-class">.result-item</span> {</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">15px</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#u-search</span> <span class="selector-class">.modal</span> <span class="selector-class">.modal-body</span> <span class="selector-class">.modal-results</span> <span class="selector-class">.result-item</span><span class="selector-pseudo">:hover</span> {</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#e8f4fd</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#u-search</span> <span class="selector-class">.modal</span> <span class="selector-class">.modal-body</span> <span class="selector-class">.modal-results</span> <span class="selector-class">.result-item</span> <span class="selector-class">.result-item-detail</span> {</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">flex-direction</span>: column;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#u-search</span> <span class="selector-class">.modal</span> <span class="selector-class">.modal-body</span> <span class="selector-class">.modal-results</span> <span class="selector-class">.result-item</span> <span class="selector-class">.result-item-detail</span> <span class="selector-class">.title</span> {</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#6e6e6e</span>;</span><br><span class="line">    <span class="attribute">font-weight</span>: <span class="number">700</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">18px</span>;</span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">10px</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#u-search</span> <span class="selector-class">.modal</span> <span class="selector-class">.modal-body</span> <span class="selector-class">.modal-results</span> <span class="selector-class">.result-item</span> <span class="selector-class">.result-item-detail</span> <span class="selector-class">.content</span> {</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">white-space</span>: inherit;</span><br><span class="line">    <span class="attribute">word-break</span>: break-all;</span><br><span class="line">    <span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">rgba</span>(<span class="number">85</span>, <span class="number">85</span>, <span class="number">85</span>, <span class="number">0.65</span>);</span><br><span class="line">    <span class="attribute">letter-spacing</span>: <span class="number">1px</span>;</span><br><span class="line">    user-select: none;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#u-search</span> <span class="selector-class">.search-keyword</span> {</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#0c7cd5</span>;</span><br><span class="line">    <span class="attribute">text-decoration</span>: underline;</span><br><span class="line">    <span class="attribute">font-weight</span>: bold;</span><br><span class="line">    <span class="attribute">font-style</span>: normal</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#u-search</span> <span class="selector-class">.modal-body</span> <span class="selector-class">.no-result</span> {</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">flex-direction</span>: column;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">justify-content</span>: center;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#u-search</span> <span class="selector-class">.modal-overlay</span> {</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.7</span>);</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">1</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">680px</span>) {</span><br><span class="line">    <span class="selector-id">#u-search</span> {</span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">0px</span>;</span><br><span class="line">        <span class="attribute">display</span>: none;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="selector-id">#u-search</span> <span class="selector-class">.modal</span> {</span><br><span class="line">        <span class="attribute">box-shadow</span>: none;</span><br><span class="line">        <span class="attribute">max-width</span>: none;</span><br><span class="line">        <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">        <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">        <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">        <span class="attribute">border-radius</span>: <span class="number">0</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="selector-id">#u-search</span> <span class="selector-class">.modal-header</span> {</span><br><span class="line">        <span class="attribute">border-radius</span>: <span class="number">0</span>;</span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">0px</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.modal-active</span> {</span><br><span class="line">    <span class="attribute">position</span>: fixed;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 以下是搜索框 */</span></span><br><span class="line"><span class="selector-class">.search</span> {</span><br><span class="line">    <span class="attribute">margin-right</span>: <span class="number">6px</span>;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">flex-direction</span>: row;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.search</span> <span class="selector-class">.form-search</span> {</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">10px</span> <span class="number">8px</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.search</span> <span class="selector-class">.form-search</span> <span class="selector-class">.input</span> {</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">1.3</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#555</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#e8e8e8</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">5px</span> <span class="number">8px</span>;</span><br><span class="line">    <span class="attribute">box-shadow</span>: none;</span><br><span class="line">    <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">1rem</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">8px</span>;</span><br><span class="line">    <span class="attribute">border</span>: none;</span><br><span class="line">    <span class="attribute">outline</span>: none;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.search</span> <span class="selector-class">.search-btn</span> {</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">22px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">22px</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">22px</span>;</span><br><span class="line">    <span class="attribute">margin-right</span>: <span class="number">5px</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.search</span> <span class="selector-class">.search-btn</span> <span class="selector-class">.search-btn-img</span> {</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 搜索框修改 */</span></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">900px</span>) {</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 此处添加了内容 */</span></span><br><span class="line">    <span class="selector-class">.mobile-title-hidden</span> {</span><br><span class="line">        <span class="attribute">transition</span>: all <span class="number">0.5s</span>;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translateX</span>(-<span class="number">300%</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 上面的是添加的内容 */</span></span><br><span class="line">    <span class="selector-class">.navbar-mobile-right</span> {</span><br><span class="line">        <span class="attribute">display</span>: flex;</span><br><span class="line">        <span class="attribute">flex-direction</span>: row;</span><br><span class="line">        <span class="attribute">align-items</span>: center;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.search</span> <span class="selector-class">.search-btn</span> {</span><br><span class="line">        <span class="attribute">cursor</span>: pointer;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.search</span> <span class="selector-class">.form-search</span> {</span><br><span class="line">        <span class="attribute">display</span>: none;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="selector-pseudo">:root</span> {</span><br><span class="line">        <span class="attr">--background-color</span>: white;</span><br><span class="line">        <span class="attr">--night-mode-background-color</span>: <span class="number">#292a2d</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.mobile-search</span> {</span><br><span class="line">        <span class="attribute">transition</span>: width <span class="number">0.3s</span>;</span><br><span class="line">        <span class="attribute">position</span>: absolute;</span><br><span class="line">        <span class="attribute">top</span>: <span class="number">0px</span>;</span><br><span class="line">        <span class="attribute">left</span>: <span class="number">0px</span>;</span><br><span class="line">        <span class="attribute">right</span>: <span class="number">50px</span>;</span><br><span class="line">        <span class="attribute">padding-left</span>: <span class="number">15px</span>;</span><br><span class="line">        <span class="attribute">background</span>: <span class="built_in">var</span>(--background-color);</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">80px</span>;</span><br><span class="line">        <span class="attribute">display</span>: flex;</span><br><span class="line">        <span class="attribute">flex-direction</span>: row;</span><br><span class="line">        <span class="attribute">margin-right</span>: <span class="number">15px</span>;</span><br><span class="line">        <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">        <span class="attribute">max-width</span>: <span class="number">600px</span>;</span><br><span class="line">        <span class="comment">/* 设置最大宽度为600px */</span></span><br><span class="line">        <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">        <span class="comment">/* 让宽度在小于900px时占满整个屏幕 */</span></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* Night Mode */</span></span><br><span class="line">    <span class="selector-tag">body</span><span class="selector-class">.dark-theme</span> <span class="selector-class">.mobile-search</span> {</span><br><span class="line">        <span class="attribute">background</span>: <span class="built_in">var</span>(--night-mode-background-color);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.mobile-search</span> <span class="selector-class">.form-search</span> {</span><br><span class="line">        <span class="attribute">display</span>: block;</span><br><span class="line">        <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.mobile-search</span> <span class="selector-class">.input</span> {</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">900px</span>) {</span><br><span class="line">        <span class="selector-class">.open-search</span> {</span><br><span class="line">            <span class="attribute">position</span>: absolute;</span><br><span class="line">            <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">            <span class="attribute">right</span>: <span class="number">15px</span>;</span><br><span class="line">        }</span><br><span class="line"></span><br><span class="line">        <span class="selector-class">.mobile-search</span> {</span><br><span class="line">            <span class="attribute">width</span>: <span class="number">60%</span>;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.mobile-search</span> <span class="selector-class">.form-search</span> {</span><br><span class="line">        <span class="attribute">display</span>: block;</span><br><span class="line">        <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.mobile-search</span> <span class="selector-class">.input</span> {</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 此处添加了内容 */</span></span><br><span class="line">    <span class="selector-class">.open-search</span> {</span><br><span class="line">        <span class="attribute">position</span>: absolute;</span><br><span class="line">        <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">        <span class="attribute">right</span>: <span class="number">15px</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h1 id="教程汇总里的其他有用教程"><a href="#教程汇总里的其他有用教程" class="headerlink" title="教程汇总里的其他有用教程"></a>教程汇总里的其他有用教程</h1><p><a target="_blank" rel="noopener" href="https://myoontyee.github.io/article/321a7025.html">Archive页面过长博文名省略</a>：在博文名过长的时候将其省略，省略的部分用“…”表示。</p>
<p><a target="_blank" rel="noopener" href="https://myoontyee.github.io/article/9ff0cec8.html">Categories页面过长博文名省略</a>：与上一个教程大同小异，只是调整的是Categories页面。</p>
<p><a target="_blank" rel="noopener" href="https://myoontyee.github.io/article/a150dc7d.html">添加Emoji支持</a>：添加Emoji😈支持。</p>
<p><a target="_blank" rel="noopener" href="https://myoontyee.github.io/article/11459889.html">添加文章字数和阅读时长</a>：如题。</p>
<p><a target="_blank" rel="noopener" href="https://myoontyee.github.io/article/264c6a00.html">谷歌收录</a>：将博客部署到搜索引擎如Google上使得其能被搜索到。</p>
<p><a target="_blank" rel="noopener" href="https://myoontyee.github.io/article/cb001f78.html">打赏</a>：如题，我暂时用不到，先存在这里。</p>
<p><a target="_blank" rel="noopener" href="https://myoontyee.github.io/article/fee5a0e2.html">文章置顶</a>：也暂时用不到，先存在这里。</p>
<h2 id="过长博文名省略"><a href="#过长博文名省略" class="headerlink" title="过长博文名省略"></a>过长博文名省略</h2><p>（2023-12-5更新）发现按照上面的教程操作，只有桌面端的博文名省略了，移动端依旧会超过屏幕。所以修改插入到archive.ejs中的代码如下：</p>
<figure class="highlight css"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">min-width</span>: <span class="number">769px</span>){ </span><br><span class="line">  <span class="selector-tag">li</span> {</span><br><span class="line">      <span class="attribute">width</span>: <span class="number">650px</span>;</span><br><span class="line">      <span class="attribute">height</span>: <span class="number">29.5px</span>;</span><br><span class="line">      <span class="attribute">white-space</span>: nowrap;</span><br><span class="line">      <span class="attribute">overflow</span>: hidden;</span><br><span class="line">      <span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line">  }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Mobile styles */</span></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">768px</span>) {</span><br><span class="line">  <span class="selector-tag">li</span> {</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">285px</span>;  <span class="comment">/* Adjust the width for mobile */</span></span><br><span class="line">    <span class="comment">/* Retain other properties or adjust as needed */</span></span><br><span class="line">    <span class="attribute">height</span>: <span class="number">29.5px</span>;</span><br><span class="line">    <span class="attribute">white-space</span>: nowrap;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line">  }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>  但在“分类”页面中，某些设备不显示省略号，不知何故。</p>
<p>  （2023-12-7更新）知道是什么原因了。解决方法是微调参数。我将tag和archive页面的min-width改为768px，max-width改为767px，然后把大屏幕下的width改为600px，小屏幕下的width改为240px，问题解决。至于categories页面，我直接把所有屏幕尺寸的宽度调成了240px。</p>
<p>  （2024-5-3更新）发现大屏幕上每一个category的子页面上，宽度仍然是240px，不美观。于是修改category.ejs代码如下：</p>
  <figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-tag">li</span> {</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">24.2px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">white-space</span>: nowrap;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">overflow</span>: hidden;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">text-overflow</span>: ellipsis;</span></span><br><span class="line"><span class="language-css">    }</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">767px</span>) {</span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">li</span> {</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>: <span class="number">240px</span>;</span></span><br><span class="line"><span class="language-css">        }</span></span><br><span class="line"><span class="language-css">    }</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">min-width</span>: <span class="number">768px</span>) {</span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">li</span> {</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>: <span class="number">60vw</span>;</span></span><br><span class="line"><span class="language-css">        }</span></span><br><span class="line"><span class="language-css">    }</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<h2 id="置顶"><a href="#置顶" class="headerlink" title="置顶"></a>置顶</h2><p>教程见上。但我发现教程缺少了一步，就是把主题文件夹下的_config.yml中“归档”按钮的跳转链接改掉：</p>
<figure class="highlight yml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attr">nav:</span></span><br><span class="line">  <span class="string">归档:</span> <span class="string">/top</span> <span class="comment"># 本来是/archive</span></span><br></pre></td></tr></tbody></table></figure>

<p>但是这样一来，归档页面的链接就会变成<span><a target="_blank" rel="noopener" href="https://greendolphindance.com/top/">https://greendolphindance.com/top/</a></span>了，有点不爽。解决方法如下。首先top.js的内容改成：</p>
<figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> pagination = <span class="built_in">require</span>(<span class="string">'hexo-pagination'</span>);</span><br><span class="line">hexo.<span class="property">extend</span>.<span class="property">generator</span>.<span class="title function_">register</span>(<span class="string">'top'</span>, <span class="keyword">function</span> (<span class="params">locals</span>) {</span><br><span class="line">    <span class="keyword">let</span> allPost = locals.<span class="property">posts</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">pagination</span>(<span class="string">'/archives'</span>, allPost, { <span class="comment">//这里改成/archives</span></span><br><span class="line">        <span class="attr">perPage</span>: <span class="variable language_">this</span>.<span class="property">config</span>.<span class="property">top_generator</span>.<span class="property">per_page</span>,</span><br><span class="line">        <span class="attr">layout</span>: [<span class="string">'top'</span>, <span class="string">'archive'</span>, <span class="string">'index'</span>],</span><br><span class="line">        <span class="attr">format</span>: <span class="string">'page'</span> + <span class="string">'/%d/'</span>,</span><br><span class="line">        <span class="attr">data</span>: {</span><br><span class="line">            <span class="attr">__index</span>: <span class="literal">true</span></span><br><span class="line">        }</span><br><span class="line">    });</span><br><span class="line">});</span><br></pre></td></tr></tbody></table></figure>

<p>然后用top.ejs里的内容替换掉archive.ejs里的内容，并在“pagination”位置作如下修改：</p>
<figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">nav</span> <span class="attr">class</span>=<span class="string">"pagination"</span>&gt;</span></span><br><span class="line">    &lt;%- paginator({ prev_next: false, end_size: 1, mid_size: 2, format: 'page/%d/' ,  <span class="comment">&lt;!--这里top改成archives--&gt;</span></span><br><span class="line">    total: Math.ceil(posts.length / perPage) }) %&gt;</span><br><span class="line"><span class="tag">&lt;/<span class="name">nav</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<p>除此之外，由于我限定了桌面端li的宽度为650px，这会导致置顶栏的显示错位，于是修改CSS代码如下：</p>
<figure class="highlight css"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">min-width</span>: <span class="number">769px</span>) {</span><br><span class="line">    <span class="selector-tag">li</span> {</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">650px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">29.5px</span>;</span><br><span class="line">    <span class="attribute">white-space</span>: nowrap;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">/* Mobile styles */</span></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">768px</span>) {</span><br><span class="line">    <span class="selector-tag">li</span> {</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">285px</span>;</span><br><span class="line">    <span class="comment">/* Adjust the width for mobile */</span></span><br><span class="line">    <span class="comment">/* Retain other properties or adjust as needed */</span></span><br><span class="line">    <span class="attribute">height</span>: <span class="number">29.5px</span>;</span><br><span class="line">    <span class="attribute">white-space</span>: nowrap;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.top-item-date</span> {</span><br><span class="line">    <span class="attribute">float</span>: right;</span><br><span class="line">    <span class="attribute">text-align</span>: right;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#a9a9b3</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.top-item</span> {</span><br><span class="line">    <span class="attribute">margin-left</span>: <span class="number">2rem</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">2em</span>;</span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">10px</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="修bug"><a href="#修bug" class="headerlink" title="修bug"></a>修bug</h3><p>设置完毕发现过长博文名省略被我覆盖掉了……于是改了archive.ejs的代码。修改后的完整代码如下：</p>
<figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container top"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"post-wrap tags top"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span> <span class="attr">class</span>=<span class="string">"post-title top"</span>&gt;</span>-<span class="symbol">&amp;nbsp;</span>文章<span class="symbol">&amp;nbsp;</span>-<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- &lt;div class="tag-cloud-tags top"&gt;</span></span><br><span class="line"><span class="comment">              &lt;%site.tags.forEach(item=&gt;{%&gt;</span></span><br><span class="line"><span class="comment">                  &lt;a href="&lt;%-url_for(item.path)%&gt;"&gt;&lt;%- item.name%&gt;&lt;small&gt;(&lt;%-item.length%&gt;)&lt;/small&gt;&lt;/a&gt;</span></span><br><span class="line"><span class="comment">              &lt;%})%&gt;</span></span><br><span class="line"><span class="comment">          &lt;/div&gt; --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 2022年3月29日 添加置顶功能 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"post top"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h3</span>&gt;</span>置顶<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 判断有没有 置顶 这个标签的文章 --&gt;</span></span><br><span class="line">      &lt;%site.tags.forEach(item=&gt;{%&gt;</span><br><span class="line">        &lt;% if(item.name=="置顶" ){ %&gt;</span><br><span class="line">          &lt;% item.posts.each(function (post) { %&gt;</span><br><span class="line">            <span class="comment">&lt;!-- 有的情况判断有没有top数值，按top从大到小排列，当然也可以用时间，目前单独写了个top --&gt;</span></span><br><span class="line">            &lt;% if(post.top){ %&gt;</span><br><span class="line">              <span class="tag">&lt;<span class="name">article</span> <span class="attr">class</span>=<span class="string">"top-item"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"top-item-link"</span> <span class="attr">href</span>=<span class="string">"&lt;%- url_for(post.path) %&gt;"</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">                    &lt;%= post.title %&gt;</span><br><span class="line">                      <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"top-item-date"</span>&gt;</span>&lt;%- date(post.date, theme.date_format) %&gt;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line">              <span class="tag">&lt;/<span class="name">article</span>&gt;</span></span><br><span class="line">              &lt;% ;} %&gt;</span><br><span class="line">                &lt;% }) %&gt;</span><br><span class="line">                  &lt;% ;} %&gt;</span><br><span class="line">                    &lt;% }) %&gt;</span><br><span class="line">                      <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 2022年3月29日 添加置顶功能为上 --&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 2022年3月31日 添加每页文章数如下 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 2022年3月30日 每页条数 --&gt;</span></span><br><span class="line">    &lt;% var perPage=config.top_generator.per_page %&gt;</span><br><span class="line">      &lt;% var currentPage=url.match(/page\/(.*)\//) ? url.match(/page\/(.*)\//)[1] : 1 %&gt;</span><br><span class="line">        &lt;% var last_year='' ; %&gt;</span><br><span class="line">          &lt;% var posts=site.posts %&gt;</span><br><span class="line">            <span class="comment">&lt;!-- 按date逆序排序 --&gt;</span></span><br><span class="line">            &lt;% posts.data=posts.data.sort((a, b)=&gt; b.date - a.date) %&gt;</span><br><span class="line">              &lt;% posts.slice((currentPage - 1) * perPage, currentPage * perPage ).each(function (post) { %&gt;</span><br><span class="line">                &lt;% var cur_year=post.date.year(); %&gt;</span><br><span class="line">                  &lt;% if(last_year !==cur_year){ %&gt;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>&lt;%- cur_year %&gt;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">                    &lt;% last_year=cur_year; } %&gt;</span><br><span class="line">                      <span class="tag">&lt;<span class="name">article</span> <span class="attr">class</span>=<span class="string">"archive-item"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                        <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"archive-item-link"</span> <span class="attr">href</span>=<span class="string">"&lt;%- url_for(post.path) %&gt;"</span>&gt;</span></span><br><span class="line">                          <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"title"</span>&gt;</span></span><br><span class="line">                            &lt;%= post.title %&gt;</span><br><span class="line">                          <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"archive-item-date"</span>&gt;</span>&lt;%- date(post.date, theme.date_format) %&gt;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                      <span class="tag">&lt;/<span class="name">article</span>&gt;</span></span><br><span class="line">                      &lt;% }) %&gt;</span><br><span class="line"></span><br><span class="line">                        &lt;% if(Math.ceil(posts.length / perPage)&gt; 1) { %&gt;</span><br><span class="line">                          <span class="tag">&lt;<span class="name">nav</span> <span class="attr">class</span>=<span class="string">"pagination"</span>&gt;</span></span><br><span class="line">                            &lt;%- paginator({ prev_next: false, end_size: 1, mid_size: 2, format: 'page/%d/' , total:</span><br><span class="line">                              Math.ceil(posts.length / perPage) }) %&gt;</span><br><span class="line">                          <span class="tag">&lt;/<span class="name">nav</span>&gt;</span></span><br><span class="line">                          &lt;% } %&gt;</span><br><span class="line">                            <span class="comment">&lt;!-- 2022年3月31日 添加每页文章数如上 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="keyword">@media</span> (<span class="attribute">min-width</span>: <span class="number">769px</span>) {</span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.title</span> {</span></span><br><span class="line"><span class="language-css">      <span class="attribute">width</span>: <span class="number">650px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">height</span>: <span class="number">29.5px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">white-space</span>: nowrap;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">overflow</span>: hidden;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">text-overflow</span>: ellipsis;</span></span><br><span class="line"><span class="language-css">    }</span></span><br><span class="line"><span class="language-css">  }</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="comment">/* Mobile styles */</span></span></span><br><span class="line"><span class="language-css">  <span class="keyword">@media</span> (<span class="attribute">max-width</span>: <span class="number">768px</span>) {</span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.title</span> {</span></span><br><span class="line"><span class="language-css">      <span class="attribute">width</span>: <span class="number">60vw</span> <span class="meta">!important</span>;</span></span><br><span class="line"><span class="language-css">      <span class="comment">/* Adjust the width for mobile */</span></span></span><br><span class="line"><span class="language-css">      <span class="comment">/* Retain other properties or adjust as needed */</span></span></span><br><span class="line"><span class="language-css">      <span class="attribute">height</span>: <span class="number">29.5px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">white-space</span>: nowrap;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">overflow</span>: hidden;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">text-overflow</span>: ellipsis;</span></span><br><span class="line"><span class="language-css">    }</span></span><br><span class="line"><span class="language-css">  }</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.top-item-date</span> {</span></span><br><span class="line"><span class="language-css">    <span class="attribute">float</span>: right;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">text-align</span>: right;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: <span class="number">#a9a9b3</span>;</span></span><br><span class="line"><span class="language-css">  }</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.top-item</span> {</span></span><br><span class="line"><span class="language-css">    <span class="attribute">margin-left</span>: <span class="number">2rem</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">line-height</span>: <span class="number">2em</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">margin-bottom</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">  }</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>




<h1 id="长链接"><a href="#长链接" class="headerlink" title="长链接"></a>长链接</h1><p>这篇博文里有一些很长的链接。这些链接，尤其在移动端的时候，无法自动断行，导致页面被撑开，很丑。</p>
<p>我首先在post_content.styl里加入如下代码：</p>
<figure class="highlight css"><table><tbody><tr><td class="code"><pre><span class="line"><span class="selector-class">.break-link</span></span><br><span class="line">    <span class="attribute">overflow-wrap</span> break-word</span><br><span class="line">    <span class="attribute">word-break</span> break-<span class="attribute">all</span></span><br></pre></td></tr></tbody></table></figure>

<p>然后将长链接两端分别加上“&lt;a class=”break-link”&gt;”和“&lt;/a&gt;”。有效，但是会导致该链接显示为链接样式（淡蓝色、下划线），而我不希望它如此显示。于是又在post_content.styl里加入：</p>
<figure class="highlight css"><table><tbody><tr><td class="code"><pre><span class="line"><span class="selector-class">.no-style</span></span><br><span class="line">    <span class="attribute">color</span> inherit</span><br><span class="line">    <span class="attribute">text-decoration</span> <span class="attribute">none</span></span><br></pre></td></tr></tbody></table></figure>

<p>再把长链接的class改成“break-link no-style”。问题解决。以后如果想要链接断行，同时让其也显示成链接样式的话，class里不写no-style即可。</p>
<h1 id="文章目录"><a href="#文章目录" class="headerlink" title="文章目录"></a>文章目录</h1><p>参考的是<a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/2065866">这个教程</a>。之前也试过别的教程，失败了。这个能用。配置很简单。但是直接设置，这个目录是无法点击跳转的，需要再加一些话：</p>
<figure class="highlight yaml"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attr">toc:</span></span><br><span class="line">  <span class="attr">maxdepth:</span> <span class="number">3</span></span><br><span class="line">  <span class="attr">class:</span> <span class="string">toc</span></span><br><span class="line">  <span class="attr">slugify:</span> <span class="string">transliteration</span></span><br><span class="line">  <span class="attr">decodeEntities:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">anchor:</span></span><br><span class="line">    <span class="attr">position:</span> <span class="string">before</span></span><br><span class="line">    <span class="attr">symbol:</span> <span class="string">''</span></span><br><span class="line">    <span class="attr">style:</span> <span class="string">header-anchor</span></span><br></pre></td></tr></tbody></table></figure>

<p>这样即可。</p>
<h2 id="进阶-2"><a href="#进阶-2" class="headerlink" title="进阶"></a>进阶</h2><p>觉得目录作为文章的内容不太方便，于是去GitHub上提了issue，希望主题的开发者能够实现相关功能。开发者推荐了<a target="_blank" rel="noopener" href="https://tscanlin.github.io/tocbot">tocbot</a>这个插件。配置过程如下：</p>
<p>在post.ejs里添加了如下代码：</p>
<figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line">&lt;div <span class="keyword">class</span>=<span class="string">"js-toc"</span>&gt;&lt;/div&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"post-content"</span>&gt;</span> <span class="comment">&lt;!-- 这里的class需要根据自身情况修改 --&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="comment">&lt;!-- 博客文章内容将在这里渲染 --&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></tbody></table></figure>
<p>然后在layout.ejs里添加了如下代码：</p>
<figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line">&lt;link rel=<span class="string">"stylesheet"</span> href=<span class="string">"https://cdn.jsdelivr.net/npm/tocbot/dist/tocbot.css"</span> /&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://cdn.jsdelivr.net/npm/tocbot/dist/tocbot.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">'DOMContentLoaded'</span>, <span class="function">(<span class="params">event</span>) =&gt;</span> {</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            tocbot.<span class="title function_">init</span>({</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="attr">tocSelector</span>: <span class="string">'.js-toc'</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="attr">contentSelector</span>: <span class="string">'.post-content'</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="attr">headingSelector</span>: <span class="string">'h1, h2, h3, h4'</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            });</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        });</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></tbody></table></figure>

<p>最后在media.styl里添加了如下代码：</p>
<figure class="highlight css"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">/* post toc Style */</span></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">1279px</span>) // 最大宽度<span class="number">1279px</span>时应用这条规则。（最大宽度小于<span class="number">1279px</span>返回false，屏蔽规则。）</span><br><span class="line">  .post-toc</span><br><span class="line">    display none</span><br><span class="line"></span><br><span class="line">.js-toc {</span><br><span class="line">    <span class="attribute">position</span>: fixed;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">150px</span>; <span class="comment">/* 距离顶部的距离，可以根据需要调整 */</span></span><br><span class="line">    <span class="attribute">right</span>: <span class="number">20px</span>; <span class="comment">/* 距离右侧的距离，可以根据需要调整 */</span></span><br><span class="line">    <span class="attribute">width</span>: <span class="number">150px</span>; <span class="comment">/* 目录的宽度，可以根据需要调整 */</span></span><br><span class="line">    <span class="attribute">overflow-y</span>: visible; <span class="comment">/* 如果目录很长，这将添加滚动条 */</span></span><br><span class="line">    <span class="attribute">max-height</span>: <span class="number">500px</span>; <span class="comment">/* 最大高度，可以根据需要调整 */</span></span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">20px</span>; <span class="comment">/* 内边距，可以根据需要调整 */</span></span><br><span class="line">    <span class="attribute">background-color</span>: transparent; <span class="comment">/* 背景颜色，可以根据需要调整 */</span></span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">1000</span>; <span class="comment">/* 确保目录显示在其他元素之上 */</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 设置目录项为 flex 容器 */</span></span><br><span class="line"><span class="selector-class">.toc-link</span> {</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 调整线条的样式和位置 */</span></span><br><span class="line"><span class="selector-class">.toc-link</span><span class="selector-pseudo">::before</span> {</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">""</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">1em</span>; <span class="comment">/* 你可以根据需要调整这个值 */</span></span><br><span class="line">    <span class="attribute">margin-right</span>: <span class="number">10px</span>; <span class="comment">/* 添加一些右边距 */</span></span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">0.2em</span>; <span class="comment">/* 控制线条距离目录项顶部的距离 */</span></span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">0.2em</span>; <span class="comment">/* 控制线条距离目录项底部的距离 */</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 去掉目录前面的数字 */</span></span><br><span class="line"><span class="selector-class">.toc-list</span> <span class="selector-tag">li</span> {</span><br><span class="line">    <span class="attribute">list-style-type</span>: none; <span class="comment">/* 设置列表样式类型为 none */</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.toc-link</span><span class="selector-pseudo">::before</span> {</span><br><span class="line">    <span class="attribute">display</span>: none <span class="meta">!important</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>至于为什么是media.styl而不是别的，我也不知道，随便选了一个罢了。</p>
<p>这样实现的目录有点丑，不过我尽力了，以后再来修改。</p>
<p>然后还想让目录在手机和平板上不显示，这个简单，在media.styl里添加</p>
<figure class="highlight css"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">/* 当屏幕宽度小于或等于 1280px 时应用这些样式 */</span></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">1280px</span>) {</span><br><span class="line">    <span class="selector-class">.js-toc</span> {</span><br><span class="line">        <span class="attribute">display</span>: none;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>即可。</p>
<p>2023-10-18更新：今天修改了，扒了主题设计者Demo网站上的源代码。修改后的完整代码如下：</p>
<figure class="highlight css"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">/* post toc Style */</span></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">1279px</span>) // 最大宽度<span class="number">1279px</span>时应用这条规则。（最大宽度小于<span class="number">1279px</span>返回false，屏蔽规则。）</span><br><span class="line">  .post-toc</span><br><span class="line">    display none</span><br><span class="line"></span><br><span class="line">.js-toc {</span><br><span class="line">    <span class="attribute">position</span>: fixed;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">95px</span>; <span class="comment">/* 距离顶部的距离，可以根据需要调整 */</span></span><br><span class="line">    <span class="attribute">right</span>: <span class="number">2em</span>; <span class="comment">/* 距离右侧的距离，可以根据需要调整 */</span></span><br><span class="line">    <span class="attribute">width</span>: <span class="number">15rem</span>; <span class="comment">/* 目录的宽度，可以根据需要调整 */</span></span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">0.75rem</span></span><br><span class="line">    overflow-y: visible; <span class="comment">/* 如果目录很长，这将添加滚动条 */</span></span><br><span class="line">    <span class="attribute">max-height</span>: <span class="number">500px</span>; <span class="comment">/* 最大高度，可以根据需要调整 */</span></span><br><span class="line">    <span class="attribute">background-color</span>: transparent; <span class="comment">/* 背景颜色，可以根据需要调整 */</span></span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">1000</span>; <span class="comment">/* 确保目录显示在其他元素之上 */</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.js-toc</span> <span class="selector-class">.tocbot-list</span> {</span><br><span class="line">  <span class="attribute">max-height</span>: <span class="number">450px</span>;</span><br><span class="line">  <span class="attribute">max-width</span>: <span class="number">250px</span>;</span><br><span class="line">  <span class="attribute">overflow</span>: auto;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">padding-right</span>: <span class="number">0.875rem</span>;</span><br><span class="line">}</span><br><span class="line"><span class="selector-class">.js-toc</span> <span class="selector-class">.tocbot-list</span>::-webkit-scrollbar {</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">6px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">6px</span>;</span><br><span class="line">}</span><br><span class="line"><span class="selector-class">.js-toc</span> <span class="selector-class">.tocbot-list</span>::-webkit-scrollbar-thumb {</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">6px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#eee</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">2px</span>;</span><br><span class="line">}</span><br><span class="line"><span class="selector-class">.js-toc</span> <span class="selector-class">.tocbot-list</span> <span class="selector-tag">ul</span> {</span><br><span class="line">  <span class="attribute">list-style</span>: none;</span><br><span class="line">  <span class="attribute">position</span>: inherit;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">}</span><br><span class="line"><span class="selector-class">.js-toc</span> <span class="selector-class">.tocbot-list</span> <span class="selector-tag">ul</span> <span class="selector-tag">li</span> {</span><br><span class="line">  <span class="attribute">margin-left</span>: <span class="number">0.25rem</span>;</span><br><span class="line">}</span><br><span class="line"><span class="selector-class">.js-toc</span> <span class="selector-class">.toc-link</span><span class="selector-pseudo">::before</span> {</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#fff</span>;</span><br><span class="line">}</span><br><span class="line"><span class="selector-class">.js-toc</span> <span class="selector-class">.is-active-link</span><span class="selector-pseudo">::before</span> {</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#2d96bd</span>;</span><br><span class="line">}</span><br><span class="line"><span class="selector-class">.js-toc</span> <span class="selector-class">.tocbot-list-menu</span> {</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">1rem</span> <span class="number">0.75rem</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">0.75rem</span>;</span><br><span class="line">}</span><br><span class="line"><span class="selector-class">.js-toc</span> <span class="selector-class">.tocbot-list-menu</span> <span class="selector-tag">a</span> {</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0.375rem</span> <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#999</span>;</span><br><span class="line">  <span class="attribute">cursor</span>: pointer;</span><br><span class="line">}</span><br><span class="line"><span class="selector-class">.js-toc</span> <span class="selector-class">.tocbot-list-menu</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> {</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#808080</span>;</span><br><span class="line">}</span><br><span class="line"><span class="selector-class">.toc</span>{<span class="attribute">overflow-y</span>:auto}<span class="selector-class">.toc</span>&gt;<span class="selector-class">.toc-list</span>{<span class="attribute">overflow</span>:hidden;<span class="attribute">position</span>:relative}<span class="selector-class">.toc</span>&gt;<span class="selector-class">.toc-list</span> <span class="selector-tag">li</span>{<span class="attribute">list-style</span>:none}<span class="selector-class">.toc-list</span>{<span class="attribute">margin</span>:<span class="number">0</span>;<span class="attribute">padding-left</span>:<span class="number">10px</span>}<span class="selector-tag">a</span><span class="selector-class">.toc-link</span>{<span class="attribute">color</span><span class="selector-pseudo">:current</span>Color;<span class="attribute">height</span>:<span class="number">100%</span>}<span class="selector-class">.is-collapsible</span>{<span class="attribute">max-height</span>:<span class="number">1000px</span>;<span class="attribute">overflow</span>:hidden;<span class="attribute">transition</span>:all <span class="number">300ms</span> ease-in-out}<span class="selector-class">.is-collapsed</span>{<span class="attribute">max-height</span>:<span class="number">0</span>}<span class="selector-class">.is-position-fixed</span>{<span class="attribute">position</span>:fixed <span class="meta">!important</span>;<span class="attribute">top</span>:<span class="number">0</span>}<span class="selector-class">.is-active-link</span>{<span class="attribute">font-weight</span>:<span class="number">700</span>}<span class="selector-class">.toc-link</span><span class="selector-pseudo">::before</span>{<span class="attribute">background-color</span>:<span class="number">#EEE</span>;<span class="attribute">content</span>:<span class="string">' '</span>;<span class="attribute">display</span>:inline-block;<span class="attribute">height</span>:inherit;<span class="attribute">left</span>:<span class="number">0</span>;<span class="attribute">margin-top</span>:-<span class="number">1px</span>;<span class="attribute">position</span>:absolute;<span class="attribute">width</span>:<span class="number">2px</span>}<span class="selector-class">.is-active-link</span><span class="selector-pseudo">::before</span>{<span class="attribute">background-color</span>:<span class="number">#54BC4B</span>}</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 当屏幕宽度小于或等于 1280px 时应用这些样式 */</span></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">1280px</span>) {</span><br><span class="line">    <span class="selector-class">.js-toc</span> {</span><br><span class="line">        <span class="attribute">display</span>: none;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.back-top-large</span> {</span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">@media</span> (<span class="attribute">min-width</span>: <span class="number">1281px</span>) {</span><br><span class="line">    <span class="selector-class">.back-top-small</span> {</span><br><span class="line">        <span class="attribute">display</span>: none;</span><br><span class="line">    }</span><br><span class="line">    <span class="selector-class">.back-top-large</span> {</span><br><span class="line">        <span class="attribute">display</span>: block;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h2 id="移动端目录"><a href="#移动端目录" class="headerlink" title="移动端目录"></a>移动端目录</h2><p>这篇文章越来越长，在移动端阅读感觉很费劲。想着要是把这个目录在移动端也实现就好了。想了一个简单的思路，在移动端右下角放一个目录图标，点击展开目录，再点击图标或点击页面空白部分收起目录。下面是GPT的实现：</p>
<p>首先在post.ejs里添加：</p>
<figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">"tocButton"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">svg</span> <span class="attr">t</span>=<span class="string">"1697879152903"</span> <span class="attr">class</span>=<span class="string">"icon"</span> <span class="attr">viewBox</span>=<span class="string">"0 0 1024 1024"</span> <span class="attr">version</span>=<span class="string">"1.1"</span> <span class="attr">xmlns</span>=<span class="string">"http://www.w3.org/2000/svg"</span> <span class="attr">p-id</span>=<span class="string">"5387"</span> <span class="attr">width</span>=<span class="string">"32"</span> <span class="attr">height</span>=<span class="string">"32"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">path</span> <span class="attr">d</span>=<span class="string">"M 863.113 0 H 160.887 A 161.064 161.064 0 0 0 0 160.887 v 702.225 a 161.064 161.064 0 0 0 160.887 160.887 h 702.225 a 161.064 161.064 0 0 0 160.887 -160.887 V 160.887 a 161.064 161.064 0 0 0 -160.887 -160.887 Z M 242.94 725.908 h -6.06545 a 24.1331 24.1331 0 0 1 0 -48.2662 H 242.94 a 24.1331 24.1331 0 0 1 0 48.2662 Z m 0 -193.58 h -6.06545 a 24.1331 24.1331 0 0 1 0 -48.2662 H 242.94 a 24.1331 24.1331 0 0 1 0 48.2662 Z M 242.94 333.037 h -6.06545 a 24.1331 24.1331 0 0 1 0 -48.2662 H 242.94 a 24.1331 24.1331 0 0 1 0 48.2662 Z m 534.146 392.839 H 416.087 a 24.1331 24.1331 0 0 1 0 -48.2662 h 360.854 a 24.1331 24.1331 0 0 1 0 48.2662 Z m 0 -193.58 H 416.087 a 24.1331 24.1331 0 0 1 0 -48.2662 h 360.854 a 24.1331 24.1331 0 0 1 0 48.2662 Z M 777.086 333.037 H 416.087 a 24.1331 24.1331 0 0 1 0 -48.2662 h 360.854 a 24.1331 24.1331 0 0 1 0 48.2662 Z"</span> <span class="attr">fill</span>=<span class="string">"#8a8a8a"</span> <span class="attr">p-id</span>=<span class="string">"5388"</span>&gt;</span><span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"overlay"</span> <span class="attr">id</span>=<span class="string">"overlay"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">'tocButton'</span>).<span class="title function_">addEventListener</span>(<span class="string">'click'</span>, <span class="keyword">function</span>(<span class="params"></span>) {</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> toc = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">'.js-toc'</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> overlay = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">'overlay'</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (toc.<span class="property">style</span>.<span class="property">display</span> === <span class="string">'none'</span> || toc.<span class="property">style</span>.<span class="property">display</span> === <span class="string">''</span>) {</span></span><br><span class="line"><span class="language-javascript">        toc.<span class="property">style</span>.<span class="property">display</span> = <span class="string">'block'</span>;</span></span><br><span class="line"><span class="language-javascript">        overlay.<span class="property">style</span>.<span class="property">display</span> = <span class="string">'block'</span>;</span></span><br><span class="line"><span class="language-javascript">    } <span class="keyword">else</span> {</span></span><br><span class="line"><span class="language-javascript">        toc.<span class="property">style</span>.<span class="property">display</span> = <span class="string">'none'</span>;</span></span><br><span class="line"><span class="language-javascript">        overlay.<span class="property">style</span>.<span class="property">display</span> = <span class="string">'none'</span>;</span></span><br><span class="line"><span class="language-javascript">    }</span></span><br><span class="line"><span class="language-javascript">});</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">'overlay'</span>).<span class="title function_">addEventListener</span>(<span class="string">'click'</span>, <span class="keyword">function</span>(<span class="params"></span>) {</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">'.js-toc'</span>).<span class="property">style</span>.<span class="property">display</span> = <span class="string">'none'</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">'overlay'</span>).<span class="property">style</span>.<span class="property">display</span> = <span class="string">'none'</span>;</span></span><br><span class="line"><span class="language-javascript">});</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<p>然后在media.styl里设定样式：</p>
<figure class="highlight css"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">min-width</span>: <span class="number">1280px</span>) {</span><br><span class="line">    <span class="selector-class">.js-toc</span> {</span><br><span class="line">        <span class="attribute">position</span>: fixed;</span><br><span class="line">        <span class="attribute">top</span>: <span class="number">140px</span>; <span class="comment">/* 距离顶部的距离，可以根据需要调整 */</span></span><br><span class="line">        <span class="attribute">right</span>: <span class="number">2em</span>; <span class="comment">/* 距离右侧的距离，可以根据需要调整 */</span></span><br><span class="line">        <span class="attribute">width</span>: <span class="number">13rem</span>; <span class="comment">/* 目录的宽度，可以根据需要调整 */</span></span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">0.75rem</span></span><br><span class="line">        overflow-y: auto <span class="meta">!important</span>; <span class="comment">/* 如果目录很长，这将添加滚动条 */</span></span><br><span class="line">        <span class="attribute">max-height</span>: <span class="number">500px</span>; <span class="comment">/* 最大高度，可以根据需要调整 */</span></span><br><span class="line">        <span class="attribute">background-color</span>: transparent; <span class="comment">/* 背景颜色，可以根据需要调整 */</span></span><br><span class="line">        <span class="attribute">z-index</span>: <span class="number">1000</span>; <span class="comment">/* 确保目录显示在其他元素之上 */</span></span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.js-toc</span> <span class="selector-class">.tocbot-list</span> {</span><br><span class="line">    <span class="attribute">max-height</span>: <span class="number">450px</span>;</span><br><span class="line">    <span class="attribute">max-width</span>: <span class="number">250px</span>;</span><br><span class="line">    <span class="attribute">overflow</span>: auto;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">padding-right</span>: <span class="number">0.875rem</span>;</span><br><span class="line">}</span><br><span class="line"><span class="selector-class">.js-toc</span> <span class="selector-class">.tocbot-list</span>::-webkit-scrollbar {</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">6px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">6px</span>;</span><br><span class="line">}</span><br><span class="line"><span class="selector-class">.js-toc</span> <span class="selector-class">.tocbot-list</span>::-webkit-scrollbar-thumb {</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">6px</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#eee</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">2px</span>;</span><br><span class="line">}</span><br><span class="line"><span class="selector-class">.js-toc</span> <span class="selector-class">.tocbot-list</span> <span class="selector-tag">ul</span> {</span><br><span class="line">    <span class="attribute">list-style</span>: none;</span><br><span class="line">    <span class="attribute">position</span>: inherit;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">}</span><br><span class="line"><span class="selector-class">.js-toc</span> <span class="selector-class">.tocbot-list</span> <span class="selector-tag">ul</span> <span class="selector-tag">li</span> {</span><br><span class="line">    <span class="attribute">margin-left</span>: <span class="number">0.25rem</span>;</span><br><span class="line">}</span><br><span class="line"><span class="selector-class">.js-toc</span> <span class="selector-class">.toc-link</span><span class="selector-pseudo">::before</span> {</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#fff</span>;</span><br><span class="line">}</span><br><span class="line"><span class="selector-class">.js-toc</span> <span class="selector-class">.is-active-link</span><span class="selector-pseudo">::before</span> {</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#2d96bd</span>;</span><br><span class="line">}</span><br><span class="line"><span class="selector-class">.js-toc</span> <span class="selector-class">.tocbot-list-menu</span> {</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">1rem</span> <span class="number">0.75rem</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">0.75rem</span>;</span><br><span class="line">}</span><br><span class="line"><span class="selector-class">.js-toc</span> <span class="selector-class">.tocbot-list-menu</span> <span class="selector-tag">a</span> {</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0.375rem</span> <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#999</span>;</span><br><span class="line">    <span class="attribute">cursor</span>: pointer;</span><br><span class="line">}</span><br><span class="line"><span class="selector-class">.js-toc</span> <span class="selector-class">.tocbot-list-menu</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> {</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#808080</span>;</span><br><span class="line">}</span><br><span class="line"><span class="selector-class">.toc</span>{<span class="attribute">overflow-y</span>:auto}<span class="selector-class">.toc</span>&gt;<span class="selector-class">.toc-list</span>{<span class="attribute">overflow</span>:hidden;<span class="attribute">position</span>:relative}<span class="selector-class">.toc</span>&gt;<span class="selector-class">.toc-list</span> <span class="selector-tag">li</span>{<span class="attribute">list-style</span>:none}<span class="selector-class">.toc-list</span>{<span class="attribute">margin</span>:<span class="number">0</span>;<span class="attribute">padding-left</span>:<span class="number">10px</span>}<span class="selector-tag">a</span><span class="selector-class">.toc-link</span>{<span class="attribute">color</span><span class="selector-pseudo">:current</span>Color;<span class="attribute">height</span>:<span class="number">100%</span>}<span class="selector-class">.is-collapsible</span>{<span class="attribute">max-height</span>:<span class="number">1000px</span>;<span class="attribute">overflow</span>:hidden;<span class="attribute">transition</span>:all <span class="number">300ms</span> ease-in-out}<span class="selector-class">.is-collapsed</span>{<span class="attribute">max-height</span>:<span class="number">0</span>}<span class="selector-class">.is-position-fixed</span>{<span class="attribute">position</span>:fixed <span class="meta">!important</span>;<span class="attribute">top</span>:<span class="number">0</span>}<span class="selector-class">.is-active-link</span>{<span class="attribute">font-weight</span>:<span class="number">700</span>}<span class="selector-class">.toc-link</span><span class="selector-pseudo">::before</span>{<span class="attribute">background-color</span>:<span class="number">#EEE</span>;<span class="attribute">content</span>:<span class="string">' '</span>;<span class="attribute">display</span>:inline-block;<span class="attribute">height</span>:inherit;<span class="attribute">left</span>:<span class="number">0</span>;<span class="attribute">margin-top</span>:-<span class="number">1px</span>;<span class="attribute">position</span>:absolute;<span class="attribute">width</span>:<span class="number">2px</span>}<span class="selector-class">.is-active-link</span><span class="selector-pseudo">::before</span>{<span class="attribute">background-color</span>:<span class="number">#54BC4B</span>}</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 去掉目录前面的数字 */</span></span><br><span class="line"><span class="selector-class">.toc-list</span> <span class="selector-tag">li</span> {</span><br><span class="line">    <span class="attribute">list-style-type</span>: none; <span class="comment">/* 设置列表样式类型为 none */</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 当屏幕宽度小于或等于 1279px 时应用这些样式 */</span></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">1279px</span>) {</span><br><span class="line">    <span class="selector-id">#tocButton</span> {</span><br><span class="line">        <span class="attribute">display</span>: block;</span><br><span class="line">        <span class="attribute">position</span>: fixed;</span><br><span class="line">        <span class="attribute">bottom</span>: <span class="number">20px</span>;</span><br><span class="line">        <span class="attribute">right</span>: <span class="number">5vw</span>+<span class="number">1.5px</span>;</span><br><span class="line">        <span class="attribute">z-index</span>: <span class="number">1001</span>; <span class="comment">/* 确保 tocButton 在 js-toc 上面 */</span></span><br><span class="line">        <span class="attribute">width</span>: <span class="number">32px</span>;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">32px</span>;</span><br><span class="line">        <span class="attribute">background-color</span>: transparent;</span><br><span class="line">        <span class="attribute">border</span>: none;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.overlay</span> {</span><br><span class="line">        <span class="attribute">display</span>: none;</span><br><span class="line">        <span class="attribute">position</span>: fixed;</span><br><span class="line">        <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">        <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">        <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.7</span>);</span><br><span class="line">        <span class="attribute">z-index</span>: <span class="number">999</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.js-toc</span> {</span><br><span class="line">        <span class="attribute">position</span>: fixed;</span><br><span class="line">        <span class="attribute">top</span>: <span class="number">50%</span>; <span class="comment">/* 将元素的顶部边缘定位到屏幕的垂直中央 */</span></span><br><span class="line">        <span class="attribute">left</span>: <span class="number">50%</span>; <span class="comment">/* 将元素的左边缘定位到屏幕的水平中央 */</span></span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">50%</span>, -<span class="number">50%</span>); <span class="comment">/* 微调位置，确保元素的中心位于屏幕的中央 */</span></span><br><span class="line">        <span class="attribute">z-index</span>: <span class="number">1000</span>;</span><br><span class="line">        <span class="attribute">background-color</span>: white <span class="meta">!important</span>;</span><br><span class="line">        <span class="attribute">border-radius</span>: <span class="number">5px</span>;</span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">10px</span>;</span><br><span class="line">        <span class="attribute">display</span>: none;</span><br><span class="line">        <span class="attribute">max-width</span>: <span class="number">85vw</span>; <span class="comment">/* 设置最大宽度为视口宽度的 70% */</span></span><br><span class="line">        <span class="attribute">min-width</span>: <span class="number">60vw</span>;</span><br><span class="line">        <span class="attribute">max-height</span>: <span class="number">70vh</span>; <span class="comment">/* 设置最大高度为视口高度的 70% */</span></span><br><span class="line">        <span class="attribute">overflow-y</span>: auto <span class="meta">!important</span>; <span class="comment">/* 如果内容超出最大高度或宽度，添加滚动条 */</span></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="selector-tag">body</span><span class="selector-class">.dark-theme</span> <span class="selector-class">.js-toc</span> {</span><br><span class="line">        <span class="attribute">background-color</span>: <span class="number">#292a2d</span> <span class="meta">!important</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">min-width</span>: <span class="number">1280px</span>) {</span><br><span class="line">    <span class="selector-id">#tocButton</span> {</span><br><span class="line">        <span class="attribute">display</span>: none <span class="meta">!important</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h3 id="目录为空时不显示目录图标"><a href="#目录为空时不显示目录图标" class="headerlink" title="目录为空时不显示目录图标"></a>目录为空时不显示目录图标</h3><p>实现代码如下：</p>
<figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">window</span>.<span class="property">onload</span> = <span class="keyword">function</span>(<span class="params"></span>) {</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> toc = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">'.js-toc'</span>); <span class="comment">// 获取目录元素</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> tocButton = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">'tocButton'</span>); <span class="comment">// 获取目录按钮元素</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (toc) { <span class="comment">// 如果目录元素存在</span></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span> (toc.<span class="property">innerText</span>.<span class="title function_">trim</span>() === <span class="string">''</span>) { <span class="comment">// 如果目录内容为空</span></span></span><br><span class="line"><span class="language-javascript">                tocButton.<span class="property">style</span>.<span class="property">display</span> = <span class="string">'none'</span>; <span class="comment">// 隐藏目录按钮</span></span></span><br><span class="line"><span class="language-javascript">            } <span class="keyword">else</span> {</span></span><br><span class="line"><span class="language-javascript">                tocButton.<span class="property">style</span>.<span class="property">display</span> = <span class="string">'block'</span>; <span class="comment">// 显示目录按钮</span></span></span><br><span class="line"><span class="language-javascript">            }</span></span><br><span class="line"><span class="language-javascript">        } <span class="keyword">else</span> {</span></span><br><span class="line"><span class="language-javascript">            tocButton.<span class="property">style</span>.<span class="property">display</span> = <span class="string">'none'</span>; <span class="comment">// 隐藏目录按钮</span></span></span><br><span class="line"><span class="language-javascript">        }</span></span><br><span class="line"><span class="language-javascript">    };</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<h3 id="在目录打开时禁用页面的滚动"><a href="#在目录打开时禁用页面的滚动" class="headerlink" title="在目录打开时禁用页面的滚动"></a>在目录打开时禁用页面的滚动</h3><p>GPT生成了代码，并建议我合并一些事件监听器以使得代码整洁。以下是合并后的代码：</p>
<figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">'tocButton'</span>).<span class="title function_">addEventListener</span>(<span class="string">'click'</span>, <span class="keyword">function</span>(<span class="params"></span>) {</span><br><span class="line">    <span class="keyword">var</span> toc = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">'.js-toc'</span>);</span><br><span class="line">    <span class="keyword">var</span> overlay = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">'overlay'</span>);</span><br><span class="line">    <span class="keyword">var</span> body = <span class="variable language_">document</span>.<span class="property">body</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (toc.<span class="property">style</span>.<span class="property">display</span> === <span class="string">'none'</span> || toc.<span class="property">style</span>.<span class="property">display</span> === <span class="string">''</span>) {</span><br><span class="line">        toc.<span class="property">style</span>.<span class="property">display</span> = <span class="string">'block'</span>; <span class="comment">// 显示目录</span></span><br><span class="line">        overlay.<span class="property">style</span>.<span class="property">display</span> = <span class="string">'block'</span>; <span class="comment">// 显示遮罩层</span></span><br><span class="line">        body.<span class="property">style</span>.<span class="property">overflow</span> = <span class="string">'hidden'</span>; <span class="comment">// 禁用页面滚动</span></span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">        toc.<span class="property">style</span>.<span class="property">display</span> = <span class="string">'none'</span>; <span class="comment">// 隐藏目录</span></span><br><span class="line">        overlay.<span class="property">style</span>.<span class="property">display</span> = <span class="string">'none'</span>; <span class="comment">// 隐藏遮罩层</span></span><br><span class="line">        body.<span class="property">style</span>.<span class="property">overflow</span> = <span class="string">''</span>; <span class="comment">// 启用页面滚动</span></span><br><span class="line">    }</span><br><span class="line">});</span><br><span class="line"></span><br><span class="line"><span class="comment">// 点击遮罩层时隐藏目录和遮罩层，并启用页面滚动</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">'overlay'</span>).<span class="title function_">addEventListener</span>(<span class="string">'click'</span>, <span class="keyword">function</span>(<span class="params"></span>) {</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">'.js-toc'</span>).<span class="property">style</span>.<span class="property">display</span> = <span class="string">'none'</span>;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">'overlay'</span>).<span class="property">style</span>.<span class="property">display</span> = <span class="string">'none'</span>;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">style</span>.<span class="property">overflow</span> = <span class="string">''</span>; <span class="comment">// 启用页面滚动</span></span><br><span class="line">});</span><br><span class="line"></span><br><span class="line"><span class="comment">// 页面加载时根据目录内容的有无显示或隐藏目录按钮</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">onload</span> = <span class="keyword">function</span>(<span class="params"></span>) {</span><br><span class="line">    <span class="keyword">var</span> toc = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">'.js-toc'</span>);</span><br><span class="line">    <span class="keyword">var</span> tocButton = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">'tocButton'</span>);</span><br><span class="line">    <span class="keyword">if</span> (toc) {</span><br><span class="line">        tocButton.<span class="property">style</span>.<span class="property">display</span> = toc.<span class="property">innerText</span>.<span class="title function_">trim</span>() === <span class="string">''</span> ? <span class="string">'none'</span> : <span class="string">'block'</span>;</span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">        tocButton.<span class="property">style</span>.<span class="property">display</span> = <span class="string">'none'</span>;</span><br><span class="line">    }</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure>

<h3 id="允许垂直滚动"><a href="#允许垂直滚动" class="headerlink" title="允许垂直滚动"></a>允许垂直滚动</h3><p>发现在移动端滑动手指，目录不滚动。解决办法是修改overflow-y的值：</p>
<figure class="highlight css"><table><tbody><tr><td class="code"><pre><span class="line"><span class="attribute">overflow-y</span>: auto <span class="meta">!important</span>;</span><br></pre></td></tr></tbody></table></figure>

<p>这样即可。</p>
<h3 id="垂直滚动的下限（？）"><a href="#垂直滚动的下限（？）" class="headerlink" title="垂直滚动的下限（？）"></a>垂直滚动的下限（？）</h3><p>垂直滚动到底部时，本来理想的情况是目录文字的最后一行滑到底边框的上面一点点，就不能滑动了。但实际上还能滑动，一直滑到整个目录框变成空白（内容全部滑上去了），才不能滑动。 </p>
<p>解决方案是在layout.ejs里添加如下代码（我一开始添加到post.ejs里，结果没有被调用？）：</p>
<figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"> </span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">'.js-toc'</span>).<span class="title function_">addEventListener</span>(<span class="string">'scroll'</span>, <span class="keyword">function</span>(<span class="params">e</span>) {</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> tocList = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">'.toc-list'</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> maxHeight = tocList.<span class="property">scrollHeight</span> - <span class="variable language_">this</span>.<span class="property">clientHeight</span> + <span class="number">20</span>; <span class="comment">// 计算最大可滚动高度</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">scrollTop</span> &gt;= maxHeight) {</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">scrollTop</span> = maxHeight; <span class="comment">// 如果滚动超过最大高度，则设置滚动位置为最大高度</span></span></span><br><span class="line"><span class="language-javascript">        }</span></span><br><span class="line"><span class="language-javascript">    });</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<p>更新：放弃了这个功能，因为这样的话，当目录内容到达最底部不能再滑动时，右边的滑块还在中间，这个我不知道怎么解决。</p>
<p>再更新：突然灵光一闪，我让滑块不显示不就可以了吗？反正感觉很多可以滑动的东西都不会显示滑块啊。说干就干：</p>
<figure class="highlight css"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">/* 针对 Chrome、Edge 和 Safari */</span></span><br><span class="line"><span class="selector-class">.js-toc</span>::-webkit-scrollbar {</span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 针对 IE 和 Edge */</span></span><br><span class="line"><span class="selector-class">.js-toc</span> {</span><br><span class="line">    -ms-<span class="attribute">overflow</span>-style: none;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 针对 Firefox */</span></span><br><span class="line"><span class="selector-class">.js-toc</span> {</span><br><span class="line">    <span class="attribute">scrollbar-width</span>: none;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>搞定。我可真他妈是个天才！</p>
<h3 id="“目录”按钮和“回到顶部”按钮垂直对齐"><a href="#“目录”按钮和“回到顶部”按钮垂直对齐" class="headerlink" title="“目录”按钮和“回到顶部”按钮垂直对齐"></a>“目录”按钮和“回到顶部”按钮垂直对齐</h3><p>这个也折腾了好久。明明两个东西right的数值设置成了一样的，但是总是对不齐。一开始GPT给的方案是弄一个，叫什么，Flexbox？就是把“目录”和“回到顶部”包裹到同一个类里面去，再设定两者的相对位置。但是不知道为什么，调了很久都不行。</p>
<p>然后看网页检查器找线索，发现鼠标放在Element中“totop”这个类时，网页中被标示出来的区域和“目录”按钮的实际位置有错位。而我是把“totop”这个类和“目录”按钮对齐的，所以造成实际显示效果没有对齐。</p>
<p>经查，鼠标放在“totop”下面的SVG链接时，页面上标示的区域和“目录”按钮是重叠的。于是在layout.ejs增加代码如下：</p>
<figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-id">#tocButton</span> svg {</span></span><br><span class="line"><span class="language-css">        <span class="attribute">position</span>: fixed;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">bottom</span>: <span class="number">20px</span>; <span class="comment">/* 调整到你想要的位置 */</span></span></span><br><span class="line"><span class="language-css">        <span class="attribute">right</span>: <span class="number">5vw</span>;</span></span><br><span class="line"><span class="language-css">    }</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-id">#totop</span> {</span></span><br><span class="line"><span class="language-css">        <span class="attribute">position</span>: fixed;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">bottom</span>: <span class="number">20px</span>+<span class="number">2rem</span>; <span class="comment">/* 调整到你想要的位置 */</span></span></span><br><span class="line"><span class="language-css">        <span class="attribute">right</span>: <span class="number">5vw</span>;</span></span><br><span class="line"><span class="language-css">    }</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p>问题解决。我还做了一些小的调整，比如调整某些情况下“回到顶部”按钮的大小。</p>
<p>修改完之后觉得两个按钮距离太近了，就改了#totop中bottom的数值，但是没有反应。经查，这一条规则没有被应用，被应用的是“totop”类中的bottom规则。于是把这一数值由50px改为60px。</p>
<h3 id="桌面端点击目录时疯狂上下抖动！"><a href="#桌面端点击目录时疯狂上下抖动！" class="headerlink" title="桌面端点击目录时疯狂上下抖动！"></a>桌面端点击目录时疯狂上下抖动！</h3><p>如题，死马当活马医地问了一下GPT，结果轻松就解决了！方法如下：</p>
<blockquote>
<p>这个问题可能是由于浏览器尝试在点击目录条目时保持目录的当前滚动位置所导致的。当页面内容滚动以将所选条目对齐到视口顶部时，目录的滚动位置也会相应地调整，从而导致“疯狂上下抖动”的现象。</p>
<p>为了解决这个问题，你可以尝试在点击目录条目时禁用目录的滚动事件监听器，然后在跳转完成后再重新启用。这里是一个可能的解决方案：</p>
<figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="keyword">var</span> tocContainer = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">'.js-toc'</span>);</span><br><span class="line"></span><br><span class="line">    tocContainer.<span class="title function_">addEventListener</span>(<span class="string">'scroll'</span>, handleScroll);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">handleScroll</span>(<span class="params">e</span>) {</span><br><span class="line">        <span class="comment">// 你原来的滚动事件处理代码</span></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 当点击目录条目时</span></span><br><span class="line">    tocContainer.<span class="title function_">addEventListener</span>(<span class="string">'click'</span>, <span class="keyword">function</span>(<span class="params">e</span>) {</span><br><span class="line">        <span class="comment">// 禁用滚动事件监听器</span></span><br><span class="line">        tocContainer.<span class="title function_">removeEventListener</span>(<span class="string">'scroll'</span>, handleScroll);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 在跳转完成后重新启用滚动事件监听器</span></span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>) {</span><br><span class="line">            tocContainer.<span class="title function_">addEventListener</span>(<span class="string">'scroll'</span>, handleScroll);</span><br><span class="line">        }, <span class="number">100</span>); <span class="comment">// 你可以根据需要调整延迟时间</span></span><br><span class="line">    });</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></tbody></table></figure>

<p>在这段代码中，我添加了一个点击事件监听器，当点击目录条目时，它会禁用滚动事件监听器，然后在一个延迟后重新启用。这样可以防止在跳转过程中触发滚动事件，从而避免抖动的问题。</p>
<p>你可以尝试使用这段代码，并根据你的实际情况进行相应的调整。希望这能解决你的问题！</p>
</blockquote>
<p>2023-10-22更新：发现没解决，我是用Chrome看到仿佛解决了，但是Chrome上其实根本就没有这个问题……只有Safari有。上面这段代码需要把原来的滚动事件处理代码放进handleScroll这个函数里，我当时没看直接复制了，所以其实根本没用。然后今天我找了半天找不到这个滚动代码……所以暂时算了吧。</p>
<h3 id="点框外屏幕时隐藏目录"><a href="#点框外屏幕时隐藏目录" class="headerlink" title="点框外屏幕时隐藏目录"></a>点框外屏幕时隐藏目录</h3><p>默认的设定是在目录展开时，只有再次点击目录按钮才会收起目录，但是这样有点反直观。所以我想设置成在目录展开时，点击屏幕除目录框之外的任何地方都可以将目录收起。实现方法如下：</p>
<blockquote>
<p>我明白了，我将详细说明应该如何修改代码：</p>
<h4 id="1-添加新函数-hideToc-："><a href="#1-添加新函数-hideToc-：" class="headerlink" title="1. 添加新函数 hideToc()："></a>1. <strong>添加新函数 <code>hideToc()</code>：</strong></h4><p>   在 <code>&lt;script&gt;</code> 标签内，你可以添加一个新函数 <code>hideToc()</code>。这个函数会隐藏目录和遮罩层，并启用页面滚动。</p>
<h4 id="2-修改-overlay-的-HTML："><a href="#2-修改-overlay-的-HTML：" class="headerlink" title="2. 修改 overlay 的 HTML："></a>2. <strong>修改 <code>overlay</code> 的 HTML：</strong></h4><p>   在 <code>overlay</code> div 的 HTML 中添加一个 <code>onclick</code> 事件，使其在被点击时调用 <code>hideToc()</code> 函数。</p>
<h4 id="3-修改-tocButton-的事件监听器："><a href="#3-修改-tocButton-的事件监听器：" class="headerlink" title="3. 修改 tocButton 的事件监听器："></a>3. <strong>修改 <code>tocButton</code> 的事件监听器：</strong></h4><p>   修改 <code>tocButton</code> 的点击事件监听器，使其在目录显示时调用 <code>hideToc()</code> 函数。</p>
<p>以下是具体的代码修改：</p>
<h4 id="1-在-下面添加-onclick-事件："><a href="#1-在-下面添加-onclick-事件：" class="headerlink" title="1. 在 <div class=&quot;overlay&quot; id=&quot;overlay&quot;></div> 下面添加 onclick 事件："></a>1. 在 <code>&lt;div class="overlay" id="overlay"&gt;&lt;/div&gt;</code> 下面添加 <code>onclick</code> 事件：</h4><figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"overlay"</span> <span class="attr">id</span>=<span class="string">"overlay"</span> <span class="attr">onclick</span>=<span class="string">"hideToc()"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<h4 id="2-在现有-标签内添加新函数-hideToc-："><a href="#2-在现有-标签内添加新函数-hideToc-：" class="headerlink" title="2. 在现有 <script> 标签内添加新函数 hideToc()："></a>2. 在现有 <code>&lt;script&gt;</code> 标签内添加新函数 <code>hideToc()</code>：</h4><figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">hideToc</span>(<span class="params"></span>) {</span><br><span class="line">        <span class="keyword">var</span> toc = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">'.js-toc'</span>);</span><br><span class="line">        <span class="keyword">var</span> overlay = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">'overlay'</span>);</span><br><span class="line">        <span class="keyword">var</span> body = <span class="variable language_">document</span>.<span class="property">body</span>;</span><br><span class="line"></span><br><span class="line">        toc.<span class="property">style</span>.<span class="property">display</span> = <span class="string">'none'</span>; <span class="comment">// 隐藏目录</span></span><br><span class="line">        overlay.<span class="property">style</span>.<span class="property">display</span> = <span class="string">'none'</span>; <span class="comment">// 隐藏遮罩层</span></span><br><span class="line">        body.<span class="property">style</span>.<span class="property">overflow</span> = <span class="string">''</span>; <span class="comment">// 启用页面滚动</span></span><br><span class="line">    }</span><br><span class="line">    <span class="comment">// ... (保留其他代码)</span></span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></tbody></table></figure>

<h4 id="3-修改-tocButton-的事件监听器：-1"><a href="#3-修改-tocButton-的事件监听器：-1" class="headerlink" title="3. 修改 tocButton 的事件监听器："></a>3. 修改 <code>tocButton</code> 的事件监听器：</h4><p>找到以下代码：</p>
<figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">'tocButton'</span>).<span class="title function_">addEventListener</span>(<span class="string">'click'</span>, <span class="keyword">function</span>(<span class="params"></span>) {</span><br><span class="line">    <span class="keyword">var</span> toc = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">'.js-toc'</span>);</span><br><span class="line">    <span class="keyword">var</span> overlay = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">'overlay'</span>);</span><br><span class="line">    <span class="keyword">var</span> body = <span class="variable language_">document</span>.<span class="property">body</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (toc.<span class="property">style</span>.<span class="property">display</span> === <span class="string">'none'</span> || toc.<span class="property">style</span>.<span class="property">display</span> === <span class="string">''</span>) {</span><br><span class="line">        toc.<span class="property">style</span>.<span class="property">display</span> = <span class="string">'block'</span>; <span class="comment">// 显示目录</span></span><br><span class="line">        overlay.<span class="property">style</span>.<span class="property">display</span> = <span class="string">'block'</span>; <span class="comment">// 显示遮罩层</span></span><br><span class="line">        body.<span class="property">style</span>.<span class="property">overflow</span> = <span class="string">'hidden'</span>; <span class="comment">// 禁用页面滚动</span></span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">        toc.<span class="property">style</span>.<span class="property">display</span> = <span class="string">'none'</span>; <span class="comment">// 隐藏目录</span></span><br><span class="line">        overlay.<span class="property">style</span>.<span class="property">display</span> = <span class="string">'none'</span>; <span class="comment">// 隐藏遮罩层</span></span><br><span class="line">        body.<span class="property">style</span>.<span class="property">overflow</span> = <span class="string">''</span>; <span class="comment">// 启用页面滚动</span></span><br><span class="line">    }</span><br><span class="line">});</span><br></pre></td></tr></tbody></table></figure>

<p>并将其修改为：</p>
<figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">'tocButton'</span>).<span class="title function_">addEventListener</span>(<span class="string">'click'</span>, <span class="keyword">function</span>(<span class="params"></span>) {</span><br><span class="line">    <span class="keyword">var</span> toc = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">'.js-toc'</span>);</span><br><span class="line">    <span class="keyword">var</span> overlay = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">'overlay'</span>);</span><br><span class="line">    <span class="keyword">var</span> body = <span class="variable language_">document</span>.<span class="property">body</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (toc.<span class="property">style</span>.<span class="property">display</span> === <span class="string">'none'</span> || toc.<span class="property">style</span>.<span class="property">display</span> === <span class="string">''</span>) {</span><br><span class="line">        toc.<span class="property">style</span>.<span class="property">display</span> = <span class="string">'block'</span>; <span class="comment">// 显示目录</span></span><br><span class="line">        overlay.<span class="property">style</span>.<span class="property">display</span> = <span class="string">'block'</span>; <span class="comment">// 显示遮罩层</span></span><br><span class="line">        body.<span class="property">style</span>.<span class="property">overflow</span> = <span class="string">'hidden'</span>; <span class="comment">// 禁用页面滚动</span></span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">        <span class="title function_">hideToc</span>();</span><br><span class="line">    }</span><br><span class="line">});</span><br></pre></td></tr></tbody></table></figure>

<p>这样，无论是点击目录按钮还是页面的其他部分，目录都应该能够正确显示和隐藏。</p>
</blockquote>
<h3 id="目录各条目的间距"><a href="#目录各条目的间距" class="headerlink" title="目录各条目的间距"></a>目录各条目的间距</h3><p>我希望目录框里，每个条目之间有0.5rem的间距。实现方式：</p>
<figure class="highlight css"><table><tbody><tr><td class="code"><pre><span class="line"><span class="selector-tag">li</span><span class="selector-class">.toc-list-item</span> {</span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">0.5rem</span>; <span class="comment">/* 添加间距 */</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h2 id="代码整理"><a href="#代码整理" class="headerlink" title="代码整理"></a>代码整理</h2><p>其实我也不记得我是怎么整理的了，总之记录一下我确实有整理过这回事……</p>
<p>起因是突然发现在宽度大于等于1280px的页面也会显示目录按钮，也会出现展开的目录。点击按钮会隐藏目录，再点击会显示目录，然后页面就不能滚动了。总之肯定是哪里搞错了，于是开始逐一排查，期间听从GPT的建议整理了大量代码。记得的操作有：</p>
<ol>
<li>把同一个函数写了两遍的内容合并到一起。</li>
<li>调整边界数值。比如我一开始自己也没搞清自己到底是要宽度大于1280还是大于等于1280，所以写得很混乱。后来统一成了min-width为1280（后改成1380）和max-width为1279（后改成1379）。</li>
<li>调整缩进。由于我很多代码是复制来的，有时候原网页上没有缩进或缩进不对，所以这些缺陷全被我继承过来了……</li>
<li>想起来了再补充。</li>
</ol>
<p>整理的过程中，有一次编译后等了很久网站也没有变化，经查，在文件里已改成“1279”的数值，在网页检查器中仍是“1280”，其他修改过的属性也没有变化。我思考了很久……花了很多时间，查了很多资料，使用了很多方法，包括删库重建，均无效果。最后发现我之前用博客文件夹的本地备份替换了原来的文件夹（方式是删除原文件夹，再重命名备份文件夹），而这之后必须在终端里重新cd一下，做的更改才可以成功生效。下次一定记住……</p>
<h1 id="优化宽度"><a href="#优化宽度" class="headerlink" title="优化宽度<300px的手机上的显示"></a>优化宽度&lt;300px的手机上的显示</h1><p>不多说，放代码。代码放在media.styl里。</p>
<figure class="highlight css"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">/* 在封面页减小标题栏、nickname、description、copyright的字体大小 */</span></span><br><span class="line"><span class="keyword">@media</span> (<span class="attribute">max-width</span>: <span class="number">299px</span>) {</span><br><span class="line">    <span class="selector-class">.wrapper</span> <span class="selector-tag">header</span> <span class="selector-class">.navbar-header</span>,</span><br><span class="line">    <span class="selector-class">.wrapper</span> <span class="selector-tag">header</span> <span class="selector-class">.navbar-header</span> <span class="selector-tag">a</span>,</span><br><span class="line">    <span class="selector-class">.menu-toggle</span> {</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">12px</span> <span class="meta">!important</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="selector-class">.wrapper</span> <span class="selector-tag">footer</span> <span class="selector-class">.copyright</span>,</span><br><span class="line">    <span class="selector-class">.wrapper</span> <span class="selector-tag">footer</span> <span class="selector-class">.copyright</span> * {</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">10px</span> <span class="meta">!important</span>;</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    <span class="selector-class">.wrapper</span> <span class="selector-class">.nickname</span> {</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">20px</span> <span class="meta">!important</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="selector-class">.wrapper</span> <span class="selector-class">.description</span> {</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">12px</span> <span class="meta">!important</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 在其他页面减小标题栏、copyright的字体大小 */</span></span><br><span class="line"><span class="keyword">@media</span> (<span class="attribute">max-width</span>: <span class="number">299px</span>) {</span><br><span class="line">    <span class="selector-tag">body</span><span class="selector-pseudo">:not</span>(<span class="selector-class">.wrapper</span>) <span class="selector-class">.navbar-header</span>,</span><br><span class="line">    <span class="selector-tag">body</span><span class="selector-pseudo">:not</span>(<span class="selector-class">.wrapper</span>) <span class="selector-class">.navbar-header</span> * {</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">12px</span> <span class="meta">!important</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="selector-tag">body</span><span class="selector-pseudo">:not</span>(<span class="selector-class">.wrapper</span>) <span class="selector-tag">footer</span> <span class="selector-class">.copyright</span>，</span><br><span class="line">    <span class="selector-tag">body</span><span class="selector-pseudo">:not</span>(<span class="selector-class">.wrapper</span>) <span class="selector-tag">footer</span> <span class="selector-class">.copyright</span> * {</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">10px</span> <span class="meta">!important</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">@media</span> (<span class="attribute">max-width</span>: <span class="number">299px</span>) {</span><br><span class="line">    <span class="selector-class">.menu</span><span class="selector-class">.active</span> <span class="selector-class">.menu-item</span> {</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">12px</span> <span class="meta">!important</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">@media</span> (<span class="attribute">max-width</span>: <span class="number">299px</span>) {</span><br><span class="line">    <span class="selector-class">.post-wrap</span> {</span><br><span class="line">        <span class="attribute">padding-top</span>: <span class="number">2rem</span>;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">80%</span>; <span class="comment">/* 调整内容宽度 */</span></span><br><span class="line">        <span class="attribute">overflow</span>: hidden; <span class="comment">/* 防止内容溢出容器 */</span></span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">@media</span> (<span class="attribute">max-width</span>: <span class="number">299px</span>) {</span><br><span class="line">    <span class="selector-class">.archive-item-link</span> {</span><br><span class="line">        <span class="attribute">display</span>: block; <span class="comment">/* 确保链接作为块级元素显示 */</span></span><br><span class="line">        <span class="attribute">overflow</span>: hidden; <span class="comment">/* 隐藏溢出的文本 */</span></span><br><span class="line">        <span class="attribute">white-space</span>: nowrap; <span class="comment">/* 防止文本换行 */</span></span><br><span class="line">        <span class="attribute">text-overflow</span>: ellipsis; <span class="comment">/* 将溢出的文本显示为省略号 */</span></span><br><span class="line">        <span class="attribute">width</span>: <span class="number">100%</span>; <span class="comment">/* 确保链接元素占据全部可用宽度 */</span></span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">@media</span> (<span class="attribute">max-width</span>: <span class="number">299px</span>) {</span><br><span class="line">    <span class="selector-tag">li</span> {</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">100%</span> <span class="meta">!important</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">@media</span> (<span class="attribute">max-width</span>: <span class="number">299px</span>) {</span><br><span class="line">    <span class="selector-class">.post-wrap</span> <span class="selector-class">.post-title</span> {</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">1.5em</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>总之就是各种调整各种打补丁……</p>
<p>调整前示例：</p>
<img width="300" alt="image" src="https://github.com/greendolphindance/greendolphindance.github.io/assets/87912044/0a4c3782-c9f5-444a-ac1e-66e919f62452">

<p>调整后示例：</p>
<img width="300" alt="image" src="https://github.com/greendolphindance/greendolphindance.github.io/assets/87912044/d5ea8b72-7d94-40e3-91cb-4489ed8889aa">

<p>还是有点丑，不过我尽力了。希望看我博客的没有Galaxy Fold用户……这是什么反人类手机啊。</p>
<h1 id="解决点击“About”和“Links”时页面微妙的横向晃动"><a href="#解决点击“About”和“Links”时页面微妙的横向晃动" class="headerlink" title="解决点击“About”和“Links”时页面微妙的横向晃动"></a>解决点击“About”和“Links”时页面微妙的横向晃动</h1><p>又是一个微小的细节！但是一旦注意到就忍不了！</p>
<p>解决方案很简单，在CSS文件中添加如下代码：</p>
<figure class="highlight css"><table><tbody><tr><td class="code"><pre><span class="line"><span class="comment">/* 固定页面宽度 */</span></span><br><span class="line"><span class="selector-tag">body</span> {</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100vw</span>; <span class="comment">/* 设置页面宽度为视口宽度的百分比 */</span></span><br><span class="line">    <span class="attribute">overflow-x</span>: hidden; <span class="comment">/* 隐藏水平滚动条，防止页面宽度变化 */</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>即可。</p>
<h1 id="页面标题对齐"><a href="#页面标题对齐" class="headerlink" title="页面标题对齐"></a>页面标题对齐</h1><p>今天发现Categories和Tags页面、About和Links页面、文章的标题不在同一高度上。我希望把它们全部调整成和Categories与Tags的标题等高（从网页检查器得知需要设置margin-top为2rem）。</p>
<p>About和Links页面标题的高度在/themes/Chic/source/css/_page/page.styl中调整，将padding-top改为2rem即可。</p>
<p>文章标题的高度在<a class="break-link no-style"> /themes/Chic/source/css/_page/_post/post_header.styl </a>中调整，需要进行两步操作：（1）将post-title的margin-top设置为2rem;(2)将post-header h1下的“margin 0 !important”删除，否则标题高度将不会发生变化。</p>
<p>但是，我没有改Archives页面标题的高度，即便这一页面的标题比其他的标题位置高。因为（1）Archives中的标题“2023”字号比其他页面标题的字号小，那么将前者与页面其他内容排列得更紧凑似乎要美观一些。（2）其实Archives标题的padding-top也是2rem，但是它可能是按这个标题的字号计算的，所以这个2rem的绝对长度比别的页面的2rem要短；然后我懒得计算它们的绝对高度了，所以就算了吧。</p>
<h1 id="浏览器顶栏的标题显示"><a href="#浏览器顶栏的标题显示" class="headerlink" title="浏览器顶栏的标题显示"></a>浏览器顶栏的标题显示</h1><p>所谓的浏览器顶栏，就是这个栏，我也不知道学名应该叫什么：</p>
<img width="220" alt="image" src="https://github.com/greendolphindance/greendolphindance.github.io/assets/87912044/81e0ce29-52d1-40f5-bad9-2806b3716fcc">

<p>在修改之前，顶栏标题中“｜”前面的内容都乱七八糟的，有“归档”、“Categories”、“- 关于我 -”之类的。于是想把它们统一起来。</p>
<p>首先了解到顶栏标题和md文件的title有关，于是把分类和留言板等的title改成了中文，显示正常。但是由于Chic主题默认的分类和标签页面的标题是左右带“-”的，我就把关于和友链页面的title改成了“- 关于我 -”和“- 友情链接 -”，这样顶栏标题也是带“-”的，不统一。</p>
<p>修改方法如下：首先在md文件的FrontMatter中添加一个新的变量，如：</p>
<figure class="highlight markdown"><table><tbody><tr><td class="code"><pre><span class="line">title: "- 关于我 -"</span><br><span class="line">browser<span class="emphasis">_title: "关于"</span></span><br></pre></td></tr></tbody></table></figure>

<p>然后找到负责渲染页面标题的模板文件（我的是/themes/Chic/layout/_partial/head.ejs），修改这段代码：</p>
<figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>&lt;% if (title){ %&gt;&lt;%= title %&gt; | &lt;% } %&gt;&lt;%= config.title %&gt;<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<p>如下：</p>
<figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>&lt;% if (page.browser_title){ %&gt;&lt;%= page.browser_title %&gt; | &lt;% } else if (title){ %&gt;&lt;%= title %&gt; | &lt;% } %&gt;&lt;%= config.title %&gt;<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<p>即可。</p>
<h1 id="分类和标签页面的排序"><a href="#分类和标签页面的排序" class="headerlink" title="分类和标签页面的排序"></a>分类和标签页面的排序</h1><p>（2023-12-11更新）首先说明一下这两个页面的结构。分类主页面如下图所示：</p>
<img width="600" alt="image" src="https://github.com/greendolphindance/greendolphindance.github.io/assets/87912044/d1e06696-a3f6-4fd3-9d47-621a6788d7b9">

<p>其中，“折腾”“随笔”等分类名都可以点开，点开后出现如下界面：</p>
<img width="400" alt="image" src="https://github.com/greendolphindance/greendolphindance.github.io/assets/87912044/989e9276-734c-4624-9045-011ade52edff">

<p>我希望主页面的各个分类、各个分类下的文章名，以及点开某个分类后其下的文章名，都按字母顺序排列。</p>
<p>标签主页面如下图所示：</p>
<img width="600" alt="image" src="https://github.com/greendolphindance/greendolphindance.github.io/assets/87912044/80eda191-3c39-4f8b-b7de-fd474e53abc6">

<p>其中，点开任意标签可以进入类似如下的界面：</p>
<img width="600" alt="image" src="https://github.com/greendolphindance/greendolphindance.github.io/assets/87912044/d5ac9cd6-9c67-4b4a-8feb-9d94f345e51f">

<p>我希望每个标签，以及点开某个标签后其下的文章名，都按字母顺序排列。</p>
<h2 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h2><p>这个事情的本质是让categories页面的每个card-item按照其下h3的文本的字母顺序排列。ChatGPT解决方案的原理是：</p>
<blockquote>
<p>为了让 categories 页面的每个 card-item 按照其下 h3 标签的文本（即分类名称）的字母顺序排列，您需要在循环之前对 site.categories 进行排序。</p>
</blockquote>
<p>给出的代码如下，修改后blog/themes/Chic/layout/category.ejs中的代码如下：</p>
<figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line">&lt;%# single category page %&gt;</span><br><span class="line">&lt;% if(is_category()){ %&gt;</span><br><span class="line">    &lt;%- partial('_page/category', {pagination: config.category, index: true}) %&gt;</span><br><span class="line">&lt;% }else{ %&gt;</span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"post-wrap categories"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">h2</span> <span class="attr">class</span>=<span class="string">"post-title"</span>&gt;</span>-<span class="symbol">&amp;nbsp;</span>分类<span class="symbol">&amp;nbsp;</span>-<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"categories-card"</span>&gt;</span></span><br><span class="line">                &lt;% </span><br><span class="line">                    // Convert categories to an array and sort them alphabetically by name</span><br><span class="line">                    var sortedCategories = site.categories.toArray().sort((a, b) =&gt; a.name.toLowerCase().localeCompare(b.name.toLowerCase()));</span><br><span class="line">                %&gt;</span><br><span class="line">                &lt;% sortedCategories.forEach(category_item =&gt; { %&gt;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"card-item"</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"categories"</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&lt;%- url_for(category_item.path) %&gt;"</span>&gt;</span></span><br><span class="line">                                <span class="tag">&lt;<span class="name">h3</span>&gt;</span></span><br><span class="line">                                    <span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"iconfont icon-category"</span> <span class="attr">style</span>=<span class="string">"padding-right:3px"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span><br><span class="line">                                    &lt;%- category_item.name %&gt;</span><br><span class="line">                                <span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                            &lt;% category_item.posts.forEach((post_item, index = 0) =&gt; { %&gt;</span><br><span class="line">                                &lt;% if(++index &lt;= 5){ %&gt;</span><br><span class="line">                                    <span class="tag">&lt;<span class="name">article</span> <span class="attr">class</span>=<span class="string">"archive-item"</span>&gt;</span></span><br><span class="line">                                        <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"archive-item-link"</span> <span class="attr">href</span>=<span class="string">"&lt;%- url_for(post_item.path) %&gt;"</span>&gt;</span></span><br><span class="line">                                           <span class="tag">&lt;<span class="name">li</span>&gt;</span>&lt;%- post_item.title %&gt;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                                        <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                                    <span class="tag">&lt;/<span class="name">article</span>&gt;</span></span><br><span class="line">                                &lt;% } %&gt;</span><br><span class="line">                            &lt;% }) %&gt;</span><br><span class="line">                            &lt;% if(category_item.posts.length &gt; 5){ %&gt;</span><br><span class="line">                                <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"more-post-link"</span> <span class="attr">href</span>=<span class="string">"&lt;%- url_for(category_item.path) %&gt;"</span>&gt;</span>更多 &gt;&gt;<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                            &lt;% } %&gt;</span><br><span class="line">                        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                &lt;% }) %&gt;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">&lt;% } %&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- Style for handling ellipsis in post titles --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="comment">/* Existing styles for li elements */</span></span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<h2 id="各分类下的文章标题"><a href="#各分类下的文章标题" class="headerlink" title="各分类下的文章标题"></a>各分类下的文章标题</h2><p>这个需要在blog/themes/Chic/layout/_page/category.ejs中进行修改。修改后改文件的代码如下：</p>
<figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line">&lt;%# single category page%&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"post-wrap categories"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h2</span> <span class="attr">class</span>=<span class="string">"post-title"</span>&gt;</span>-<span class="symbol">&amp;nbsp;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"iconfont icon-fenlei"</span> <span class="attr">style</span>=<span class="string">"font-size: 1em;"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span>分类<span class="symbol">&amp;nbsp;</span>·<span class="symbol">&amp;nbsp;</span>&lt;%-page.category%&gt;-<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        &lt;% var posts = site.categories.findOne({name: page.category}).posts %&gt;</span><br><span class="line">        <span class="comment">&lt;!-- 按title字母顺序排序 --&gt;</span></span><br><span class="line">        &lt;% posts.data.sort((a, b) =&gt; a.title.toLowerCase().localeCompare(b.title.toLowerCase())) %&gt;</span><br><span class="line">        &lt;% posts.each(function (post) { %&gt;</span><br><span class="line">            <span class="tag">&lt;<span class="name">article</span> <span class="attr">class</span>=<span class="string">"archive-item"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"archive-item-link"</span> <span class="attr">href</span>=<span class="string">"&lt;%- url_for(post.path) %&gt;"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"category-page-post"</span>&gt;</span></span><br><span class="line">                    &lt;%= post.title %&gt;</span><br><span class="line">                <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">article</span>&gt;</span></span><br><span class="line">        &lt;% }) %&gt;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<h2 id="标签"><a href="#标签" class="headerlink" title="标签"></a>标签</h2><p>类似地，标签本身的顺序在blog/themes/Chic/layout/tag.ejs里改，点开每个标签后列表文章的排列顺序在blog/themes/Chic/layout/_page/tag.ejs里改。修改后，第一个文档里的代码如下：</p>
<figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line">&lt;%#</span><br><span class="line"></span><br><span class="line">this page will judge whether current page is 'tag.'</span><br><span class="line">url:'http://localhost:4000/tag/' return false.</span><br><span class="line">url:'http://localhost:4000/tags/test/' return true.</span><br><span class="line"></span><br><span class="line">if you enter 'tag' page by click link will show all tags.</span><br><span class="line">otherwise if you enter 'tags' by click post header link will show the single tag of this post.</span><br><span class="line"></span><br><span class="line">how to add a tag page:</span><br><span class="line"></span><br><span class="line">    1. hexo new page "tag"</span><br><span class="line">    2. cd source/tag/index.md</span><br><span class="line">    3. add layout pattern like this:</span><br><span class="line">    ---</span><br><span class="line">    title: '''tag'''</span><br><span class="line">    date: 2019-06-09 09:56:49</span><br><span class="line">    layout: tag</span><br><span class="line">    ---</span><br><span class="line"></span><br><span class="line"> %&gt;</span><br><span class="line"> </span><br><span class="line"> &lt;% if(is_tag()){ %&gt;</span><br><span class="line">    &lt;%- partial('_page/tag', {pagination: config.tag, index: true}) %&gt;</span><br><span class="line">&lt;% }else{ %&gt;</span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"post-wrap tags"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">h2</span> <span class="attr">class</span>=<span class="string">"post-title"</span>&gt;</span>-<span class="symbol">&amp;nbsp;</span>标签<span class="symbol">&amp;nbsp;</span>-<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"tag-cloud-tags"</span>&gt;</span></span><br><span class="line">                &lt;% </span><br><span class="line">                    // Convert tags to an array and sort them alphabetically by name</span><br><span class="line">                    var sortedTags = site.tags.toArray().sort((a, b) =&gt; a.name.toLowerCase().localeCompare(b.name.toLowerCase()));</span><br><span class="line">                %&gt;</span><br><span class="line">                &lt;% sortedTags.forEach(function(tag) { %&gt;</span><br><span class="line">                    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&lt;%- url_for(tag.path) %&gt;"</span>&gt;</span>&lt;%- tag.name %&gt;<span class="tag">&lt;<span class="name">small</span>&gt;</span>(&lt;%- tag.length %&gt;)<span class="tag">&lt;/<span class="name">small</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">                &lt;% }); %&gt;</span><br><span class="line">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">&lt;% } %&gt;</span><br></pre></td></tr></tbody></table></figure>

<p>第二个文档里的则如下：</p>
<figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line">&lt;%# single tag page %&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"post-wrap tags"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h2</span> <span class="attr">class</span>=<span class="string">"post-title"</span>&gt;</span>-<span class="symbol">&amp;nbsp;</span><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">"iconfont icon-biaoqian"</span> <span class="attr">style</span>=<span class="string">"font-size: 1em;"</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span>标签<span class="symbol">&amp;nbsp;</span>·<span class="symbol">&amp;nbsp;</span>&lt;%-page.tag%&gt;-<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">        </span><br><span class="line">        &lt;% var posts = site.tags.findOne({name: page.tag}).posts %&gt;</span><br><span class="line">        <span class="comment">&lt;!-- 按title字母顺序排序 --&gt;</span></span><br><span class="line">        &lt;% posts.data.sort((a, b) =&gt; a.title.toLowerCase().localeCompare(b.title.toLowerCase())) %&gt;</span><br><span class="line">        &lt;% posts.each(function (post) { %&gt;</span><br><span class="line">            <span class="tag">&lt;<span class="name">article</span> <span class="attr">class</span>=<span class="string">"archive-item"</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">"archive-item-link"</span> <span class="attr">href</span>=<span class="string">"&lt;%- url_for(post.path) %&gt;"</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"tag-page-post"</span>&gt;</span></span><br><span class="line">                        &lt;%= post.title %&gt;</span><br><span class="line">                    <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">article</span>&gt;</span></span><br><span class="line">        &lt;% }) %&gt;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- Style for handling ellipsis in post titles --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="comment">/* Existing desktop styles */</span></span></span><br><span class="line"><span class="language-css">    <span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">min-width</span>: <span class="number">768px</span>){ </span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">li</span> {</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>: <span class="number">600px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>: <span class="number">29.5px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">white-space</span>: nowrap;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">overflow</span>: hidden;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">text-overflow</span>: ellipsis;</span></span><br><span class="line"><span class="language-css">        }</span></span><br><span class="line"><span class="language-css">    }</span></span><br><span class="line"><span class="language-css">  </span></span><br><span class="line"><span class="language-css">    <span class="comment">/* Mobile styles */</span></span></span><br><span class="line"><span class="language-css">    <span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">767px</span>) {</span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">li</span> {</span></span><br><span class="line"><span class="language-css">            <span class="attribute">width</span>: <span class="number">285px</span>; <span class="comment">/* Adjust the width for mobile */</span></span></span><br><span class="line"><span class="language-css">            <span class="attribute">height</span>: <span class="number">29.5px</span>;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">white-space</span>: nowrap;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">overflow</span>: hidden;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">text-overflow</span>: ellipsis;</span></span><br><span class="line"><span class="language-css">        }</span></span><br><span class="line"><span class="language-css">    }</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<h1 id="本站运行时间"><a href="#本站运行时间" class="headerlink" title="本站运行时间"></a>本站运行时间</h1><p>参考的是<a target="_blank" rel="noopener" href="https://www.fadai.cc/posts/8fda83f9/">这个教程</a>，很简单。</p>
<h1 id="最后更新时间"><a href="#最后更新时间" class="headerlink" title="最后更新时间"></a>最后更新时间</h1><p>部分参考了<a target="_blank" rel="noopener" href="https://blog.vanxnf.top/2018/09/03/Hexo-%E5%8D%9A%E5%AE%A2-Hiker-%E4%B8%BB%E9%A2%98%E5%A2%9E%E5%8A%A0%E6%96%87%E7%AB%A0%E6%9C%80%E5%90%8E%E7%BC%96%E8%BE%91%E6%97%B6%E9%97%B4%EF%BC%8C%E5%B9%B6%E6%8C%89%E7%85%A7%E6%9C%80%E5%90%8E%E7%BC%96%E8%BE%91%E6%97%B6%E9%97%B4%E6%8E%92%E5%BA%8F/">这个教程</a>（虽然ta和我用的主题不一样）。</p>
<p>首先修改blog/scaffolds/post.md。在frontmatter里添加一行：</p>
<figure class="highlight markdown"><table><tbody><tr><td class="code"><pre><span class="line">updated: {{ date }}</span><br></pre></td></tr></tbody></table></figure>

<p>然后每修改一次文章内容，都要手动修改一下updated后面的时间（好麻烦）。</p>
<p>接着修改blog/themes/Chic/layout/_page/post.ejs，增加下面一段：</p>
<figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line">&lt;% if(page.updated){ %&gt;</span><br><span class="line">     <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"updated-time"</span>&gt;</span></span><br><span class="line">        最后更新: <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>&lt;%- date(page.updated, theme.date_format) %&gt;<span class="symbol">&amp;nbsp;</span><span class="symbol">&amp;nbsp;</span>&lt;%- time(page.updated, theme.time_format)%&gt;<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">&lt;% } %&gt;</span><br></pre></td></tr></tbody></table></figure>
<p>即可。</p>
<h1 id="代码复制按钮"><a href="#代码复制按钮" class="headerlink" title="代码复制按钮"></a>代码复制按钮</h1><p>首先去GitHub下载<a target="_blank" rel="noopener" href="https://github.com/zenorocha/clipboard.js/releases">clipboard.js文件</a>。将dist/clipboard.min.js放入博客主题目录下的source/js文件夹中。</p>
<p>然后在post.ejs中插入如下代码：</p>
<figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"/js/clipboard.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">'DOMContentLoaded'</span>, <span class="keyword">function</span> (<span class="params"></span>) {</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> codeBlocks = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">'article pre code'</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        codeBlocks.<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">codeBlock</span>) {</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">var</span> copyButton = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">'button'</span>);</span></span><br><span class="line"><span class="language-javascript">            copyButton.<span class="property">className</span> = <span class="string">'copy-button'</span>;</span></span><br><span class="line"><span class="language-javascript">            copyButton.<span class="property">innerText</span> = <span class="string">'Copy'</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// Check if the code block is in the article content</span></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span> (codeBlock.<span class="title function_">closest</span>(<span class="string">'article'</span>)) {</span></span><br><span class="line"><span class="language-javascript">                codeBlock.<span class="property">parentNode</span>.<span class="property">style</span>.<span class="property">position</span> = <span class="string">'relative'</span>;</span></span><br><span class="line"><span class="language-javascript">                codeBlock.<span class="property">parentNode</span>.<span class="title function_">appendChild</span>(copyButton); <span class="comment">// 将按钮添加到 codeBlock 的父节点内</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">var</span> isCopying = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">                copyButton.<span class="title function_">addEventListener</span>(<span class="string">'click'</span>, <span class="keyword">function</span> (<span class="params"></span>) {</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">if</span> (!isCopying) {</span></span><br><span class="line"><span class="language-javascript">                        <span class="keyword">var</span> codeText = codeBlock.<span class="property">innerText</span>;</span></span><br><span class="line"><span class="language-javascript">                        navigator.<span class="property">clipboard</span>.<span class="title function_">writeText</span>(codeText).<span class="title function_">then</span>(<span class="keyword">function</span> (<span class="params"></span>) {</span></span><br><span class="line"><span class="language-javascript">                            copyButton.<span class="property">innerText</span> = <span class="string">'Copied!'</span>;</span></span><br><span class="line"><span class="language-javascript">                            isCopying = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">                            <span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>) {</span></span><br><span class="line"><span class="language-javascript">                                copyButton.<span class="property">innerText</span> = <span class="string">'Copy'</span>;</span></span><br><span class="line"><span class="language-javascript">                                isCopying = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">                            }, <span class="number">1500</span>);</span></span><br><span class="line"><span class="language-javascript">                        }).<span class="title function_">catch</span>(<span class="keyword">function</span> (<span class="params">err</span>) {</span></span><br><span class="line"><span class="language-javascript">                            <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">'Copy failed'</span>, err);</span></span><br><span class="line"><span class="language-javascript">                        });</span></span><br><span class="line"><span class="language-javascript">                    }</span></span><br><span class="line"><span class="language-javascript">                });</span></span><br><span class="line"><span class="language-javascript">            }</span></span><br><span class="line"><span class="language-javascript">        });</span></span><br><span class="line"><span class="language-javascript">    });</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.copy-button</span> {</span></span><br><span class="line"><span class="language-css">        <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">top</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">right</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">background-color</span>: <span class="number">#2d96bd</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">border</span>: none;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">border-radius</span>: <span class="number">10%</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">padding</span>: <span class="number">5px</span> <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">cursor</span>: pointer;</span></span><br><span class="line"><span class="language-css">    }</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
                            </div>

                            
                                <section class="post-copyright">
                                    
                                            
                                                    
                                                            

                                </section>
                                
                                    <section class="post-tags">
                                        <div>
                                            <span>标签：</span>
                                            <span class="tag">
                                                
                                                    
                                                        <a href="/tags/%E5%8D%9A%E5%AE%A2/"># 博客</a>
                                                        
                                                        <a href="/tags/%E7%BD%AE%E9%A1%B6/"># 置顶</a>
                                                        
                                                            
                                            </span>
                                        </div>
                                        <div>
                                            <a href="javascript:window.history.back();">返回</a>
                                            <span>· </span>
                                            <a href="/">主页</a>
                                        </div>
                                    </section>
                                    <section class="post-nav">
                                        
                                            <a class="prev" rel="prev" href="/2023/10/08/%E6%9C%80%E8%BF%91%E4%B8%8B%E8%BD%BD%E7%9A%84%E5%B0%8F%E7%8E%A9%E6%84%8F/">最近下载的小玩意</a>
                                            
                                                
                                                    <a class="next" rel="next" href="/2023/10/06/%E5%A1%94%E7%BD%97%E7%89%8C%E4%B8%BA%E4%BB%80%E4%B9%88%E4%B8%8D%E4%BC%9A%E5%87%BA%E9%94%99/">塔罗牌为什么不会出错</a>
                                                    
                                    </section>

                                    <section style="margin-top: 100px" class="row">
                                        <div class="widget">
    
        
            <div class="recommended_posts">
                <h3>
                    可能相关的文章<span class="driven-by">（由 <a
                            target="_blank" rel="noopener" href="https://github.com/huiwang/hexo-recommended-posts">跨博客文章推荐插件</a> 驱动）</span>
                </h3>
                <ul>
                    
                        <li><a href="https://greendolphindance.github.io/2024/02/16/%E5%88%B6%E4%BD%9Chexo%E6%97%B6%E9%97%B4%E8%BD%B4/">
                                制作hexo时间轴
                            </a></li>
                        
                        <li><a href="https://greendolphindance.github.io/2024/01/26/%E5%88%B6%E4%BD%9Chexo%E6%A0%87%E7%AD%BE%E5%A2%99%EF%BC%882%EF%BC%89/">
                                制作hexo标签墙（2）
                            </a></li>
                        
                        <li><a target="_blank" rel="noopener" href="https://blog.xlab.app/p/56b1cfe7/">
                                Hexo使用模板
                            </a></li>
                        
                </ul>
            </div>
            
</div>
                                    </section>


                                    <script>
                                        document.addEventListener('DOMContentLoaded', function () {
                                            function getGiscusTheme() {
                                                const theme = document.body.classList.contains('dark-theme') ? 'dark' : 'light';
                                                return theme === 'dark' ? 'noborder_dark' : 'noborder_light';
                                            }

                                            function setGiscusTheme() {
                                                function sendMessage(message) {
                                                    const iframe = document.querySelector('iframe.giscus-frame');
                                                    if (!iframe) return;
                                                    iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
                                                }
                                                sendMessage({
                                                    setConfig: {
                                                        theme: getGiscusTheme(),
                                                    },
                                                });
                                            }

                                            function handleToggle() {
                                                location.reload();
                                            }

                                            // Update giscus theme when theme switcher is clicked
                                            const toggleDesktop = document.querySelector('label[for="switch_default"]');
                                            const toggleMobile = document.querySelector('#mobile-toggle-theme');

                                            if (toggleDesktop) {
                                                toggleDesktop.addEventListener('click', function () {
                                                    setGiscusTheme();
                                                });
                                            }

                                            if (toggleMobile) {
                                                toggleMobile.addEventListener('click', function () {
                                                    setGiscusTheme();
                                                });
                                            }

                                            // Wait for 1000ms (1 second) before loading the Giscus comments to ensure theme is set
                                            setTimeout(() => {
                                                const giscusAttributes = {
                                                    "src": "https://giscus.app/client.js",
                                                    "data-repo": "greendolphindance/greendolphindance.github.io",
                                                    "data-repo-id": "R_kgDOKc-MwA",
                                                    "data-category": "General",
                                                    "data-category-id": "DIC_kwDOKc-MwM4CZ8oe",
                                                    "data-mapping": "url",
                                                    "data-strict": "0",
                                                    "data-reactions-enabled": "1",
                                                    "data-emit-metadata": "0",
                                                    "data-input-position": "top",
                                                    "data-theme": getGiscusTheme(),
                                                    "data-lang": "zh-CN",
                                                    "crossorigin": "anonymous",
                                                };

                                                // Dynamically create script tag
                                                const giscusScript = document.createElement("script");
                                                Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value));

                                                // Append the script tag to the <article> element
                                                document.querySelector('article').appendChild(giscusScript);
                                            }, 1000);
                                        });

                                    </script>

                                    <button id="tocButton" style="display: none;">
                                        <svg t="1697879152903" class="icon" viewBox="0 0 1024 1024" version="1.1"
                                            xmlns="http://www.w3.org/2000/svg" p-id="5387" width="32" height="32">
                                            <path
                                                d="M 863.113 0 H 160.887 A 161.064 161.064 0 0 0 0 160.887 v 702.225 a 161.064 161.064 0 0 0 160.887 160.887 h 702.225 a 161.064 161.064 0 0 0 160.887 -160.887 V 160.887 a 161.064 161.064 0 0 0 -160.887 -160.887 Z M 242.94 725.908 h -6.06545 a 24.1331 24.1331 0 0 1 0 -48.2662 H 242.94 a 24.1331 24.1331 0 0 1 0 48.2662 Z m 0 -193.58 h -6.06545 a 24.1331 24.1331 0 0 1 0 -48.2662 H 242.94 a 24.1331 24.1331 0 0 1 0 48.2662 Z M 242.94 333.037 h -6.06545 a 24.1331 24.1331 0 0 1 0 -48.2662 H 242.94 a 24.1331 24.1331 0 0 1 0 48.2662 Z m 534.146 392.839 H 416.087 a 24.1331 24.1331 0 0 1 0 -48.2662 h 360.854 a 24.1331 24.1331 0 0 1 0 48.2662 Z m 0 -193.58 H 416.087 a 24.1331 24.1331 0 0 1 0 -48.2662 h 360.854 a 24.1331 24.1331 0 0 1 0 48.2662 Z M 777.086 333.037 H 416.087 a 24.1331 24.1331 0 0 1 0 -48.2662 h 360.854 a 24.1331 24.1331 0 0 1 0 48.2662 Z"
                                                fill="#8a8a8a" p-id="5388"></path>
                                    </button>

                                    <div class="overlay" id="overlay" onclick="hideToc()"></div>

                                    <script>
                                        function hideToc() {
                                            var toc = document.querySelector('.js-toc');
                                            var overlay = document.getElementById('overlay');
                                            var body = document.body;

                                            toc.style.display = 'none'; // 隐藏目录
                                            overlay.style.display = 'none'; // 隐藏遮罩层
                                            body.style.overflow = ''; // 启用页面滚动
                                        }
                                        window.onload = function () {

                                            var toc = document.querySelector('.js-toc');
                                            var tocButton = document.getElementById('tocButton');
                                            if (toc) {
                                                // 根据 toc 内容的有无显示或隐藏目录按钮
                                                tocButton.style.display = toc.innerText.trim() === '' ? 'none' : 'block';
                                            } else {
                                                tocButton.style.display = 'none';
                                            }
                                        };

                                        function checkWindowSize() {
                                            var windowWidth = window.innerWidth;
                                            var toc = document.querySelector('.js-toc');
                                            var tocButton = document.getElementById('tocButton');

                                            if (windowWidth > 1379 || toc.innerText.trim() === '') {
                                                tocButton.style.display = 'none';
                                            } else {
                                                tocButton.style.display = 'block';
                                            }
                                        }


                                        // 点击tocButton时执行的函数
                                        document.getElementById('tocButton').addEventListener('click', function () {
                                            var toc = document.querySelector('.js-toc');
                                            var overlay = document.getElementById('overlay');
                                            var body = document.body;

                                            if (toc.style.display === 'none' || toc.style.display === '') {
                                                toc.style.display = 'block'; // 显示目录
                                                overlay.style.display = 'block'; // 显示遮罩层
                                                body.style.overflow = 'hidden'; // 禁用页面滚动
                                            } else {
                                                hideToc();
                                            }
                                        });


                                        // 窗口大小变化时检查窗口宽度
                                        window.onresize = checkWindowSize;
                                    </script>

                        </article>

</div>

<style>
    .dark-theme .post-content code {
        background: none !important;
    }
</style>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        var codeBlocks = document.querySelectorAll('article pre');

        codeBlocks.forEach(function (codeBlock) {
            var copyButton = document.createElement('button');
            copyButton.className = 'copy-button';
            copyButton.innerText = 'Copy';

            // Check if the code block is in the article content
            if (codeBlock.closest('article')) {
                codeBlock.parentNode.parentNode.style.position = 'relative'; // Update this line to select parent of span (pre)
                codeBlock.parentNode.parentNode.appendChild(copyButton); // Update this line to select parent of span (pre) 

                var isCopying = false;

                copyButton.addEventListener('click', function () {
                    if (!isCopying) {
                        var codeText = codeBlock.innerText;
                        navigator.clipboard.writeText(codeText).then(function () {
                            copyButton.innerText = 'Copied!';
                            isCopying = true;
                            setTimeout(function () {
                                copyButton.innerText = 'Copy';
                                isCopying = false;
                            }, 1500);
                        }).catch(function (err) {
                            console.error('Copy failed', err);
                        });
                    }
                });
            }
        });
    });
</script>

<style>
    .copy-button {
        position: absolute;
        top: 0;
        right: 0;
        background-color: #2d96bd;
        color: #fff;
        border: none;
        border-radius: 10%;
        padding: 5px 10px;
        cursor: pointer;
    }

    button,
    input,
    optgroup,
    select,
    textarea {
        font-size: 75%;
    }
</style>

    <div class="js-toc"></div>
    <div class="post-content"> <!-- 这里的class需要根据自身情况修改 -->
        <!-- 博客文章内容将在这里渲染 -->
    </div>
    <!-- recommended posts -->
            </div>
            <footer id="footer" class="footer">
    <div class="copyright">
        <!-- <img style="height:16px!important; margin-left:1px;vertical-align: middle; position: relative; top: -1px;" src="https://mirrors.creativecommons.org/presskit/icons/cc.svg?ref=chooser-v1">
                <img style="height:16px!important;margin-left:1px;vertical-align: middle; position: relative; top: -1px;" src="https://mirrors.creativecommons.org/presskit/icons/by.svg?ref=chooser-v1">
                <img style="height:16px!important;margin-left:1px;vertical-align: middle; position: relative; top: -1px;" src="https://mirrors.creativecommons.org/presskit/icons/nc.svg?ref=chooser-v1"> -->
        <a target="_blank" rel="noopener" href="http://creativecommons.org/licenses/by-nc/4.0/?ref=chooser-v1">
            <svg xmlns="http://www.w3.org/2000/svg"
                style="height:12px; width:12px; margin-left:0.5px;vertical-align: middle; position: relative; top: -0.5px;"
                class="cc-logo" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.0" id="Layer_1" x="0px" y="0px"
                width="64px" height="64px" viewBox="5.5 -3.5 64 64" enable-background="new 5.5 -3.5 64 64"
                xml:space="preserve">
                <g>
                    <circle fill="none" cx="37.785" cy="28.501" r="28.836" />
                    <path
                        d="M37.441-3.5c8.951,0,16.572,3.125,22.857,9.372c3.008,3.009,5.295,6.448,6.857,10.314   c1.561,3.867,2.344,7.971,2.344,12.314c0,4.381-0.773,8.486-2.314,12.313c-1.543,3.828-3.82,7.21-6.828,10.143   c-3.123,3.085-6.666,5.448-10.629,7.086c-3.961,1.638-8.057,2.457-12.285,2.457s-8.276-0.808-12.143-2.429   c-3.866-1.618-7.333-3.961-10.4-7.027c-3.067-3.066-5.4-6.524-7-10.372S5.5,32.767,5.5,28.5c0-4.229,0.809-8.295,2.428-12.2   c1.619-3.905,3.972-7.4,7.057-10.486C21.08-0.394,28.565-3.5,37.441-3.5z M37.557,2.272c-7.314,0-13.467,2.553-18.458,7.657   c-2.515,2.553-4.448,5.419-5.8,8.6c-1.354,3.181-2.029,6.505-2.029,9.972c0,3.429,0.675,6.734,2.029,9.913   c1.353,3.183,3.285,6.021,5.8,8.516c2.514,2.496,5.351,4.399,8.515,5.715c3.161,1.314,6.476,1.971,9.943,1.971   c3.428,0,6.75-0.665,9.973-1.999c3.219-1.335,6.121-3.257,8.713-5.771c4.99-4.876,7.484-10.99,7.484-18.344   c0-3.543-0.648-6.895-1.943-10.057c-1.293-3.162-3.18-5.98-5.654-8.458C50.984,4.844,44.795,2.272,37.557,2.272z M37.156,23.187   l-4.287,2.229c-0.458-0.951-1.019-1.619-1.685-2c-0.667-0.38-1.286-0.571-1.858-0.571c-2.856,0-4.286,1.885-4.286,5.657   c0,1.714,0.362,3.084,1.085,4.113c0.724,1.029,1.791,1.544,3.201,1.544c1.867,0,3.181-0.915,3.944-2.743l3.942,2   c-0.838,1.563-2,2.791-3.486,3.686c-1.484,0.896-3.123,1.343-4.914,1.343c-2.857,0-5.163-0.875-6.915-2.629   c-1.752-1.752-2.628-4.19-2.628-7.313c0-3.048,0.886-5.466,2.657-7.257c1.771-1.79,4.009-2.686,6.715-2.686   C32.604,18.558,35.441,20.101,37.156,23.187z M55.613,23.187l-4.229,2.229c-0.457-0.951-1.02-1.619-1.686-2   c-0.668-0.38-1.307-0.571-1.914-0.571c-2.857,0-4.287,1.885-4.287,5.657c0,1.714,0.363,3.084,1.086,4.113   c0.723,1.029,1.789,1.544,3.201,1.544c1.865,0,3.18-0.915,3.941-2.743l4,2c-0.875,1.563-2.057,2.791-3.541,3.686   c-1.486,0.896-3.105,1.343-4.857,1.343c-2.896,0-5.209-0.875-6.941-2.629c-1.736-1.752-2.602-4.19-2.602-7.313   c0-3.048,0.885-5.466,2.658-7.257c1.77-1.79,4.008-2.686,6.713-2.686C51.117,18.558,53.938,20.101,55.613,23.187z" />
                </g>
            </svg>
            <svg xmlns="http://www.w3.org/2000/svg"
                style="height:12px; width:12px; margin-left:0.5px;vertical-align: middle; position: relative; top: -0.5px;"
                class="att-logo" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.0" id="Layer_1" x="0px" y="0px"
                width="64px" height="64px" viewBox="5.5 -3.5 64 64" enable-background="new 5.5 -3.5 64 64"
                xml:space="preserve">
                <g>
                    <circle fill="none" cx="37.637" cy="28.806" r="28.276" />
                    <g>
                        <path
                            d="M37.443-3.5c8.988,0,16.57,3.085,22.742,9.257C66.393,11.967,69.5,19.548,69.5,28.5c0,8.991-3.049,16.476-9.145,22.456    C53.879,57.319,46.242,60.5,37.443,60.5c-8.649,0-16.153-3.144-22.514-9.43C8.644,44.784,5.5,37.262,5.5,28.5    c0-8.761,3.144-16.342,9.429-22.742C21.101-0.415,28.604-3.5,37.443-3.5z M37.557,2.272c-7.276,0-13.428,2.553-18.457,7.657    c-5.22,5.334-7.829,11.525-7.829,18.572c0,7.086,2.59,13.22,7.77,18.398c5.181,5.182,11.352,7.771,18.514,7.771    c7.123,0,13.334-2.607,18.629-7.828c5.029-4.838,7.543-10.952,7.543-18.343c0-7.276-2.553-13.465-7.656-18.571    C50.967,4.824,44.795,2.272,37.557,2.272z M46.129,20.557v13.085h-3.656v15.542h-9.944V33.643h-3.656V20.557    c0-0.572,0.2-1.057,0.599-1.457c0.401-0.399,0.887-0.6,1.457-0.6h13.144c0.533,0,1.01,0.2,1.428,0.6    C45.918,19.5,46.129,19.986,46.129,20.557z M33.042,12.329c0-3.008,1.485-4.514,4.458-4.514s4.457,1.504,4.457,4.514    c0,2.971-1.486,4.457-4.457,4.457S33.042,15.3,33.042,12.329z" />
                    </g>
                </g>
            </svg>
            <svg xmlns="http://www.w3.org/2000/svg"
                style="height:12px; width:12px; margin-left:0.5px;vertical-align: middle; position: relative; top: -0.5px;"
                class="non-logo" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.0" id="Layer_1" x="0px" y="0px"
                width="64px" height="64px" viewBox="5.5 -3.5 64 64" enable-background="new 5.5 -3.5 64 64"
                xml:space="preserve">
                <g>
                    <circle fill="none" cx="37.47" cy="28.736" r="29.471" />
                    <g>
                        <path
                            d="M37.442-3.5c8.99,0,16.571,3.085,22.743,9.256C66.393,11.928,69.5,19.509,69.5,28.5c0,8.992-3.048,16.476-9.145,22.458    C53.88,57.32,46.241,60.5,37.442,60.5c-8.686,0-16.19-3.162-22.513-9.485C8.644,44.728,5.5,37.225,5.5,28.5    c0-8.762,3.144-16.343,9.429-22.743C21.1-0.414,28.604-3.5,37.442-3.5z M12.7,19.872c-0.952,2.628-1.429,5.505-1.429,8.629    c0,7.086,2.59,13.22,7.77,18.4c5.219,5.144,11.391,7.715,18.514,7.715c7.201,0,13.409-2.608,18.63-7.829    c1.867-1.79,3.332-3.657,4.398-5.602l-12.056-5.371c-0.421,2.02-1.439,3.667-3.057,4.942c-1.622,1.276-3.535,2.011-5.744,2.2    v4.915h-3.714v-4.915c-3.543-0.036-6.782-1.312-9.714-3.827l4.4-4.457c2.094,1.942,4.476,2.913,7.143,2.913    c1.104,0,2.048-0.246,2.83-0.743c0.78-0.494,1.172-1.312,1.172-2.457c0-0.801-0.287-1.448-0.858-1.943l-3.085-1.315l-3.771-1.715    l-5.086-2.229L12.7,19.872z M37.557,2.214c-7.276,0-13.428,2.571-18.457,7.714c-1.258,1.258-2.439,2.686-3.543,4.287L27.786,19.7    c0.533-1.676,1.542-3.019,3.029-4.028c1.484-1.009,3.218-1.571,5.2-1.686V9.071h3.715v4.915c2.934,0.153,5.6,1.143,8,2.971    l-4.172,4.286c-1.793-1.257-3.619-1.885-5.486-1.885c-0.991,0-1.876,0.191-2.656,0.571c-0.781,0.381-1.172,1.029-1.172,1.943    c0,0.267,0.095,0.533,0.285,0.8l4.057,1.83l2.8,1.257l5.144,2.285l16.397,7.314c0.535-2.248,0.801-4.533,0.801-6.857    c0-7.353-2.552-13.543-7.656-18.573C51.005,4.785,44.831,2.214,37.557,2.214z" />
                    </g>
                </g>
            </svg>
        </a>
        由 <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic"
            target="_blank">Chic</a> <span id="qudong">驱动</span>
        </span>
        <br>
        <!-- Add the SVG logo wrapped in a link -->
        <a href="https://www.travellings.cn/go.html" target="_blank" style="display:inline-block;">
            <svg xmlns="http://www.w3.org/2000/svg" class="kaiwang" height="16" width="14" viewBox="0 0 448 512"
                style="height:12px; width:12px; ;vertical-align: middle; position: relative; top: -0.5px;">
                <!-- SVG Path -->
                <path
                    d="M96 0C43 0 0 43 0 96V352c0 48 35.2 87.7 81.1 94.9l-46 46C28.1 499.9 33.1 512 43 512H82.7c8.5 0 16.6-3.4 22.6-9.4L160 448H288l54.6 54.6c6 6 14.1 9.4 22.6 9.4H405c10 0 15-12.1 7.9-19.1l-46-46c46-7.1 81.1-46.9 81.1-94.9V96c0-53-43-96-96-96H96zM64 128c0-17.7 14.3-32 32-32h80c17.7 0 32 14.3 32 32v96c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V128zM272 96h80c17.7 0 32 14.3 32 32v96c0 17.7-14.3 32-32 32H272c-17.7 0-32-14.3-32-32V128c0-17.7 14.3-32 32-32zM64 352a32 32 0 1 1 64 0 32 32 0 1 1 -64 0zm288-32a32 32 0 1 1 0 64 32 32 0 1 1 0-64z" />
            </svg>
        </a>
        <a href="https://icp.gov.moe/?keyword=20230468" target="_blank"><span id="moe-text">萌ICP备20230468号</span></a>
        <a href="https://travel.moe/go.html" title="异次元之旅-跃迁-我们一起去萌站成员的星球旅行吧！" style=" display:inline-block;"
            target=" _blank">
            <svg t="1702427100869" class="moe-icon" viewBox="0 0 1024 1024" version="1.1"
                xmlns="http://www.w3.org/2000/svg" p-id="1841"
                style="height:14px; width:14px; vertical-align: middle; position: relative; top: -1px;">
                <path d="M598.1 392.7m-56.8 0a56.8 56.8 0 1 0 113.6 0 56.8 56.8 0 1 0-113.6 0Z" p-id="1842"></path>
                <path d="M434.6 392.7m-33.8 0a33.8 33.8 0 1 0 67.6 0 33.8 33.8 0 1 0-67.6 0Z" p-id="1843"></path>
                <path
                    d="M236.6 828.1c-68.7 0-123.9-20.2-152.4-67.5-37.3-62-14.6-148.9 63.9-244.8 4.6-5.4 19.2-21.7 37-30 22.4-10.5 49-0.8 59.5 21.6 10.4 22.4 0.8 49-21.6 59.5-0.7 0.6-4.7 4.6-6 6.2-59.9 73.2-67.7 122-56 141.3 28.6 47.6 208 33.8 423.7-96.2 99.8-60.2 184-131.7 237-201.2 41.8-54.9 59.9-105.4 45.9-128.6-12.7-21.1-57.8-29.5-117.6-22-12.1 1.5-25 3.7-38.1 6.5-24.3 5.1-47.9-10.4-53-34.6-5.1-24.2 10.4-47.9 34.6-53 15.6-3.3 30.8-5.8 45.4-7.7 127.9-16.1 182.3 26.3 205.4 64.7 35.1 58.2 16.8 139.6-51.4 229-59.7 78.3-152.8 157.6-262.1 223.5-129.9 78.3-280.7 133.3-394.2 133.3z"
                    p-id="1844"></path>
                <path
                    d="M529.8 874.7c-200.4 0-363.5-163.1-363.5-363.5s163.1-363.5 363.5-363.5 363.5 163.1 363.5 363.5-163 363.5-363.5 363.5z m0-637.5c-151.1 0-274 122.9-274 274s122.9 274 274 274 274-122.9 274-274-122.9-274-274-274z"
                    p-id="1845"></path>
            </svg></a>
        <br>
        <i class="ri-time-line"></i>
        <span id="runtime_span"></span>
        <script type="text/javascript">
            function show_runtime() {
                window.setTimeout("show_runtime()", 1000);
                X = new Date("10/06/2023 12:34:50");
                Y = new Date();
                T = (Y.getTime() - X.getTime());
                M = 24 * 60 * 60 * 1000;
                a = T / M;
                A = Math.floor(a);
                b = (a - A) * 24;
                B = Math.floor(b);
                c = (b - B) * 60;
                C = Math.floor((b - B) * 60);
                D = Math.floor((c - C) * 60);
                runtime_span.innerHTML = "已运行 " + A + "天" + B + "小时" + C + "分" + D + "秒"
            }
            show_runtime();
        </script>
        <span class="post-count">
            96.8k
        </span>
        <span>
            <!-- Existing Creative Commons images and links -->
            <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span
                id="busuanzi_value_site_uv"></span>
            <a href="http://creativecommons.org/licenses/by-nc/4.0/?ref=chooser-v1" target="_blank"
                rel="license noopener noreferrer" style="display:inline-block;">
    </div>

    <style>
        @media screen and (max-width: 767px) {
            .footer {
                margin-bottom: 1.5rem;
                /* 将页脚上移1rem */
            }
        }

        .dark-theme .kaiwang {
            fill: #a9a9b2;
        }

        /* Default color (black) for day mode for moe-icon */
        .moe-icon {
            fill: black;
        }

        /* Color (#A9A9B2) for dark theme for moe-icon */
        .dark-theme .moe-icon {
            fill: #A9A9B2;
        }

        /* Apply fill color based on currentColor for all logos */
        .cc-logo path,
        .att-logo path,
        .non-logo path {
            fill: currentColor;
        }

        /* Default color (black) for day mode for all logos */
        .cc-logo path,
        .att-logo path,
        .non-logo path {
            color: black;
        }

        /* Color (#A9A9B2) for dark theme for all logos */
        .dark-theme .cc-logo path,
        .dark-theme .att-logo path,
        .dark-theme .non-logo path {
            color: #A9A9B2;
        }

        #footer .footer {
            font-size: 12px !important;
        }

        /* 页脚的基本样式 */
        .footer {
            font-size: 12px;
        }

        /* 桌面端样式 */
        @media screen and (min-width: 768px) {
            .footer {
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
            }

            .footer>div>span,
            .footer>div>a,
            .footer>div>i {
                display: inline-block;
            }

            .footer>div>br {
                display: none;
                /* 隐藏换行符 */
            }

            .footer>div>script {
                display: none;
                /* 隐藏 script 标签 */
            }
        }

        /* 移动端样式，无需特别处理 */

        .non-logo,
        #busuanzi_value_site_uv,
        #qudong,
        .kaiwang,
        #moe-text,
        .moe-icon,
        #runtime_span,
        .post-count {
            margin-right: 5px;
        }
    </style>

    <div id="totop" style="bottom:60px;cursor: pointer;">
    <a title="返回顶部">
        <svg t="1697771647324" class="icon back-top-svg" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2324" width="32px" height="32px">
            <path d="M946.494 754.216c19.445-19.445 19.445-51.265 0-70.711L547.355 284.368c-19.445-19.445-51.265-19.445-70.711 0L77.506 683.506c-19.445 19.445-19.445 51.265 0 70.711" p-id="2325" fill="#8a8a8a"></path>
        </svg>
    </a>
</div>




        <script src="/js/totop.js"></script>

        <!-- require APlayer -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css">
        <script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script>
        <!-- require MetingJS -->
        <script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>

        <div class="aplayer no-destroy" style="display: block; text-align: left" data-id="8793002560"
            data-server="netease" data-type="playlist" data-mini="true" data-fixed="true" data-autoplay="false"
            data-order="random" data-lrctype="-1"> </div>

        <style>
            body.dark-theme .aplayer-list {
                border-color: #414345 !important;
            }

            body.dark-theme .aplayer-info {
                border-color: #414345 !important;
            }

            body.dark-theme .aplayer-miniswitcher {
                background: #414345;
                border-color: #414345;
            }

            body.dark-theme .aplayer-body {
                background: #292a2d !important;
            }

            body.dark-theme .aplayer {
                box-shadow: none !important;
            }

            body.dark-theme .aplayer-list ol li:first-child {
                border-top: none;
            }
        </style>
</footer>
    </div>
    </script>

    <!-- 搜索功能 -->
    <!-- Chic/layout.ejs -->
    <div id="u-search">
        <div class="modal">
            <div class="modal-header">
                <div class="container">
                    <form id="u-search-modal-form" class="u-search-modal-form">
                        <button type="submit" class="form-submit-btn">
                            <img src="/" class="search-btn-img" />
                        </button>
                        <input placeholder="搜索内容..." class="form-input" id="modal-form-input">
                    </form>
                    <a class="modal-close">x</a>
                </div>
                <div class="search-loading">
                    <div class="search-loading-bar"></div>
                </div>
            </div>
            <div class="modal-body">
            </div>
        </div>
        <div class="modal-overlay"></div>
    </div>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot/dist/tocbot.css" />
    <script src="https://cdn.jsdelivr.net/npm/tocbot/dist/tocbot.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', (event) => {
            tocbot.init({
                tocSelector: '.js-toc',
                contentSelector: '.post-content',
                headingSelector: 'h1, h2, h3, h4',
            });
        });
    </script>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const savedTheme = localStorage.getItem('theme');
            console.log("Saved theme: ", savedTheme); // 输出保存的主题

            const userPrefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
            console.log("User prefers dark theme: ", userPrefersDark); // 输出用户的系统偏好

            let useDarkMode;
            if (savedTheme === 'dark' || savedTheme === 'light') { // 当有明确的保存主题时
                useDarkMode = savedTheme === 'dark';
            } else {
                useDarkMode = userPrefersDark; // 默认使用系统偏好
            }

            console.log("Using dark theme: ", useDarkMode); // 输出是否使用暗主题

            document.body.classList.toggle('dark-theme', useDarkMode); // 应用或移除 dark-theme 类

            const themeToggleCheckbox = document.getElementById('switch_default');
            if (themeToggleCheckbox) {
                themeToggleCheckbox.checked = useDarkMode;
            }

            themeToggleCheckbox.addEventListener('change', function () {
                const isChecked = themeToggleCheckbox.checked;
                console.log("Checkbox is checked: ", isChecked); // 输出复选框的状态

                document.body.classList.toggle('dark-theme', isChecked);
                localStorage.setItem('theme', isChecked ? 'dark' : 'light');
            });
        });
    </script>

    <script>
        document.querySelector('.js-toc').addEventListener('scroll', function (e) {
            var tocList = document.querySelector('.toc-list');
            var maxHeight = tocList.scrollHeight - this.clientHeight + 20; // 计算最大可滚动高度
            if (this.scrollTop >= maxHeight) {
                this.scrollTop = maxHeight; // 如果滚动超过最大高度，则设置滚动位置为最大高度
            }
        });
    </script>

</body>

</html>